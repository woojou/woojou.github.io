<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <link rel="dns-prefetch" href="http://woojou.github.io">
  <title>设计模式 | woojou&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="本博客是跟着菜鸟教程和 refactoringguru 学习做的摘录整理。">
<meta property="og:type" content="article">
<meta property="og:title" content="设计模式">
<meta property="og:url" content="http://woojou.github.io/2021/07/16/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/index.html">
<meta property="og:site_name" content="woojou&#39;s blog">
<meta property="og:description" content="本博客是跟着菜鸟教程和 refactoringguru 学习做的摘录整理。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://refactoringguru.cn/images/patterns/diagrams/builder/example-zh.png">
<meta property="og:image" content="https://www.runoob.com/wp-content/uploads/2014/08/20210223-adapter.png">
<meta property="og:image" content="https://refactoringguru.cn/images/patterns/diagrams/bridge/solution-zh.png?id=1e12aa93e72a643f325f">
<meta property="og:image" content="https://refactoringguru.cn/images/patterns/examples/java/composite/OutputDemo.png">
<meta property="og:image" content="https://refactoringguru.cn/images/patterns/diagrams/facade/example.png">
<meta property="og:image" content="https://refactoringguru.cn/images/patterns/examples/java/command/OutputDemo.png">
<meta property="article:published_time" content="2021-07-16T07:53:32.000Z">
<meta property="article:modified_time" content="2021-08-02T10:04:44.296Z">
<meta property="article:author" content="Woojou">
<meta property="article:tag" content="编程基础">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://refactoringguru.cn/images/patterns/diagrams/builder/example-zh.png">
  
    <link rel="alternative" href="/atom.xml" title="woojou&#39;s blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" type="text/css" href="/./main.0cf68a.css">
  <style type="text/css">
  
    #container.show {
      background: linear-gradient(200deg,#a0cfe4,#e8c37e);
    }
  </style>
  

  

<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container" q-class="show:isCtnShow">
    <canvas id="anm-canvas" class="anm-canvas"></canvas>
    <div class="left-col" q-class="show:isShow">
      
<div class="overlay" style="background: #4d4d4d"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			<img src="https://s2-cdn.oneitfarm.com/FuEn8G7HCy0rRx-thOlWR_VDU5cJ" class="js-avatar">
		</a>
		<hgroup>
		  <h1 class="header-author"><a href="/">Woojou</a></h1>
		</hgroup>
		
		<p class="header-subtitle">不学习会变成猪猪哦</p>
		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/">主页</a></li>
	        
				<li><a href="/tags/%E9%9A%8F%E7%AC%94/">随笔</a></li>
	        
				<li><a href="/archives/index.html">归档</a></li>
	        
			</ul>
		</nav>
		<nav class="header-smart-menu">
    		
    			
    			<a q-on="click: openSlider(e, 'innerArchive')" href="javascript:void(0)">所有文章</a>
    			
            
    			
            
    			
    			<a q-on="click: openSlider(e, 'aboutme')" href="javascript:void(0)">关于我</a>
    			
            
		</nav>
		<nav class="header-nav">
			<div class="social">
				
					<a class="github" target="_blank" href="https://github.com/woojou/woojou.github.io" title="github"><i class="icon-github"></i></a>
		        
					<a class="weibo" target="_blank" href="https://weibo.com/u/5963514114" title="weibo"><i class="icon-weibo"></i></a>
		        
					<a class="bilibili" target="_blank" href="https://space.bilibili.com/261751344" title="bilibili"><i class="icon-bilibili"></i></a>
		        
			</div>
		</nav>
	</header>		
</div>

    </div>
    <div class="mid-col" q-class="show:isShow,hide:isShow|isFalse">
      
<nav id="mobile-nav">
  	<div class="overlay js-overlay" style="background: #4d4d4d"></div>
	<div class="btnctn js-mobile-btnctn">
  		<div class="slider-trigger list" q-on="click: openSlider(e)"><i class="icon icon-sort"></i></div>
	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img src="https://s2-cdn.oneitfarm.com/FuEn8G7HCy0rRx-thOlWR_VDU5cJ" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author js-header-author">Woojou</h1>
			</hgroup>
			
			<p class="header-subtitle"><i class="icon icon-quo-left"></i>不学习会变成猪猪哦<i class="icon icon-quo-right"></i></p>
			
			
			
				
			
				
			
				
			
			
			
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/woojou/woojou.github.io" title="github"><i class="icon-github"></i></a>
			        
						<a class="weibo" target="_blank" href="https://weibo.com/u/5963514114" title="weibo"><i class="icon-weibo"></i></a>
			        
						<a class="bilibili" target="_blank" href="https://space.bilibili.com/261751344" title="bilibili"><i class="icon-bilibili"></i></a>
			        
				</div>
			</nav>

			<nav class="header-menu js-header-menu">
				<ul style="width: 70%">
				
				
					<li style="width: 33.333333333333336%"><a href="/">主页</a></li>
		        
					<li style="width: 33.333333333333336%"><a href="/tags/%E9%9A%8F%E7%AC%94/">随笔</a></li>
		        
					<li style="width: 33.333333333333336%"><a href="/archives/index.html">归档</a></li>
		        
				</ul>
			</nav>
		</header>				
	</div>
	<div class="mobile-mask" style="display:none" q-show="isShow"></div>
</nav>

      <div id="wrapper" class="body-wrap">
        <div class="menu-l">
          <div class="canvas-wrap">
            <canvas data-colors="#eaeaea" data-sectionHeight="100" data-contentId="js-content" id="myCanvas1" class="anm-canvas"></canvas>
          </div>
          <div id="js-content" class="content-ll">
            <article id="post-设计模式" class="article article-type-post " itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      设计模式
    </h1>
  

        
        <a href="/2021/07/16/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" class="archive-article-date">
  	<time datetime="2021-07-16T07:53:32.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2021-07-16</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>本博客是跟着<a target="_blank" rel="noopener" href="https://www.runoob.com/design-pattern/design-pattern-intro.html">菜鸟教程</a>和 <a target="_blank" rel="noopener" href="https://refactoringguru.cn/design-patterns#intro-patterns">refactoringguru</a> 学习做的摘录整理。</p>
<span id="more"></span>

<h1 id="设计模式简介"><a href="#设计模式简介" class="headerlink" title="设计模式简介"></a>设计模式简介</h1><h2 id="设计模式是什么？"><a href="#设计模式是什么？" class="headerlink" title="设计模式是什么？"></a>设计模式是什么？</h2><p><strong>设计模式</strong>是软件设计中常见问题的典型解决方案。它并不是一套可以被套用的模板或代码，而是用于解决特定问题的一般性概念。</p>
<p>模式不同于算法：算法像是菜谱， 提供达成目标的明确步骤。 而模式更像是蓝图：你可以看到最终的结果和模式的功能， 但需要自己确定实现步骤。</p>
<h2 id="GOF是什么？"><a href="#GOF是什么？" class="headerlink" title="GOF是什么？"></a>GOF是什么？</h2><p>在 1994 年，由 Erich Gamma、Richard Helm、Ralph Johnson 和 John Vlissides 四人合著出版了一本名为 <strong>Design Patterns - Elements of Reusable Object-Oriented Software（中文译名：设计模式 - 可复用的面向对象软件元素）</strong> 的书，该书首次提到了软件开发中设计模式的概念。</p>
<p>四位作者合称 <strong>GOF（四人帮，全拼 Gang of Four）</strong>。他们所提出的设计模式主要是基于以下的面向对象设计原则。</p>
<ul>
<li>对接口编程而不是对实现编程。</li>
<li>优先使用对象组合而不是继承。</li>
</ul>
<h2 id="设计模式的类型"><a href="#设计模式的类型" class="headerlink" title="设计模式的类型"></a>设计模式的类型</h2><table>
<thead>
<tr>
<th align="left">序号</th>
<th align="left">模式 &amp; 描述</th>
<th align="left">包括</th>
</tr>
</thead>
<tbody><tr>
<td align="left">1</td>
<td align="left"><strong>创建型模式</strong> 这些设计模式提供了一种在创建对象的同时隐藏创建逻辑的方式，而不是使用 new 运算符直接实例化对象，能够提升已有代码的灵活性和可复用性。</td>
<td align="left">工厂模式（Factory Pattern）抽象工厂模式（Abstract Factory Pattern）单例模式（Singleton Pattern）建造者模式（Builder Pattern）原型模式（Prototype Pattern）</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left"><strong>结构型模式</strong> 这些设计模式关注类和对象的组合。继承的概念被用来组合接口和定义组合对象获得新功能的方式。</td>
<td align="left">适配器模式（Adapter Pattern）桥接模式（Bridge Pattern）过滤器模式（Filter、Criteria Pattern）组合模式（Composite Pattern）装饰器模式（Decorator Pattern）外观模式（Facade Pattern）享元模式（Flyweight Pattern）代理模式（Proxy Pattern）</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left"><strong>行为型模式</strong> 这些设计模式特别关注对象之间的通信。</td>
<td align="left">责任链模式（Chain of Responsibility Pattern）命令模式（Command Pattern）解释器模式（Interpreter Pattern）迭代器模式（Iterator Pattern）中介者模式（Mediator Pattern）备忘录模式（Memento Pattern）观察者模式（Observer Pattern）状态模式（State Pattern）空对象模式（Null Object Pattern）策略模式（Strategy Pattern）模板模式（Template Pattern）访问者模式（Visitor Pattern）</td>
</tr>
<tr>
<td align="left">4</td>
<td align="left"><strong>J2EE 模式</strong> 这些设计模式特别关注表示层。这些模式是由 Sun Java Center 鉴定的。</td>
<td align="left">MVC 模式（MVC Pattern）业务代表模式（Business Delegate Pattern）组合实体模式（Composite Entity Pattern）数据访问对象模式（Data Access Object Pattern）前端控制器模式（Front Controller Pattern）拦截过滤器模式（Intercepting Filter Pattern）服务定位器模式（Service Locator Pattern）传输对象模式（Transfer Object Pattern）</td>
</tr>
</tbody></table>
<h1 id="创建型模式"><a href="#创建型模式" class="headerlink" title="创建型模式"></a>创建型模式</h1><h2 id="工厂方法模式（Factory-Method）"><a href="#工厂方法模式（Factory-Method）" class="headerlink" title="工厂方法模式（Factory Method）"></a>工厂方法模式（Factory Method）</h2><h3 id="意图"><a href="#意图" class="headerlink" title="意图"></a>意图</h3><p>在父类中提供一个创建对象的方法（即创建对象的接口）， 允许子类决定实例化对象的类型。工厂模式使其创建过程延迟到子类进行。</p>
<p>工厂方法定义了一个方法， 且必须使用该方法<strong>代替通过直接调用构造函数来创建对象</strong> （ <code>new</code>操作符） 的方式。 子类可重写该方法来更改将被创建的对象所属类。</p>
<h3 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h3><ul>
<li><p>无法预知对象确切类别及其依赖关系时</p>
</li>
<li><p>希望用户能扩展你软件库或框架的内部组件</p>
</li>
<li><p>如果你希望复用现有对象来节省系统资源，而不是每次都重新创建对象</p>
</li>
</ul>
<h3 id="示例问题"><a href="#示例问题" class="headerlink" title="示例问题"></a>示例问题</h3><p><a target="_blank" rel="noopener" href="https://www.runoob.com/design-pattern/factory-pattern.html">菜鸟教程</a>中提供了一个画不同形状的例子，看了之后有启发自己想到一个应用：有一个食品工厂，生产不同种类的食品，包括饮料、饼干、冰淇淋，一个商人要去进货，他只需要向工厂提供自己要进货的种类和数量即可，不需要知道工厂是如何生产的。</p>
<p>1.创建一个食品接口</p>
<pre><code class="java">public interface Food &#123;
    void foodKind(int num);
&#125;
</code></pre>
<p>2.创建实现接口的实体类</p>
<pre><code class="java">public class Drinks implements Food &#123;
    @Override
    public void foodKind(int num) &#123;
        System.out.println(&quot;You have got &quot; + num + &quot; drinks&quot;);
    &#125;
&#125;
</code></pre>
<pre><code class="java">public class Cookies implements Food &#123;
    @Override
    public void foodKind(int num) &#123;
        System.out.println(&quot;You have got &quot; + num + &quot; cookies&quot;);
    &#125;
&#125;
</code></pre>
<pre><code class="java">public class IceCream implements Food &#123;
    @Override
    public void foodKind(int num) &#123;
        System.out.println(&quot;You have got &quot; + num + &quot; ice-cream&quot;);
    &#125;
&#125;
</code></pre>
<p>3.创建一个工厂，生产基于给定信息的实体类的对象</p>
<pre><code class="java">public class FoodFactory &#123;
    public Food getFood(String foodType) &#123;
        if(foodType == null) &#123;
            return null;
        &#125;
        if(foodType.equals(&quot;Drinks&quot;)) &#123;
            return new Drinks();
        &#125; else if(foodType.equals(&quot;Cookies&quot;)) &#123;
            return new Cookies();
        &#125; else if(foodType.equals(&quot;IceCream&quot;)) &#123;
            return new IceCream();
        &#125;
        return null;
    &#125;
&#125;
</code></pre>
<p>其实上面的结构已经做了简化，还可以先创建一个基本工厂类，在创建生产不同食品的工厂部门去继承父类工厂。</p>
<p>4.商人去工厂进货，通过告知自己所需的食品种类信息来获取实体类的对象</p>
<pre><code class="java">public class FactoryPatternDemo &#123;
    public static void main(String[] args) &#123;
        FoodFactory foodFactory = new FoodFactory();
        Food food1 = foodFactory.getFood(&quot;Drinks&quot;);
        Food food2 = foodFactory.getFood(&quot;Cookies&quot;);
        Food food3 = foodFactory.getFood(&quot;IceCream&quot;);
        food1.foodKind(10);
        food2.foodKind(20);
        food3.foodKind(30);
    &#125;
&#125;
</code></pre>
<p>5.输出结果</p>
<pre><code class="java">You have got 10 drinks
You have got 20 cookies
You have got 30 ice-cream
</code></pre>
<p>调用工厂方法的代码 （通常被称为 客户端代码） 无需了解不同子类返回实际对象之间的差别。 客户端将所有产品视为抽象的 <code>运输</code> 。 客户端知道所有运输对象都提供 <code>交付</code>方法， 但是并不关心其具体实现方式。</p>
<h3 id="模式结构"><a href="#模式结构" class="headerlink" title="模式结构"></a>模式结构</h3><ul>
<li><strong>产品</strong>：会对接口进行声明。 对于所有由创建者及其子类构建的对象， 这些接口都是通用的。</li>
<li><strong>具体产品</strong>：是产品接口的不同实现。</li>
<li><strong>生产工厂</strong>：返回产品对象的工厂方法。 </li>
</ul>
<h3 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h3><ul>
<li>一个调用者想创建一个对象，只要知道其名称就可以了。</li>
<li>扩展性高，如果想增加一个产品，只要扩展一个工厂类就可以。</li>
<li>屏蔽产品的具体实现，调用者只关心产品的接口。</li>
</ul>
<h3 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h3><p>每次增加一个产品时，都需要增加一个具体类和对象实现工厂，使得系统中类的个数成倍增加，在一定程度上增加了系统的复杂度，同时也增加了系统具体类的依赖。</p>
<h2 id="抽象工厂模式（Abstract-Factory）"><a href="#抽象工厂模式（Abstract-Factory）" class="headerlink" title="抽象工厂模式（Abstract Factory）"></a>抽象工厂模式（Abstract Factory）</h2><h3 id="意图-1"><a href="#意图-1" class="headerlink" title="意图"></a>意图</h3><p>围绕一个超级工厂创建其他工厂。能创建一系列相关的对象， 而无需指定其具体类。</p>
<p>在抽象工厂模式中，接口是负责创建一个相关对象的工厂。每个生成的工厂都能按照工厂模式提供对象。</p>
<h3 id="使用场景-1"><a href="#使用场景-1" class="headerlink" title="使用场景"></a>使用场景</h3><ul>
<li>如果代码需要与多个不同系列的相关产品交互，但是由于无法提前获取相关信息，或者出于对未来扩展性的考虑，你不希望代码基于产品的具体类进行构建。</li>
</ul>
<h3 id="示例问题-1"><a href="#示例问题-1" class="headerlink" title="示例问题"></a>示例问题</h3><p>继续延续上面的例子，食品的包装可以选择袋装或者盒装，由相应的工厂来专门实现。</p>
<p>1.创建一个食品接口</p>
<pre><code class="java">public interface Food &#123;
    void foodKind(int num);
&#125;
</code></pre>
<p>2.创建实现接口的实体类</p>
<pre><code class="java">public class Drinks implements Food &#123;
    @Override
    public void foodKind(int num) &#123;
        System.out.println(&quot;You have got &quot; + num + &quot; drinks&quot;);
    &#125;
&#125;
</code></pre>
<pre><code class="java">public class Cookies implements Food &#123;
    @Override
    public void foodKind(int num) &#123;
        System.out.println(&quot;You have got &quot; + num + &quot; cookies&quot;);
    &#125;
&#125;
</code></pre>
<pre><code class="java">public class IceCream implements Food &#123;
    @Override
    public void foodKind(int num) &#123;
        System.out.println(&quot;You have got &quot; + num + &quot; ice-cream&quot;);
    &#125;
&#125;
</code></pre>
<p>3.创建一个包装接口</p>
<pre><code class="java">public interface Package &#123;
    void getPackage(int num);
&#125;
</code></pre>
<p>4.创建实现接口的实体类。</p>
<pre><code class="java">public class Bag implements Package &#123;
    @Override
    public void getPackage(int num) &#123;
        System.out.println(&quot;Packed by&quot; + num + &quot;Bags&quot;);
    &#125;
&#125;
</code></pre>
<pre><code class="java">public class Box implements Package &#123;
    @Override
    public void getPackage(int num) &#123;
        System.out.println(&quot;Packed by&quot; + num + &quot;Boxes&quot;);
    &#125;
&#125;
</code></pre>
<p>5.为食品和包装对象创建 抽象类（也可以设计为接口） 来获取工厂</p>
<pre><code class="java">public abstract class AbstractFactory &#123;
    public abstract Food getFood(String food);
    public abstract Package getPackage(String packages);
&#125;
</code></pre>
<p>6.创建扩展了 AbstractFactory 的工厂类，基于给定的信息生成实体类的对象。</p>
<pre><code class="java">public class FoodFactory extends AbstractFactory &#123;
    public Food getFood(String foodType) &#123;
        if(foodType == null) &#123;
            return null;
        &#125;
        if(foodType.equals(&quot;Drinks&quot;)) &#123;
            return new Drinks();
        &#125; else if(foodType.equals(&quot;Cookies&quot;)) &#123;
            return new Cookies();
        &#125; else if(foodType.equals(&quot;IceCream&quot;)) &#123;
            return new IceCream();
        &#125;
        return null;
    &#125;

    @Override
    public Package getPackage(String packages) &#123;
        return null;
    &#125;
&#125;
</code></pre>
<pre><code class="java">public class PackageFactory extends AbstractFactory &#123;
    @Override
    public Package getPackage(String packages) &#123;
        if(packages == null) return null;
        if(packages.equals(&quot;Bag&quot;)) &#123;
            return new Bag();
        &#125; else if(packages.equals(&quot;Box&quot;)) &#123;
            return new Box();
        &#125;
        return null;
    &#125;

    @Override
    public Food getFood(String food) &#123;
        return null;
    &#125;
&#125;
</code></pre>
<p>7.创建一个工厂创造器/生成器类，通过传递食品或包装信息来获取工厂。</p>
<pre><code class="java">public class FactoryProducer &#123;
    public static AbstractFactory getFactory(String choice)&#123;
        if(choice.equalsIgnoreCase(&quot;Food&quot;))&#123;
            return new FoodFactory();
        &#125; else if(choice.equalsIgnoreCase(&quot;Package&quot;))&#123;
            return new PackageFactory();
        &#125;
        return null;
    &#125;
&#125;
</code></pre>
<p>8.用 <code>FactoryProducer</code> 来获取 <code>AbstractFactory</code>，并通过传递类型信息来获取实体类的对象，生产相应的产品。</p>
<pre><code class="java">public class AbstractFactoryPatternDemo &#123;
    public static void main(String[] args) &#123;
        AbstractFactory foodFactory = FactoryProducer.getFactory(&quot;Food&quot;);
        Food food1 = foodFactory.getFood(&quot;Drinks&quot;);
        Food food2 = foodFactory.getFood(&quot;Cookies&quot;);

        AbstractFactory packageFactory = FactoryProducer.getFactory(&quot;Package&quot;);
        Package package1 = packageFactory.getPackage(&quot;Box&quot;);
        Package package2 = packageFactory.getPackage(&quot;Bag&quot;);

        food1.foodKind(10);
        package1.getPackage(10);

        food2.foodKind(20);
        package2.getPackage(20);
    &#125;
&#125;
</code></pre>
<p>9.输出结果</p>
<pre><code class="java">You have got 10 drinks
Packed by 10 Boxes
You have got 20 cookies
Packed by 20 Bags
</code></pre>
<h3 id="模式结构-1"><a href="#模式结构-1" class="headerlink" title="模式结构"></a>模式结构</h3><ul>
<li><strong>产品</strong>：会对接口进行声明。 对于所有由创建者及其子类构建的对象， 这些接口都是通用的。</li>
<li><strong>具体产品</strong>：是产品接口的不同实现。</li>
<li><strong>抽象工厂</strong>：用抽象类或接口声明了一组创建各种抽象产品的方法。</li>
<li><strong>具体工厂</strong>：实现抽象工厂的构建方法。 每个具体工厂都对应特定产品变体， 且仅创建此种产品变体。</li>
<li><strong>工厂生产者</strong>：通过传入参数返回具体工厂方法。(工厂是产品的生产者，而工厂生产者是产生不同工厂的生产者) </li>
</ul>
<h3 id="优点-1"><a href="#优点-1" class="headerlink" title="优点"></a>优点</h3><ul>
<li>扩展性高，如果想增加一个产品，只要扩展一个工厂类就可以。</li>
<li>屏蔽产品和工厂的具体实现，调用者只关心产品和工厂的接口，不需要知道具体是哪个工厂以及如何生产产品。</li>
<li>确保同一工厂生成的产品相互匹配。</li>
</ul>
<h3 id="缺点-1"><a href="#缺点-1" class="headerlink" title="缺点"></a>缺点</h3><p>产品族扩展非常困难，要增加一个系列的某一产品，既要在抽象的 Creator 里加代码，又要在具体的里面加代码。</p>
<h2 id="建造者模式（Builder）"><a href="#建造者模式（Builder）" class="headerlink" title="建造者模式（Builder）"></a>建造者模式（Builder）</h2><h3 id="意图-2"><a href="#意图-2" class="headerlink" title="意图"></a>意图</h3><p>又称为生产者模式，使用多个简单的对象一步一步构建成一个复杂的对象。 该模式允许使用相同的创建代码生成不同类型和形式的对象。</p>
<h3 id="使用场景-2"><a href="#使用场景-2" class="headerlink" title="使用场景"></a>使用场景</h3><ul>
<li>一些基本部件不会变，而其组合经常变化的时候。</li>
</ul>
<h3 id="示例问题-2"><a href="#示例问题-2" class="headerlink" title="示例问题"></a>示例问题</h3><p>要生产一辆车，需要生产坐垫、引擎等等许多零部件，不同的车还会有一些不同的零部件。</p>
<p>如果这里采用扩展 汽车 基类，然后创建一系列涵盖各种参数的零部件子类，最终会有数量庞大的子类。如果不采用生成子类的方法，而是在 汽车 基类中创建一个包括所有可能参数的超级构造参数，这使得构造函数的调用十分不简洁，因为有很多构造参数在创建不同种类的汽车时根本用不到。</p>
<p>使用建造者模型，将对象构造代码从产品类中抽取出来，并将其放在一个名为生成器的独立对象中。</p>
<p>该模式会将对象构造过程划分为一组步骤。 每次创建对象时， 你都需要通过生成器对象执行一系列步骤。 重点在于你无需调用所有步骤， 而只需调用创建特定对象配置所需的那些步骤即可。 </p>
<p>还可以进一步将用于创建产品的一系列生成器步骤调用抽取成为单独的<em>主管</em>类。 主管类可定义创建步骤的执行顺序， 而生成器则提供这些步骤的实现。</p>
<p>代码结构如下：</p>
<p><img src="https://refactoringguru.cn/images/patterns/diagrams/builder/example-zh.png"></p>
<p><em>分步骤制造汽车并制作对应型号用户使用手册</em></p>
<p>1.构建一个生成器的接口，声明创建产品对象不同零部件的方法</p>
<pre><code class="java">public interface Builder &#123;
    void setCarType(CarType type);
    void setSeats(int seats);
    void setEngine(Engine engine);
    void setTransmission(Transmission transmission);
    void setTripComputer(TripComputer tripComputer);
    void setGPSNavigator(GPSNavigator gpsNavigator);
&#125;
</code></pre>
<p>2.创建具体的生成器类，包括汽车生成器和汽车手册生成器。每个生成器不仅包含生产各个零部件的方法，还要自行提供一个获取结果的方法，构造的结果可以通过主管类直接获取。 </p>
<pre><code class="java">public class CarBuilder implements Builder &#123;
    private CarType type;
    private int seats;
    private Engine engine;
    private Transmission transmission;
    private TripComputer tripComputer;
    private GPSNavigator gpsNavigator;

    //所有生成步骤都会与同一个产品实例进行交互。
    @Override
    public void setCarType(CarType type) &#123;
        this.type = type;
    &#125;

    @Override
    public void setSeats(int seats) &#123;
        this.seats = seats;
    &#125;

    @Override
    public void setEngine(Engine engine) &#123;
        this.engine = engine;
    &#125;

    @Override
    public void setTransmission(Transmission transmission) &#123;
        this.transmission = transmission;
    &#125;

    @Override
    public void setTripComputer(TripComputer tripComputer) &#123;
        this.tripComputer = tripComputer;
    &#125;

    @Override
    public void setGPSNavigator(GPSNavigator gpsNavigator) &#123;
        this.gpsNavigator = gpsNavigator;
    &#125;

    // 具体生成器需要自行提供获取结果的方法。这是因为不同类型的生成器可能
    // 会创建不遵循相同接口的、完全不同的产品。所以也就无法在生成器接口中
    // 声明这些方法（至少在静态类型的编程语言中是这样的）。
    //
    // 通常在生成器实例将结果返回给客户端后，它们应该做好生成另一个产品的
    // 准备。因此生成器实例通常会在 `getProduct（获取产品）`方法主体末尾
    // 调用重置方法。但是该行为并不是必需的，你也可让生成器等待客户端明确
    // 调用重置方法后再去处理之前的结果。
    public Car getResult() &#123;
        return new Car(type, seats, engine, transmission, tripComputer, gpsNavigator);
    &#125;
&#125;
</code></pre>
<pre><code class="java">public class ManualBuilder implements Builder &#123;
    private CarType type;
    private int seats;
    private Engine engine;
    private Transmission transmission;
    private TripComputer tripComputer;
    private GPSNavigator gpsNavigator;

    @Override
    public void setCarType(CarType type) &#123;
        this.type = type;
    &#125;

    @Override
    public void setSeats(int seats) &#123;
        this.seats = seats;
    &#125;

    @Override
    public void setEngine(Engine engine) &#123;
        this.engine = engine;
    &#125;

    @Override
    public void setTransmission(Transmission transmission) &#123;
        this.transmission = transmission;
    &#125;

    @Override
    public void setTripComputer(TripComputer tripComputer) &#123;
        this.tripComputer = tripComputer;
    &#125;

    @Override
    public void setGPSNavigator(GPSNavigator gpsNavigator) &#123;
        this.gpsNavigator = gpsNavigator;
    &#125;

    public Manual getResult() &#123;
        return new Manual(type, seats, engine, transmission, tripComputer, gpsNavigator);
    &#125;
&#125;
</code></pre>
<p>3.创建产品类（包括汽车和使用手册），将所需的零部件作为成员变量</p>
<pre><code class="java">public class Car &#123;
    private final CarType carType;
    private final int seats;
    private final Engine engine;
    private final Transmission transmission;
    private final TripComputer tripComputer;
    private final GPSNavigator gpsNavigator;
    private double fuel = 0;

    public Car(CarType carType, int seats, Engine engine, Transmission transmission, TripComputer tripComputer, GPSNavigator gpsNavigator) &#123;
        this.carType = carType;
        this.seats = seats;
        this.engine = engine;
        this.transmission = transmission;
        this.tripComputer = tripComputer;
        if (this.tripComputer != null) &#123;
            this.tripComputer.setCar(this);
        &#125;
        this.gpsNavigator = gpsNavigator;
    &#125;

    public CarType getCarType() &#123;
        return carType;
    &#125;

    public double getFuel() &#123;
        return fuel;
    &#125;

    public void setFuel(double fuel) &#123;
        this.fuel = fuel;
    &#125;

    public int getSeats() &#123;
        return seats;
    &#125;

    public Engine getEngine() &#123;
        return engine;
    &#125;

    public Transmission getTransmission() &#123;
        return transmission;
    &#125;

    public TripComputer getTripComputer() &#123;
        return tripComputer;
    &#125;

    public GPSNavigator getGpsNavigator() &#123;
        return gpsNavigator;
    &#125;
&#125;
</code></pre>
<pre><code class="java">public class Manual &#123;
    private final CarType carType;
    private final int seats;
    private final Engine engine;
    private final Transmission transmission;
    private final TripComputer tripComputer;
    private final GPSNavigator gpsNavigator;

    public Manual(CarType carType, int seats, Engine engine, Transmission transmission, TripComputer tripComputer, GPSNavigator gpsNavigator) &#123;
        this.carType = carType;
        this.seats = seats;
        this.engine = engine;
        this.transmission = transmission;
        this.tripComputer = tripComputer;
        this.gpsNavigator = gpsNavigator;
    &#125;
    //打印车辆的所有信息
    public String print() &#123;
        StringBuilder info = new StringBuilder();
        info.append(&quot;Type of car: &quot; + carType + &quot;\n&quot;);
        info.append(&quot;Count of seats: &quot; + seats + &quot;\n&quot;);
        info.append(&quot;Engine: volume - &quot; + engine.getVolume() + &quot;; mileage - &quot; + engine.getMileage() + &quot;\n&quot;);
        info.append(&quot;Transmission: &quot; + transmission + &quot;\n&quot;);
        if (this.tripComputer != null) &#123;
            info.append(&quot;Trip Computer: Functional&quot; + &quot;\n&quot;);
        &#125; else &#123;
            info.append(&quot;Trip Computer: N/A&quot; + &quot;\n&quot;);
        &#125;
        if (this.gpsNavigator != null) &#123;
            info.append(&quot;GPS Navigator: Functional&quot; + &quot;\n&quot;);
        &#125; else &#123;
            info.append(&quot;GPS Navigator: N/A&quot; + &quot;\n&quot;);
        &#125;
        return info.toString();
    &#125;
&#125;
</code></pre>
<p>4.创建各个零部件类。</p>
<pre><code class="java">public class Engine &#123;
    private final double volume;
    private double mileage;
    private boolean started;

    public Engine(double volume, double mileage) &#123;
        this.volume = volume;
        this.mileage = mileage;
    &#125;

    public void on() &#123;
        started = true;
    &#125;

    public void off() &#123;
        started = false;
    &#125;

    public boolean isStarted() &#123;
        return started;
    &#125;

    public void go(double mileage) &#123;
        if (started) &#123;
            this.mileage += mileage;
        &#125; else &#123;
            System.err.println(&quot;Cannot go(), you must start engine first!&quot;);
        &#125;
    &#125;

    public double getVolume() &#123;
        return volume;
    &#125;

    public double getMileage() &#123;
        return mileage;
    &#125;
&#125;
</code></pre>
<pre><code class="java">public class GPSNavigator &#123;
    private String route;

    public GPSNavigator() &#123;
        this.route = &quot;221b, Baker Street, London  to Scotland Yard, 8-10 Broadway, London&quot;;
    &#125;

    public GPSNavigator(String manualRoute) &#123;
        this.route = manualRoute;
    &#125;

    public String getRoute() &#123;
        return route;
    &#125;
&#125;
</code></pre>
<pre><code class="java">public class TripComputer &#123;
    private Car car;

    public void setCar(Car car) &#123;
        this.car = car;
    &#125;

    public void showFuelLevel() &#123;
        System.out.println(&quot;Fuel level: &quot; + car.getFuel());
    &#125;

    public void showStatus() &#123;
        if (this.car.getEngine().isStarted()) &#123;
            System.out.println(&quot;Car is started&quot;);
        &#125; else &#123;
            System.out.println(&quot;Car isn&#39;t started&quot;);
        &#125;
    &#125;
&#125;
</code></pre>
<pre><code class="java">public enum Transmission &#123;
    SINGLE_SPEED, MANUAL, AUTOMATIC, SEMI_AUTOMATIC
&#125;
</code></pre>
<p>5.创建主管类，主管负责按照特定顺序执行步骤以生产不同类型的产品。主管类并不是必须的。</p>
<pre><code class="java">public class Director &#123;
    public void constructSportsCar(Builder builder) &#123;
        builder.setCarType(CarType.SPORTS_CAR);
        builder.setSeats(2);
        builder.setEngine(new Engine(3.0, 0));
        builder.setTransmission(Transmission.SEMI_AUTOMATIC);
        builder.setTripComputer(new TripComputer());
        builder.setGPSNavigator(new GPSNavigator());
    &#125;

    public void constructCityCar(Builder builder) &#123;
        builder.setCarType(CarType.CITY_CAR);
        builder.setSeats(2);
        builder.setEngine(new Engine(1.2, 0));
        builder.setTransmission(Transmission.AUTOMATIC);
        builder.setTripComputer(new TripComputer());
        builder.setGPSNavigator(new GPSNavigator());
    &#125;

    public void constructSUV(Builder builder) &#123;
        builder.setCarType(CarType.SUV);
        builder.setSeats(4);
        builder.setEngine(new Engine(2.5, 0));
        builder.setTransmission(Transmission.MANUAL);
        builder.setGPSNavigator(new GPSNavigator());
    &#125;
&#125;
</code></pre>
<p>6.主管类调用具体车辆的生成函数，对传入的生成器对象参数进行构建加工，加工后通过生成器对象调用<code>getResult()</code>获取生成的产品（汽车或手册）。</p>
<pre><code class="java">public class Demo &#123;
    public static void main(String[] args) &#123;
        Director director = new Director();
        // Director gets the concrete builder object from the client
        // (application code). That&#39;s because application knows better which
        // builder to use to get a specific product.
        CarBuilder builder = new CarBuilder();
        director.constructSportsCar(builder);
        Car car = builder.getResult();
        System.out.println(&quot;Car built:\n&quot; + car.getCarType());

        ManualBuilder manualBuilder = new ManualBuilder();
        // Director may know several building recipes.
        director.constructSportsCar(manualBuilder);
        Manual carManual = manualBuilder.getResult();
        System.out.println(&quot;\nCar manual built:\n&quot; + carManual.print());
    &#125;
&#125;
</code></pre>
<p>7.输出结果</p>
<pre><code class="java">Car built:
SPORTS_CAR

Car manual built:
Type of car: SPORTS_CAR
Count of seats: 2
Engine: volume - 3.0; mileage - 0.0
Transmission: SEMI_AUTOMATIC
Trip Computer: Functional
GPS Navigator: Functional
</code></pre>
<h3 id="模式结构-2"><a href="#模式结构-2" class="headerlink" title="模式结构"></a>模式结构</h3><ul>
<li><strong>生成器</strong>：会对接口进行声明，清晰地定义通用步骤， 确保它们可以制造所有形式的产品。</li>
<li><strong>具体生成器</strong>：生成器接口的具体实现，用于生产不同种类的产品，声明步骤。</li>
<li><strong>零部件组成</strong>：声明所需的部件类。</li>
<li><strong>产品</strong>：定义产品的成员变量（即所有部件）。</li>
<li><strong>主管类</strong>：使用生成器封装多种构造产品的方式。并不是必须的。</li>
</ul>
<h3 id="优点-2"><a href="#优点-2" class="headerlink" title="优点"></a>优点</h3><ul>
<li>可以分步创建对象， 暂缓创建步骤或递归运行创建步骤。</li>
<li>各种生成器独立，易扩展。</li>
<li>单一职责原则，可以将复杂构造代码从产品的业务逻辑中分离出来。</li>
</ul>
<h3 id="缺点-2"><a href="#缺点-2" class="headerlink" title="缺点"></a>缺点</h3><ul>
<li>由于该模式需要新增多个类， 因此代码整体复杂程度会有所增加。</li>
<li>产品必须有共同点，范围有限制。</li>
</ul>
<h2 id="原型模式（Prototype）"><a href="#原型模式（Prototype）" class="headerlink" title="原型模式（Prototype）"></a>原型模式（Prototype）</h2><h3 id="意图-3"><a href="#意图-3" class="headerlink" title="意图"></a>意图</h3><p>使能够复制已有对象， 而又无需使代码依赖它们所属的类。用原型实例指定创建对象的种类，并且通过拷贝这些原型创建新的对象。</p>
<h3 id="使用场景-3"><a href="#使用场景-3" class="headerlink" title="使用场景"></a>使用场景</h3><ul>
<li>如果你需要复制一些对象， 同时又希望代码独立于这些对象所属的具体类， 可以使用原型模式。</li>
<li>通过 new 产生一个对象需要非常繁琐的数据准备或访问权限，则可以使用原型模式。</li>
<li>在实际项目中，原型模式很少单独出现，一般是和工厂方法模式一起出现，通过 clone 的方法创建一个对象，然后由工厂方法提供给调用者。原型模式已经与 Java 融为浑然一体，大家可以随手拿来使用。</li>
</ul>
<h3 id="示例问题-3"><a href="#示例问题-3" class="headerlink" title="示例问题"></a>示例问题</h3><p>圆形和矩形都是形状，对于任何一个圆形或者矩形的形状，希望可以生成与其完全相同的复制品。</p>
<p>但是因为对象有一些私有成员变量，在对象以外是不可兼得，所以无法通过遍历原始对象的所有成员变量， 并将成员变量值复制到新对象中的方法来实现。另外，直接复制还有另外一个问题。 因为 <em>你必须知道对象所属的类</em> 以及 <em>它有哪些成员变量</em>  才能创建复制品， 所以代码必须依赖该类。 即使你可以接受额外的依赖性， 那还有另外一个问题： 有时你只知道对象所实现的接口， 而不知道其所属的具体类， 比如可向方法的某个参数传入实现了某个接口的任何对象。</p>
<p>原型模式为所有支持克隆的对象声明了一个通用接口， 该接口让你能够克隆对象， 同时又无需将代码和对象所属类耦合。</p>
<p>创建一个抽象类（或者接口）为 形状类，声明了克隆方法。圆形和矩形都是其子类，具体实现克隆方法。</p>
<p>1.创建通用形状接口/抽象类</p>
<pre><code class="java">public abstract class Shape &#123;
    //可以只有一个克隆方法
    public abstract Shape clone();
&#125;
</code></pre>
<p>2.创建具体的形状类，重写克隆方法</p>
<pre><code class="java">public class Circle extends Shape &#123;
    private int radius;

    public Circle(int radius) &#123;
        this.radius = radius;
    &#125;

    public Circle(Circle circle) &#123;
        if(circle != null) &#123;
            this.radius = circle.radius;
        &#125;
    &#125;

    public int getRadius() &#123;
        return this.radius;
    &#125;

    @Override
    public Shape clone() &#123;
        return new Circle(this);
    &#125;

    public boolean equals(Object object2) &#123;
        if (!(object2 instanceof Circle)) return false;
        Circle shape2 = (Circle) object2;
        return shape2.getRadius() == radius;
    &#125;
&#125;
</code></pre>
<pre><code class="java">public class Rectangle extends Shape &#123;
    private int width;
    private int height;

    public Rectangle(int width, int height) &#123;
        this.width = width;
        this.height = height;
    &#125;

    public int getWidth() &#123;
        return this.width;
    &#125;

    public int getHeight() &#123;
        return this.height;
    &#125;

    public Rectangle(Rectangle rectangle) &#123;
        if (rectangle != null) &#123;
            this.width = rectangle.width;
            this.height = rectangle.height;
        &#125;
    &#125;

    @Override
    public Shape clone() &#123;
        return new Rectangle(this);
    &#125;

    @Override
    public boolean equals(Object object2) &#123;
        if (!(object2 instanceof Rectangle)) return false;
        Rectangle shape2 = (Rectangle) object2;
        return (shape2.getWidth() == width) &amp;&amp; (shape2.getHeight() == height);
    &#125;
&#125;
</code></pre>
<p>3.客户端利用<code>clone()</code>复制对象，并不需要知道它到底是哪个类有那些成员变量。</p>
<pre><code class="java">public class Demo &#123;
    public static void main(String[] args) &#123;
        Rectangle rectangle = new Rectangle(3,4);
        Object obj1 = rectangle.clone();
        System.out.println(rectangle.equals(obj1));

        Circle circle = new Circle(2);
        Object obj2 = circle.clone();
        System.out.println(circle.equals(obj2));
    &#125;
&#125;
</code></pre>
<p>4.输出结果</p>
<pre><code class="java">true
true
</code></pre>
<h3 id="模式结构-3"><a href="#模式结构-3" class="headerlink" title="模式结构"></a>模式结构</h3><ul>
<li><strong>原型接口</strong>：在接口类中声明克隆方法。</li>
<li><strong>原型类</strong>：具体的原型实现。必须另行定义一个以该类对象为参数的构造函数。 构造函数必须复制参数对象中的所有成员变量值到新建实体中。</li>
</ul>
<h3 id="优点-3"><a href="#优点-3" class="headerlink" title="优点"></a>优点</h3><ul>
<li>可以克隆对象， 而无需与它们所属的具体类相耦合。</li>
</ul>
<h3 id="缺点-3"><a href="#缺点-3" class="headerlink" title="缺点"></a>缺点</h3><ul>
<li>克隆包含循环引用的复杂对象可能会非常麻烦。</li>
</ul>
<h2 id="单例模式（Singleton）"><a href="#单例模式（Singleton）" class="headerlink" title="单例模式（Singleton）"></a>单例模式（Singleton）</h2><h3 id="意图-4"><a href="#意图-4" class="headerlink" title="意图"></a>意图</h3><p>这种模式涉及到一个单一的类，该类负责创建自己的对象，同时确保只有单个对象被创建。这个类提供了一种访问其唯一的对象的方式，可以直接访问，不需要实例化该类的对象。</p>
<p>保证一个类仅有一个实例，并提供一个访问它的全局访问点。</p>
<h3 id="使用场景-4"><a href="#使用场景-4" class="headerlink" title="使用场景"></a>使用场景</h3><ul>
<li>如果程序中的某个类对于所有客户端只有一个可用的实例</li>
<li>如果需要更加严格地控制全局变量，单例模式与全局变量不同， 它保证类只存在一个实例。 除了单例类自己以外， 无法通过任何方式替换缓存的实例。可以随时调整限制并设定生成单例实例的数量， 只需修改 <code>获取实例</code>方法， 即 getInstance 中的代码即可实现。</li>
</ul>
<h3 id="示例问题-4"><a href="#示例问题-4" class="headerlink" title="示例问题"></a>示例问题</h3><p>为了控制数据库的访问权限，保证只会有一个数据库，要求一旦数据库对象创建后，后序再创建新的对象返回的是之前已创建的对象。普通构造函数无法实现上述行为， 因为构造函数的设计决定了它<strong>必须</strong>总是返回一个新对象。</p>
<p>1.创建一个 Singleton 类</p>
<pre><code class="java">public class Singleton &#123;
    //创建 Singleton 的一个对象
    private  static  Singleton instance;
    public String value;

    //让构造函数为 private，这样该类就不会被实例化
    private Singleton() &#123;&#125;

    public Singleton(String value) &#123;
        this.value = value;
    &#125;

    //获取唯一可用的对象
    public static Singleton getInstance(String value) &#123;
        if(instance == null) &#123;
            instance = new Singleton(value);
        &#125;
        return instance;
    &#125;
&#125;
</code></pre>
<p>2.从 Singleton 类获取唯一的对象</p>
<pre><code class="java">public class Demo &#123;
    public static void main(String[] args) &#123;
        Singleton singleton1 = Singleton.getInstance(&quot;Hey&quot;);
        Singleton singleton2 = Singleton.getInstance(&quot;Hi&quot;);
        System.out.println(singleton1.value);
        System.out.println(singleton2.value);
    &#125;
&#125;
</code></pre>
<p>3.输出结果</p>
<pre><code class="java">Hey
Hey
</code></pre>
<h3 id="单例模式的几种实现方式"><a href="#单例模式的几种实现方式" class="headerlink" title="单例模式的几种实现方式"></a>单例模式的几种实现方式</h3><h4 id="1-懒汉式，线程不安全"><a href="#1-懒汉式，线程不安全" class="headerlink" title="1. 懒汉式，线程不安全"></a>1. 懒汉式，线程不安全</h4><p>也就是我们上面用到的这种方式，这种方式是最基本的实现方式，这种实现最大的问题就是<strong>不支持多线程</strong>。因为没有加锁 synchronized，所以严格意义上它并不算单例模式。</p>
<p>举个例子，给 Singleton 对象创建过程加上一个延迟，再通过多线程调用它，看看输出结果。</p>
<pre><code class="java">public class Singleton &#123;
    //创建 Singleton 的一个对象
    private  static  Singleton instance;
    public String value;

    //让构造函数为 private，这样该类就不会被实例化
    private Singleton() &#123;&#125;

    public Singleton(String value) &#123;
        try &#123;
            Thread.sleep(1000);
        &#125; catch (InterruptedException ex) &#123;
            ex.printStackTrace();
        &#125;
        this.value = value;
    &#125;

    //获取唯一可用的对象
    public static Singleton getInstance(String value) &#123;
        if(instance == null) &#123;
            instance = new Singleton(value);
        &#125;
        return instance;
    &#125;
&#125;
</code></pre>
<pre><code class="java">public class Demo &#123;
    public static void main(String[] args) &#123;
        //多线程调用
        Thread threadhey = new Thread(new ThreadHey());
        Thread threadhi = new Thread(new ThreadHi());
        threadhey.start();
        threadhi.start();
    &#125;
    static class ThreadHey implements Runnable &#123;
        @Override
        public void run() &#123;
            Singleton singleton = Singleton.getInstance(&quot;Hey&quot;);
            System.out.println(singleton.value);
        &#125;
    &#125;

    static class ThreadHi implements Runnable &#123;
        @Override
        public void run() &#123;
            Singleton singleton = Singleton.getInstance(&quot;Hi&quot;);
            System.out.println(singleton.value);
        &#125;
    &#125;
&#125;
</code></pre>
<p>输出结果</p>
<pre><code>Hey
Hi
</code></pre>
<h4 id="2-懒汉式，线程安全"><a href="#2-懒汉式，线程安全" class="headerlink" title="2. 懒汉式，线程安全"></a>2. 懒汉式，线程安全</h4><p>这种方式通过加锁 synchronized 保证单例，能够在多线程中很好的工作，但是，效率很低。</p>
<pre><code class="java">public class Singleton &#123;
    //创建 Singleton 的一个对象
    private  static  Singleton instance;
    public String value;

    //让构造函数为 private，这样该类就不会被实例化
    private Singleton() &#123;&#125;

    public Singleton(String value) &#123;
        //模拟延时
        try &#123;
            Thread.sleep(1000);
        &#125; catch (InterruptedException ex) &#123;
            ex.printStackTrace();
        &#125;
        this.value = value;
    &#125;

    //给方法加锁
    public static synchronized Singleton getInstance(String value) &#123;
        if(instance == null) &#123;
            instance = new Singleton(value);
        &#125;
        return instance;
    &#125;
&#125;
</code></pre>
<p>通过多线程调用发现输出结果是相同的。</p>
<h4 id="3-饿汉式"><a href="#3-饿汉式" class="headerlink" title="3. 饿汉式"></a>3. 饿汉式</h4><p>这种方式没有加锁，基于 classloader 机制避免了多线程的同步问题，instance 在类装载时就实例化，容易产生垃圾对象。</p>
<pre><code class="java">public class Singleton &#123;
    //创建 Singleton 的一个对象
    private  static  Singleton instance = new Singleton();
    public String value;

    //让构造函数为 private，这样该类就不会被实例化
    private Singleton() &#123;&#125;

    //获取唯一实例
    public static Singleton getInstance(String value) &#123;
        //模拟延时
        try &#123;
            Thread.sleep(1000);
        &#125; catch (InterruptedException ex) &#123;
            ex.printStackTrace();
        &#125;
        //如果实例的成员没有被初始化过，那么代表其实该实例之前没有被真正创建
        if(instance.value == null) instance.value = value;
        return instance;
    &#125;
&#125;
</code></pre>
<p>调用多线程代码发现最后输出全是”Hi”而不是”Hey”，这是因为，两个线程都获取到了没有被修改过 <code>value </code> 的实例，线程Hey和线程Hi先后对<code>value</code>做修改，最后value结果是<code>Hi</code>。</p>
<h4 id="4-双检锁-双重校验锁（DCL，即-double-checked-locking）"><a href="#4-双检锁-双重校验锁（DCL，即-double-checked-locking）" class="headerlink" title="4. 双检锁/双重校验锁（DCL，即 double-checked locking）"></a>4. 双检锁/双重校验锁（DCL，即 double-checked locking）</h4><p>这种方式采用双锁机制，安全且在多线程情况下能保持高性能。</p>
<p><em>volatile</em> 是 Java 提供的一种轻量级的同步机制。加入volatile关键字时，会多出一个lock前缀指令，lock前缀指令实际上相当于一个内存屏障（也成内存栅栏），内存屏障会提供3个功能：</p>
<p>（1）它确保指令重排序时不会把其后面的指令排到内存屏障之前的位置，也不会把前面的指令排到内存屏障的后面；即在执行到内存屏障这句指令时，在它前面的操作已经全部完成；</p>
<p>（2）它会强制将对缓存的修改操作立即写入主存；</p>
<p>（3）如果是写操作，它会导致其他CPU中对应的缓存行无效。</p>
<pre><code class="java">public class Singleton &#123;
    // 必须给实例加上 volatile 才能保证 DCL 正常工作
    private static volatile Singleton instance;

    public String value;

    private Singleton(String value) &#123;
        this.value = value;
    &#125;

    public static Singleton getInstance(String value) &#123;
        //通过引入一个局部变量
        Singleton result = instance;
        //第一遍检查其是否被创建过
        if (result != null) &#123;
            return result;
        &#125;
        //同步锁
        synchronized(Singleton.class) &#123;
            //再次检查
            if (instance == null) &#123;
                instance = new Singleton(value);
            &#125;
            return instance;
        &#125;
    &#125;
&#125;
</code></pre>
<p>调用测试代码，输出是两个”Hey”</p>
<h4 id="5-枚举"><a href="#5-枚举" class="headerlink" title="5. 枚举"></a>5. 枚举</h4><p>这种实现方式还没有被广泛采用，但这是实现单例模式的最佳方法。它更简洁，能避免多线程同步问题，自动支持序列化机制，绝对防止多次实例化。</p>
<pre><code class="java">public enum Singleton &#123;  
    INSTANCE;  
    public void whateverMethod() &#123;  
    &#125;  
&#125;
</code></pre>
<h3 id="优点-4"><a href="#优点-4" class="headerlink" title="优点"></a>优点</h3><ul>
<li>在内存里只有一个实例，减少了内存的开销，尤其是频繁的创建和销毁实例</li>
<li>避免对资源的多重占用</li>
</ul>
<h3 id="缺点-4"><a href="#缺点-4" class="headerlink" title="缺点"></a>缺点</h3><ul>
<li>违反了单一职责原则。 该模式同时解决了两个问题。</li>
<li>该模式在多线程环境下需要进行特殊处理， 避免多个线程多次创建单例对象。</li>
<li>没有接口，不能继承</li>
</ul>
<h1 id="结构型模式"><a href="#结构型模式" class="headerlink" title="结构型模式"></a>结构型模式</h1><h2 id="适配器模式（Wrapper-Adapter）"><a href="#适配器模式（Wrapper-Adapter）" class="headerlink" title="适配器模式（Wrapper/Adapter）"></a>适配器模式（Wrapper/Adapter）</h2><h3 id="意图-5"><a href="#意图-5" class="headerlink" title="意图"></a>意图</h3><p>将一个类的接口转换成客户希望的另外一个接口，能使接口不兼容的对象能够相互合作。这种类型的设计模式属于结构型模式，通过适配器实现了其中一个对象的接口， 并对另一个对象进行封装，来达到结合了两个独立接口的功能。</p>
<p>就相当于一个插座转换器一样。</p>
<h3 id="使用场景-5"><a href="#使用场景-5" class="headerlink" title="使用场景"></a>使用场景</h3><ul>
<li>当你希望使用某个类， 但是其接口与其他代码不兼容时， 可以使用适配器类。</li>
<li>需要复用一些类，它们处于同一个继承体系，但又有一些不同的方法。</li>
</ul>
<h3 id="示例问题-5"><a href="#示例问题-5" class="headerlink" title="示例问题"></a>示例问题</h3><p>对比觉得<a target="_blank" rel="noopener" href="https://www.runoob.com/design-pattern/adapter-pattern.html">菜鸟教程</a>中的例子更贴切：</p>
<p>有一个 <em>MediaPlayer</em> 接口和一个实现了 <em>MediaPlayer</em> 接口的实体类 <em>Mp3Player</em>。默认情况下，<em>Mp3Player</em> 可以播放 mp3 格式的音频文件。</p>
<p>我们还有另一个接口 <em>AdvancedMediaPlayer</em> 和实现了 <em>AdvancedMediaPlayer</em> 接口的实体类。该类可以播放 vlc 和 mp4 格式的文件。</p>
<p>我们想要让 <em>Mp3Player</em> 播放其他格式的音频文件。为了实现这个功能，我们需要创建一个实现了 <em>MediaPlayer</em> 接口的适配器类 <em>MediaAdapter</em>，并使用 <em>AdvancedMediaPlayer</em> 对象来播放所需的格式。</p>
<p><em>Mp3Player</em> 使用适配器类 <em>MediaAdapter</em> 传递所需的音频类型，不需要知道能播放所需格式音频的实际类。<em>AdapterPatternDemo</em> 类使用 <em>Mp3Player</em> 类来播放各种格式。</p>
<p><img src="https://www.runoob.com/wp-content/uploads/2014/08/20210223-adapter.png"></p>
<p>1.创建 <em>MediaPlayer</em> 和 <em>AdvancedMediaPlayer</em> 接口</p>
<pre><code class="java">public interface MediaPlayer &#123;
    public void play(String audioType, String fileName);
&#125;
</code></pre>
<pre><code class="java">public interface AdvanceMediaPlayer &#123;
    public void playVlc(String fileName);
    public void playMp4(String fileName);
&#125;
</code></pre>
<p>2.创建实现 <em>AdvancedMediaPlayer</em> 接口的实体类</p>
<pre><code class="java">public class Mp4Player implements AdvanceMediaPlayer &#123;
    @Override
    public void playMp4(String fileName) &#123;
        System.out.println(&quot;Playing mp4 file: &quot; + fileName);
    &#125;

    @Override
    public void playVlc(String fileName) &#123;

    &#125;
&#125;
</code></pre>
<pre><code class="java">public class VlcPlayer implements AdvanceMediaPlayer &#123;
    @Override
    public void playVlc(String fileName) &#123;
        System.out.println(&quot;Playing vlc file: &quot; + fileName);
    &#125;

    @Override
    public void playMp4(String fileName) &#123;

    &#125;
&#125;
</code></pre>
<p>3.为 <em>Mp3Player</em> 创建一个可以使用高级播放功能的适配器，继承<em>MediaPlayer</em>，封装<em>AdvancdMediaPlayer</em>对象。</p>
<pre><code class="java">public class MediaAdapter implements MediaPlayer &#123;
    AdvanceMediaPlayer advancedMusicPlayer;

    public MediaAdapter(String audioType) &#123;
        if(audioType.equals(&quot;vlc&quot;)) &#123;
            advancedMusicPlayer = new VlcPlayer();
        &#125;else if(audioType.equals(&quot;mp4&quot;)) &#123;
            advancedMusicPlayer = new Mp4Player();
        &#125;
    &#125;

    @Override
    public void play(String audioType, String fileName) &#123;
        if(audioType.equalsIgnoreCase(&quot;vlc&quot;))&#123;
            advancedMusicPlayer.playVlc(fileName);
        &#125;else if(audioType.equalsIgnoreCase(&quot;mp4&quot;))&#123;
            advancedMusicPlayer.playMp4(fileName);
        &#125;
    &#125;
&#125;
</code></pre>
<p>4.创建使用适配器 <em>MediaAdapter</em> 的 <em>Mp3Player</em> 类。</p>
<pre><code class="java">public class Mp3Player implements MediaPlayer &#123;
    @Override
    public void play(String audioType, String fileName) &#123;
        //播放 mp3 音乐文件的内置支持
        if(audioType.equals(&quot;mp3&quot;))&#123;
            System.out.println(&quot;Playing mp3 file: &quot;+ fileName);
        &#125; else if(audioType.equals(&quot;vlc&quot;) || audioType.equals(&quot;mp4&quot;)) &#123;
            MediaAdapter mediaAdapter = new MediaAdapter(audioType);
            mediaAdapter.play(audioType, fileName);
        &#125; else&#123;
            System.out.println(&quot;Invalid media. &quot;+
                    audioType + &quot; format not supported&quot;);
        &#125;
    &#125;
&#125;
</code></pre>
<p>5.用测试代码播放不同格式的音乐</p>
<pre><code class="java">public class Demo &#123;
    public static void main(String[] args) &#123;
        Mp3Player mp3Player = new Mp3Player();
        mp3Player.play(&quot;mp3&quot;, &quot;I wish you love.mp3&quot;);
        mp3Player.play(&quot;mp4&quot;, &quot;Love.mp4&quot;);
        mp3Player.play(&quot;vlc&quot;, &quot;Monster.vlc&quot;);
    &#125;
&#125;
</code></pre>
<p>6.输出结果</p>
<pre><code class="java">Playing mp3 file: I wish you love.mp3
Playing mp4 file: Love.mp4
Playing vlc file: Monster.vlc
</code></pre>
<h3 id="模式结构-4"><a href="#模式结构-4" class="headerlink" title="模式结构"></a>模式结构</h3><ul>
<li><strong>两个不同产品类</strong>：声明不同功能的两个不同接口</li>
<li><strong>产品1</strong>：实现接口1的功能</li>
<li><strong>适配器</strong>：实现接口2，封装另一个接口1的实例对象</li>
<li><strong>产品2（客户端）</strong>：实现接口2的功能之外，通过调用适配器实现接口1中的功能</li>
</ul>
<h3 id="优点-5"><a href="#优点-5" class="headerlink" title="优点"></a>优点</h3><ul>
<li>可以让任何两个没有关联的类一起运行</li>
<li>开闭原则。 只要客户端代码通过客户端接口与适配器进行交互， 你就能在不修改现有客户端代码的情况下在程序中添加新类型的适配器。</li>
<li>单一职责原则。你可以将接口或数据转换代码从程序主要业务逻辑中分离。</li>
</ul>
<h3 id="缺点-5"><a href="#缺点-5" class="headerlink" title="缺点"></a>缺点</h3><ul>
<li>代码整体复杂度增加， 因为你需要新增一系列接口和类。 有时直接更改服务类使其与其他代码兼容会更简单。</li>
</ul>
<h2 id="桥接模式（Bridge）"><a href="#桥接模式（Bridge）" class="headerlink" title="桥接模式（Bridge）"></a>桥接模式（Bridge）</h2><h3 id="意图-6"><a href="#意图-6" class="headerlink" title="意图"></a>意图</h3><p>可将一个大类或一系列紧密相关的类拆分为抽象和实现两个独立的层次结构， 从而能在开发时分别使用。</p>
<h3 id="使用场景-6"><a href="#使用场景-6" class="headerlink" title="使用场景"></a>使用场景</h3><ul>
<li>要拆分或重组一个具有多重功能的庞杂类</li>
<li>希望在几个独立维度上扩展一个类</li>
</ul>
<h3 id="示例问题-6"><a href="#示例问题-6" class="headerlink" title="示例问题"></a>示例问题</h3><p>假如你有一个几何 <code>形状</code>Shape类， 从它能扩展出两个子类：  <code>圆形</code>Circle和 <code>方形</code>Square 。 你希望对这样的类层次结构进行扩展以使其包含颜色， 所以你总共需要创建四个类才能覆盖所有组合， 例如 <code>蓝色圆形</code>Blue­Circle和 <code>红色方形</code>Red­Square 。随着后面各种形状和颜色的拓展，会变得越来越复杂，子类越来越庞大。</p>
<p>问题的根本原因是我们试图在两个独立的维度——形状与颜色——上扩展形状类。桥接模式通过将继承改为组合的方式来解决这个问题，具体来说， 就是抽取其中一个维度并使之成为独立的类层次， 这样就可以在<strong>初始类中引用这个新层次的对象</strong>，这揭示了<strong>桥接的本质就是这种包含关系</strong>。</p>
<p><img src="https://refactoringguru.cn/images/patterns/diagrams/bridge/solution-zh.png?id=1e12aa93e72a643f325f"></p>
<p>这是很好理解的，接下来用代码去讨论另一个问题的实现：用遥控器去开启不同的电子设备，且遥控器会有新的升级版本。</p>
<p>1.创建所有设备通用的接口</p>
<pre><code class="java">public interface Device &#123;
    boolean isEnabled();
    void enable();
    void disable();
    int getVolume();
    void setVolume(int percent);
    int getChannel();
    void setChannel(int channel);
    void printStatus();
&#125;
</code></pre>
<p>2.创建电子设备的实现类</p>
<pre><code class="java">public class Radio implements Device&#123;
    private boolean on = false;
    private int volume = 30;
    private int channel = 1;

    @Override
    public boolean isEnabled() &#123;
        return on;
    &#125;

    @Override
    public void enable() &#123;
        on = true;
    &#125;

    @Override
    public void disable() &#123;
        on = false;
    &#125;

    @Override
    public int getVolume() &#123;
        return volume;
    &#125;

    @Override
    public void setVolume(int volume) &#123;
        if(!on) return;
        if (volume &gt; 100) &#123;
            this.volume = 100;
        &#125; else if (volume &lt; 0) &#123;
            this.volume = 0;
        &#125; else &#123;
            this.volume = volume;
        &#125;
    &#125;

    @Override
    public int getChannel() &#123;
        return channel;
    &#125;

    @Override
    public void setChannel(int channel) &#123;
        if(!on) return;
        this.channel = channel;
    &#125;

    @Override
    public void printStatus() &#123;
        System.out.println(&quot;------------------------------------&quot;);
        System.out.println(&quot;| I&#39;m radio.&quot;);
        System.out.println(&quot;| I&#39;m &quot; + (on ? &quot;enabled&quot; : &quot;disabled&quot;));
        if(on) &#123;
            System.out.println(&quot;| Current volume is &quot; + volume + &quot;%&quot;);
            System.out.println(&quot;| Current channel is &quot; + channel);
        &#125;
        System.out.println(&quot;------------------------------------\n&quot;);
    &#125;
&#125;
</code></pre>
<pre><code class="java">public class Tv implements Device &#123;
    private boolean on = false;
    private int volume = 30;
    private int channel = 1;

    @Override
    public boolean isEnabled() &#123;
        return on;
    &#125;

    @Override
    public void enable() &#123;
        on = true;
    &#125;

    @Override
    public void disable() &#123;
        on = false;
    &#125;

    @Override
    public int getVolume() &#123;
        return volume;
    &#125;

    @Override
    public void setVolume(int volume) &#123;
        if(!on) return;
        if (volume &gt; 100) &#123;
            this.volume = 100;
        &#125; else if (volume &lt; 0) &#123;
            this.volume = 0;
        &#125; else &#123;
            this.volume = volume;
        &#125;
    &#125;

    @Override
    public int getChannel() &#123;
        return channel;
    &#125;

    @Override
    public void setChannel(int channel) &#123;
        if(!on) return;
        this.channel = channel;
    &#125;

    @Override
    public void printStatus() &#123;
        System.out.println(&quot;------------------------------------&quot;);
        System.out.println(&quot;| I&#39;m TV set.&quot;);
        System.out.println(&quot;| I&#39;m &quot; + (on ? &quot;enabled&quot; : &quot;disabled&quot;));
        if(on) &#123;
            System.out.println(&quot;| Current volume is &quot; + volume + &quot;%&quot;);
            System.out.println(&quot;| Current channel is &quot; + channel);
        &#125;
        System.out.println(&quot;------------------------------------\n&quot;);
    &#125;
&#125;
</code></pre>
<p>3.创建遥控器接口</p>
<pre><code class="java">public interface Remote &#123;
    void power();
    void volumeDown();
    void volumeUp();
    void channelDown();
    void channelUp();
&#125;
</code></pre>
<p>4.创建基本的遥控器实现类，运用桥接技术，将设备对象作为成员。</p>
<pre><code class="java">public class BasicRemote implements Remote &#123;
    protected Device device;

    public BasicRemote() &#123;&#125;

    public BasicRemote(Device device) &#123;
        this.device = device;
    &#125;

    @Override
    public void power() &#123;
        System.out.println(&quot;Remote: power toggle&quot;);
        if (device.isEnabled()) &#123;
            device.disable();
        &#125; else &#123;
            device.enable();
        &#125;
    &#125;

    @Override
    public void volumeDown() &#123;
        System.out.println(&quot;Remote: volume down&quot;);
        device.setVolume(device.getVolume() - 10);
    &#125;

    @Override
    public void volumeUp() &#123;
        System.out.println(&quot;Remote: volume up&quot;);
        device.setVolume(device.getVolume() + 10);
    &#125;

    @Override
    public void channelDown() &#123;
        System.out.println(&quot;Remote: channel down&quot;);
        device.setChannel(device.getChannel() - 1);
    &#125;

    @Override
    public void channelUp() &#123;
        System.out.println(&quot;Remote: channel up&quot;);
        device.setChannel(device.getChannel() + 1);
    &#125;
&#125;
</code></pre>
<p>5.创建高级遥控器类，继承了基本遥控器，增添了静音的新功能。</p>
<pre><code class="java">public class AdvancedRemote extends BasicRemote &#123;

    public AdvancedRemote(Device device) &#123;
        super.device = device;
    &#125;

    public void mute() &#123;
        if(!device.isEnabled()) return;
        System.out.println(&quot;Remote: mute&quot;);
        device.setVolume(0);
    &#125;
&#125;
</code></pre>
<p>6.客户端分别利用基本遥控器和高级遥控器去控制电视和收音机。</p>
<pre><code class="java">public class Demo &#123;
    public static void main(String[] args) &#123;
        testDevice(new Radio());
        testDevice(new Tv());
    &#125;

    public static void testDevice(Device device) &#123;
        System.out.println(&quot;Tests with basic remote.&quot;);
        BasicRemote basicRemote = new BasicRemote(device);
        device.printStatus();
        basicRemote.power();
        device.printStatus();

        System.out.println(&quot;Tests with advanced remote.&quot;);
        AdvancedRemote advancedRemote = new AdvancedRemote(device);
        advancedRemote.mute();
        device.printStatus();
    &#125;
&#125;
</code></pre>
<p>7.打印结果</p>
<pre><code>Tests with basic remote.
------------------------------------
| I&#39;m radio.
| I&#39;m disabled
------------------------------------

Remote: power toggle
------------------------------------
| I&#39;m radio.
| I&#39;m enabled
| Current volume is 30%
| Current channel is 1
------------------------------------

Tests with advanced remote.
Remote: mute
------------------------------------
| I&#39;m radio.
| I&#39;m enabled
| Current volume is 0%
| Current channel is 1
------------------------------------

Tests with basic remote.
------------------------------------
| I&#39;m TV set.
| I&#39;m disabled
------------------------------------

Remote: power toggle
------------------------------------
| I&#39;m TV set.
| I&#39;m enabled
| Current volume is 30%
| Current channel is 1
------------------------------------

Tests with advanced remote.
Remote: mute
------------------------------------
| I&#39;m TV set.
| I&#39;m enabled
| Current volume is 0%
| Current channel is 1
------------------------------------
</code></pre>
<h3 id="模式结构-5"><a href="#模式结构-5" class="headerlink" title="模式结构"></a>模式结构</h3><ul>
<li><strong>物品1</strong>：一个物品类的抽象声明</li>
<li><strong>具体物品</strong>：物品1的具体实现类</li>
<li><strong>物品2</strong>：另一个物品类的抽象声明</li>
<li><strong>具体物品</strong>：物品2的具体实现类，并引用了物品1对象，完成桥接功能</li>
</ul>
<h3 id="优点-6"><a href="#优点-6" class="headerlink" title="优点"></a>优点</h3><ul>
<li>开闭原则。 你可以新增抽象部分和实现部分， 且它们之间不会相互影响。</li>
<li>单一职责原则。 抽象部分专注于处理高层逻辑， 实现部分处理平台细节。</li>
<li>抽象和实现分离，客户端代码仅与高层抽象部分进行互动， 不会接触到平台的详细信息。</li>
</ul>
<h3 id="缺点-6"><a href="#缺点-6" class="headerlink" title="缺点"></a>缺点</h3><ul>
<li>对高内聚的类使用该模式可能会让代码更加复杂。</li>
</ul>
<h2 id="组合模式（Composite）"><a href="#组合模式（Composite）" class="headerlink" title="组合模式（Composite）"></a>组合模式（Composite）</h2><h3 id="意图-7"><a href="#意图-7" class="headerlink" title="意图"></a>意图</h3><p>这种模式创建了一个包含自己对象组的类，把一组相似的对象当作一个单一的对象，组合模式依据树形结构来组合对象，用来表示部分以及整体层次。使得用户对单个对象和组合对象的使用具有一致性。</p>
<h3 id="使用场景-7"><a href="#使用场景-7" class="headerlink" title="使用场景"></a>使用场景</h3><ul>
<li>希望用户忽略组合对象与单个对象的不同，用户将统一地使用组合结构中的所有对象。</li>
</ul>
<h3 id="示例问题-7"><a href="#示例问题-7" class="headerlink" title="示例问题"></a>示例问题</h3><p>比如在 JAVA AWT 和 SWING 中，对于 Button 和 Checkbox 是树叶，Container 是树枝。在现实生活中，职场职位关系也是如此，有一个大boss，下面是各类主管，再细分到普通员工。</p>
<p>这里要求设计可以画出有圆形、矩形还有点的组合图像或者单独画圆形、矩形形状。声明一个 <code>Shape</code> 抽象类，用一个 <code>BasicShape</code> 类实现一些基本功能， 创建其子类 <code>Circle</code> <code>Dot</code> <code>Rectangle</code>和 <code>CompoundShape</code>，客户端 <code>ImageEditor</code> 利用 <code>CompoundShape</code>对象完成作图。</p>
<p>相当于一个部门叫 <code>Shape</code>，基层员工有 <code>Circle</code> <code>Dor</code> <code>Rectangel</code>，<code>CompundShape</code> 是他们的上司，对内分派他们的工作。</p>
<p>1.创建形状抽象类，声明一些基本操作</p>
<pre><code class="java">import java.awt.*;

public interface Shape &#123;
    int getX();
    int getY();
    int getWidth();
    int getHeight();
    void move(int x, int y);
    boolean isInsideBounds(int x, int y);
    void select();
    void unSelect();
    boolean isSelected();
    void paint(Graphics graphics);
&#125;
</code></pre>
<p>2.创建基本形状类，实现一些基本的功能，作为其他形状或组合形状的父类。</p>
<pre><code class="java">import java.awt.*;

public class BaseShape implements Shape&#123;
    public int x;
    public int y;
    public Color color;
    private boolean selected = false;

    BaseShape(int x, int y, Color color) &#123;
        this.x = x;
        this.y = y;
        this.color = color;
    &#125;

    @Override
    public int getX() &#123;
        return x;
    &#125;

    @Override
    public int getY() &#123;
        return y;
    &#125;

    @Override
    public int getWidth() &#123;
        return 0;
    &#125;

    @Override
    public int getHeight() &#123;
        return 0;
    &#125;

    @Override
    public void move(int x, int y) &#123;
        this.x += x;
        this.y += y;
    &#125;

    @Override
    public boolean isInsideBounds(int x, int y) &#123;
        return x &gt; getX() &amp;&amp; x &lt; (getX() + getWidth()) &amp;&amp;
                y &gt; getY() &amp;&amp; y &lt; (getY() + getHeight());
    &#125;

    @Override
    public void select() &#123;
        selected = true;
    &#125;

    @Override
    public void unSelect() &#123;
        selected = false;
    &#125;

    @Override
    public boolean isSelected() &#123;
        return selected;
    &#125;

    void enableSelectionStyle(Graphics graphics) &#123;
        graphics.setColor(Color.LIGHT_GRAY);

        Graphics2D g2 = (Graphics2D) graphics;
        float dash1[] = &#123;2.0f&#125;;
        g2.setStroke(new BasicStroke(1.0f,
                BasicStroke.CAP_BUTT,
                BasicStroke.JOIN_MITER,
                2.0f, dash1, 0.0f));
    &#125;

    void disableSelectionStyle(Graphics graphics) &#123;
        graphics.setColor(color);
        Graphics2D g2 = (Graphics2D) graphics;
        g2.setStroke(new BasicStroke());
    &#125;


    @Override
    public void paint(Graphics graphics) &#123;
        if (isSelected()) &#123;
            enableSelectionStyle(graphics);
        &#125; else &#123;
            disableSelectionStyle(graphics);
        &#125;
    &#125;
&#125;
</code></pre>
<p>3.创建单个的形状</p>
<pre><code class="java">import java.awt.*;

public class Dot extends BaseShape &#123;
    private final int DOT_SIZE = 3;

    public Dot(int x, int y, Color color) &#123;
        super(x, y, color);
    &#125;

    @Override
    public int getWidth() &#123;
        return DOT_SIZE;
    &#125;

    @Override
    public int getHeight() &#123;
        return DOT_SIZE;
    &#125;

    @Override
    public void paint(Graphics graphics) &#123;
        super.paint(graphics);
        graphics.fillRect(x - 1, y - 1, getWidth(), getHeight());
    &#125;
&#125;
</code></pre>
<pre><code class="java">import java.awt.*;

public class Circle extends BaseShape &#123;
    public int radius;

    public Circle(int x, int y, int radius, Color color) &#123;
        super(x, y, color);
        this.radius = radius;
    &#125;

    @Override
    public int getWidth() &#123;
        return radius * 2;
    &#125;

    @Override
    public int getHeight() &#123;
        return radius * 2;
    &#125;

    public void paint(Graphics graphics) &#123;
        super.paint(graphics);
        graphics.drawOval(x, y, getWidth() - 1, getHeight() - 1);
    &#125;
&#125;
</code></pre>
<pre><code class="java">import java.awt.*;

public class Rectangle extends BaseShape &#123;
    public int width;
    public int height;

    public Rectangle(int x, int y, int width, int height, Color color) &#123;
        super(x, y, color);
        this.width = width;
        this.height = height;
    &#125;

    @Override
    public int getWidth() &#123;
        return width;
    &#125;

    @Override
    public int getHeight() &#123;
        return height;
    &#125;

    @Override
    public void paint(Graphics graphics) &#123;
        super.paint(graphics);
        graphics.drawRect(x, y, getWidth() - 1, getHeight() - 1);
    &#125;
&#125;
</code></pre>
<p>4.创建组合形状类，内部属性 List，里面放其他单个形状引用。</p>
<pre><code class="java">import java.awt.*;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

public class CompoundShape extends BaseShape &#123;
    protected List&lt;Shape&gt; children = new ArrayList&lt;&gt;();

    public CompoundShape(Shape... components) &#123;
        super(0, 0, Color.BLACK);
        add(components);
    &#125;

    public void add(Shape component) &#123;
        children.add(component);
    &#125;

    public void add(Shape... components) &#123;
        children.addAll(Arrays.asList(components));
    &#125;

    public void remove(Shape child) &#123;
        children.remove(child);
    &#125;

    public void remove(Shape... components) &#123;
        children.removeAll(Arrays.asList(components));
    &#125;

    public void clear() &#123;
        children.clear();
    &#125;

    @Override
    public int getX() &#123;
        if (children.size() == 0) &#123;
            return 0;
        &#125;
        int x = children.get(0).getX();
        for (Shape child : children) &#123;
            if (child.getX() &lt; x) &#123;
                x = child.getX();
            &#125;
        &#125;
        return x;
    &#125;

    @Override
    public int getY() &#123;
        if (children.size() == 0) &#123;
            return 0;
        &#125;
        int y = children.get(0).getY();
        for (Shape child : children) &#123;
            if (child.getY() &lt; y) &#123;
                y = child.getY();
            &#125;
        &#125;
        return y;
    &#125;

    @Override
    public int getWidth() &#123;
        int maxWidth = 0;
        int x = getX();
        for (Shape child : children) &#123;
            int childsRelativeX = child.getX() - x;
            int childWidth = childsRelativeX + child.getWidth();
            if (childWidth &gt; maxWidth) &#123;
                maxWidth = childWidth;
            &#125;
        &#125;
        return maxWidth;
    &#125;

    @Override
    public int getHeight() &#123;
        int maxHeight = 0;
        int y = getY();
        for (Shape child : children) &#123;
            int childsRelativeY = child.getY() - y;
            int childHeight = childsRelativeY + child.getHeight();
            if (childHeight &gt; maxHeight) &#123;
                maxHeight = childHeight;
            &#125;
        &#125;
        return maxHeight;
    &#125;

    @Override
    public void move(int x, int y) &#123;
        for (Shape child : children) &#123;
            //移动组合图像要求每个部分都要移动
            child.move(x, y);
        &#125;
    &#125;

    @Override
    public boolean isInsideBounds(int x, int y) &#123;
        //只要组合图像有一部分在图纸里就返回真
        for (Shape child : children) &#123;
            if (child.isInsideBounds(x, y)) &#123;
                return true;
            &#125;
        &#125;
        return false;
    &#125;

    @Override
    public void unSelect() &#123;
        super.unSelect();
        for (Shape child : children) &#123;
            child.unSelect();
        &#125;
    &#125;

    public boolean selectChildAt(int x, int y) &#123;
        for (Shape child : children) &#123;
            if (child.isInsideBounds(x, y)) &#123;
                child.select();
                return true;
            &#125;
        &#125;
        return false;
    &#125;


    @Override
    public void paint(Graphics graphics) &#123;
        if (isSelected()) &#123;
            enableSelectionStyle(graphics);
            graphics.drawRect(getX() - 1, getY() - 1, getWidth() + 1, getHeight() + 1);
            disableSelectionStyle(graphics);
        &#125;

        for (Shape child : children) &#123;
            child.paint(graphics);
        &#125;
    &#125;
&#125;
</code></pre>
<p>5.创建客户端应用类 <code>ImageEdior</code>，引用了组合形状对象，在画布上画出所有形状。</p>
<pre><code class="java">import javax.swing.*;
import javax.swing.border.Border;
import java.awt.*;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;

public class ImageEditor &#123;
    private EditorCanvas canvas;
    private CompoundShape allShapes = new CompoundShape();

    public ImageEditor() &#123;
        canvas = new EditorCanvas();
    &#125;

    public void loadShapes(Shape... shapes) &#123;
        allShapes.clear();
        allShapes.add(shapes);
        canvas.refresh();
    &#125;

    /**
     * 设置画布
     */
    private class EditorCanvas extends Canvas &#123;
        JFrame frame;

        private static final int PADDING = 10; //留白

        EditorCanvas() &#123;
            createFrame();
            refresh();
            addMouseListener(new MouseAdapter() &#123;
                @Override
                public void mousePressed(MouseEvent e) &#123;
                    allShapes.unSelect();
                    allShapes.selectChildAt(e.getX(), e.getY());
                    e.getComponent().repaint();
                &#125;
            &#125;);
        &#125;

        void createFrame() &#123;
            frame = new JFrame();
            frame.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);
            frame.setLocationRelativeTo(null);

            JPanel contentPanel = new JPanel();
            Border padding = BorderFactory.createEmptyBorder(PADDING, PADDING, PADDING, PADDING);
            contentPanel.setBorder(padding);
            frame.setContentPane(contentPanel);

            frame.add(this);
            frame.setVisible(true);
            frame.getContentPane().setBackground(Color.LIGHT_GRAY);
        &#125;

        public int getWidth() &#123;
            return allShapes.getX() + allShapes.getWidth() + PADDING;
        &#125;

        public int getHeight() &#123;
            return allShapes.getY() + allShapes.getHeight() + PADDING;
        &#125;

        void refresh() &#123;
            this.setSize(getWidth(), getHeight());
            frame.pack();
        &#125;

        public void paint(Graphics graphics) &#123;
            allShapes.paint(graphics);
        &#125;
    &#125;
&#125;
</code></pre>
<p>6.测试代码</p>
<pre><code class="java">import java.awt.*;

public class Demo &#123;
    public static void main(String[] args) &#123;
        ImageEditor editor = new ImageEditor();

        editor.loadShapes(
                new Circle(10, 10, 10, Color.BLUE),

                new CompoundShape(
                        new Circle(110, 110, 50, Color.RED),
                        new Dot(160, 160, Color.RED)
                ),

                new CompoundShape(
                        new Rectangle(250, 250, 100, 100, Color.GREEN),
                        new Dot(240, 240, Color.GREEN),
                        new Dot(240, 360, Color.GREEN),
                        new Dot(360, 360, Color.GREEN),
                        new Dot(360, 240, Color.GREEN)
                )
        );
    &#125;
&#125;
</code></pre>
<p>7.图像输出</p>
<p><img src="https://refactoringguru.cn/images/patterns/examples/java/composite/OutputDemo.png"></p>
<h3 id="模式结构-6"><a href="#模式结构-6" class="headerlink" title="模式结构"></a>模式结构</h3><ul>
<li><strong>组件</strong>：抽象类，声明树中的操作。</li>
<li><strong>叶节点</strong>：是树的基本结构， 它不包含子项目。一般情况下， 叶节点最终会完成大部分的实际工作， 因为它们无法将工作指派给其他部分。</li>
<li><strong>容器/组合</strong> ：是包含叶节点或其他容器等子项目的单位。 容器不知道其子项目所属的具体类， 它只通过通用的组件接口与其子项目交互。容器接收到请求后会将工作分配给自己的子项目， 处理中间结果， 然后将最终结果返回给客户端。</li>
</ul>
<h3 id="优点-7"><a href="#优点-7" class="headerlink" title="优点"></a>优点</h3><ul>
<li>开闭原则。 无需更改现有代码， 你就可以在应用中添加新元素， 使其成为对象树的一部分。</li>
</ul>
<h3 id="缺点-7"><a href="#缺点-7" class="headerlink" title="缺点"></a>缺点</h3><ul>
<li>对于功能差异较大的类， 提供公共接口会有困难。</li>
<li>在客户端使用时，依赖于其叶子和枝干，而不是依赖于抽象类，违反了依赖倒置原则。</li>
</ul>
<h2 id="装饰模式（Decorator）"><a href="#装饰模式（Decorator）" class="headerlink" title="装饰模式（Decorator）"></a>装饰模式（Decorator）</h2><h3 id="意图-8"><a href="#意图-8" class="headerlink" title="意图"></a>意图</h3><p>这种模式创建了一个装饰类，用来包装原有的类，并在保持类方法签名完整性的前提下，提供了额外的功能。通过将对象放入包含行为的特殊封装对象中来为原对象绑定新的行为。</p>
<p>有些像俄罗斯套娃。</p>
<h3 id="使用场景-8"><a href="#使用场景-8" class="headerlink" title="使用场景"></a>使用场景</h3><p>希望在不修改原类代码的情况下即可使用对象，并希望增添额外功能。</p>
<h3 id="示例问题-8"><a href="#示例问题-8" class="headerlink" title="示例问题"></a>示例问题</h3><p>有一个 <code>DataSource</code> 类声明了基本的数据读写方法，<code>FileDataSource</code> 是其具体实现。现在希望在不改变原代码的基础上，增添可以对数据进行加密和压缩的功能。</p>
<p>可以定义一个抽象装饰类 <code>DataSourceDecorator</code> 实现<code>DataSource</code>，再利用 <code>EncryptionDecorator</code> 和 <code>CompressionDecorator</code> 继承抽象装饰类完成具体的加密和压缩功能。</p>
<p>1.创建抽象<code>DataSource</code> 类，定义读写操作</p>
<pre><code class="java">public interface DataSource &#123;
    void writeData(String data);

    String readData();
&#125;
</code></pre>
<p>2.创建<code>FileDataSource</code>类，完成文件读写操作</p>
<pre><code class="java">import java.io.*;
public class FileDataSource implements DataSource&#123;
    private String name;
    public FileDataSource(String name) &#123;
        this.name = name;
    &#125;

    @Override
    public void writeData(String data) &#123;
        File file = new File(name);
        try(OutputStream fos = new FileOutputStream(file)) &#123;
            fos.write(data.getBytes(), 0, data.length());
        &#125; catch (IOException ex) &#123;
            System.out.println(ex.getMessage());
        &#125;
    &#125;

    @Override
    public String readData() &#123;
        char[] buffer = null;
        File file = new File(name);
        try(FileReader reader = new FileReader(file)) &#123;
            buffer = new char[(int) file.length()];
            reader.read(buffer);
        &#125; catch (IOException ex) &#123;
            System.out.println(ex.getMessage());
        &#125;
        return new String(buffer);
     &#125;
&#125;
</code></pre>
<p>3.创建基础抽象装饰类</p>
<pre><code class="java">public class DataSourceDecorator implements DataSource&#123;
    private DataSource wrappee;

    DataSourceDecorator(DataSource dataSource) &#123;
        this.wrappee = dataSource;
    &#125;
    //抽象基础装饰类不会有实际的扩展方法实现
    @Override
    public void writeData(String data) &#123;
        wrappee.writeData(data);
    &#125;

    @Override
    public String readData() &#123;
        return wrappee.readData();
    &#125;
&#125;
</code></pre>
<p>4.创建加密装饰类，继承基础装饰类，写扩展的加密解密功能方法</p>
<pre><code class="java">import java.util.Base64;

public class EncryptionDecorator extends DataSourceDecorator &#123;
    public EncryptionDecorator(DataSource dataSource) &#123;
        super(dataSource);
    &#125;

    @Override
    public void writeData(String data) &#123;
        super.writeData(encode(data));
    &#125;

    @Override
    public String readData() &#123;
        return decode(super.readData());
    &#125;

    public String encode(String data) &#123;
        byte[] result = data.getBytes();
        for(int i = 0; i &lt; result.length; i++) &#123;
            result[i] += (byte) 1;
        &#125;
        return Base64.getEncoder().encodeToString(result);
    &#125;

    public String decode(String data) &#123;
        byte[] result = Base64.getDecoder().decode(data);
        for(int i = 0; i &lt; result.length; i++) &#123;
            result[i] -= (byte) 1;
        &#125;
        return new String(result);
    &#125;
&#125;
</code></pre>
<p>5.创建压缩装饰类，继承基础装饰类，写扩展的加压解压功能方法</p>
<pre><code class="java">import java.io.ByteArrayInputStream;
import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.util.zip.Deflater;
import java.util.zip.DeflaterOutputStream;
import java.util.Base64;
import java.util.zip.InflaterInputStream;

public class CompressionDecorator extends DataSourceDecorator &#123;
    private int compLevel = 6;

    public CompressionDecorator(DataSource source) &#123;
        super(source);
    &#125;

    public int getCompressionLevel() &#123;
        return compLevel;
    &#125;

    public void setCompressionLevel(int value) &#123;
        this.compLevel = value;
    &#125;

    @Override
    public void writeData(String data) &#123;
        super.writeData(compress(data));
    &#125;

    @Override
    public String readData() &#123;
        return decompress(super.readData());
    &#125;


    public String compress(String stringData) &#123;
        byte[] data = stringData.getBytes();
        try &#123;
            ByteArrayOutputStream bout = new ByteArrayOutputStream(512);
            DeflaterOutputStream dos = new DeflaterOutputStream(bout, new Deflater(compLevel));
            dos.write(data);
            dos.close();
            bout.close();
            return java.util.Base64.getEncoder().encodeToString(bout.toByteArray());
        &#125; catch (IOException ex) &#123;
            return null;
        &#125;
    &#125;

    private String decompress(String stringData) &#123;
        byte[] data = Base64.getDecoder().decode(stringData);
        try &#123;
            InputStream in = new ByteArrayInputStream(data);
            InflaterInputStream iin = new InflaterInputStream(in);
            ByteArrayOutputStream bout = new ByteArrayOutputStream(512);
            int b;
            while ((b = iin.read()) != -1) &#123;
                bout.write(b);
            &#125;
            in.close();
            iin.close();
            bout.close();
            return new String(bout.toByteArray());
        &#125; catch (IOException ex) &#123;
            return null;
        &#125;
    &#125;
&#125;
</code></pre>
<p>6.编写测试类</p>
<pre><code class="java">public class Demo &#123;
    public static void main(String[] args) &#123;
        String salaryRecords = &quot;Name,Salary\nJohn Smith,100000\nSteven Jobs,912000&quot;;
        DataSourceDecorator encoded = new CompressionDecorator(
                new EncryptionDecorator(
                        new FileDataSource(&quot;out/OutputDemo.txt&quot;)));
        //encoded写数据时会调用压缩类的writeData方法，从而调用压缩方法
        //而压缩对象里面引用的对象时加密类，所以会调用加密类的writData，从而调用加密方法
        //而加密对象引用了文件对象，所以会调用文件的wrteData
        encoded.writeData(salaryRecords);
        DataSource plain = new FileDataSource(&quot;out/OutputDemo.txt&quot;);

        System.out.println(&quot;- Input ----------------&quot;);
        System.out.println(salaryRecords);
        System.out.println(&quot;- Encoded --------------&quot;);
        System.out.println(plain.readData());
        System.out.println(&quot;- Decoded --------------&quot;);
        System.out.println(encoded.readData());
    &#125;
&#125;
</code></pre>
<p>7.输出结果</p>
<pre><code>- Input ----------------
Name,Salary
John Smith,100000
Steven Jobs,912000
- Encoded --------------
Zkt7e1Q5eU8yUm1Qe0ZsdHJ2VXp6dDBKVnhrUHtUe0sxRUYxQkJIdjVLTVZ0dVI5Q2IwOXFISmVUMU5rcENCQmdxRlByaD4+
- Decoded --------------
Name,Salary
John Smith,100000
Steven Jobs,912000
</code></pre>
<h3 id="模式结构-7"><a href="#模式结构-7" class="headerlink" title="模式结构"></a>模式结构</h3><ul>
<li><strong>声明一些基本功能的接口与其实现类</strong></li>
<li><strong>实现接口的抽象基础装饰类</strong></li>
<li><strong>继承基础装饰类的实际装饰类</strong>：真正实现功能扩展</li>
</ul>
<h3 id="优点-8"><a href="#优点-8" class="headerlink" title="优点"></a>优点</h3><ul>
<li>装饰类和被装饰类可以独立发展，不会相互耦合</li>
<li>单一职责原则。 你可以将实现了许多不同行为的一个大类拆分为多个较小的类。</li>
<li>装饰模式可以动态扩展一个实现类的功能</li>
</ul>
<h3 id="缺点-8"><a href="#缺点-8" class="headerlink" title="缺点"></a>缺点</h3><ul>
<li>实现行为不受装饰栈顺序影响的装饰比较困难</li>
<li>各层的初始化配置代码看上去可能会很冗长</li>
</ul>
<h2 id="外观模式（Facade）"><a href="#外观模式（Facade）" class="headerlink" title="外观模式（Facade）"></a>外观模式（Facade）</h2><h3 id="意图-9"><a href="#意图-9" class="headerlink" title="意图"></a>意图</h3><p>隐藏系统的复杂性，并向客户端提供了一个客户端可以访问系统的接口。通过向现有的系统添加一个接口，来隐藏系统的复杂性。</p>
<h3 id="使用场景-9"><a href="#使用场景-9" class="headerlink" title="使用场景"></a>使用场景</h3><p>客户端不需要知道系统内部的复杂联系，整个系统只需提供一个”接待员”即可</p>
<h3 id="示例问题-9"><a href="#示例问题-9" class="headerlink" title="示例问题"></a>示例问题</h3><p>要用到一个音频编解码器，需要将读到的MP4文件转化压缩成ogg文件，将独到的ogg文件解压成为MP4文件，必须使用某个复杂的库或框架中的众多对象。通过设计一个外观类，为包含许多活动部件的复杂子系统提供一个简单的接口。 与直接调用子系统相比， 外观提供的功能可能比较有限， 但它却包含了客户端真正关心的功能。</p>
<p>类的结构如下：</p>
<p><img src="https://refactoringguru.cn/images/patterns/diagrams/facade/example.png"></p>
<p>1.创建需要被外观类用到的类</p>
<pre><code class="java">//定义音频文件类
public class VideoFile &#123;
    private String name;
    private String codecType;

    public VideoFile(String name) &#123;
        this.name = name;
        this.codecType = name.substring(name.indexOf(&quot;.&quot;) + 1);
    &#125;

    public String getName() &#123;
        return name;
    &#125;

    public String getCodecType() &#123;
        return codecType;
    &#125;
&#125;
</code></pre>
<pre><code class="java">//声明编解码器
public interface Codec &#123;
&#125;
</code></pre>
<pre><code class="java">//定义MPEG4的压缩编解码器
public class MPEG4CompressionCodec implements Codec &#123;
    public String type = &quot;mp4&quot;;
&#125;
</code></pre>
<pre><code class="java">//定义OGG的压缩编解码器
public class OggCompressionCodec implements Codec &#123;
    public String type = &quot;ogg&quot;;
&#125;
</code></pre>
<pre><code class="java">//编解码
public class CodecFactory &#123;
    public static Codec extract(VideoFile file) &#123;
        String type = file.getCodecType();
        if(type.equals(&quot;mp4&quot;)) &#123;
            System.out.println(&quot;CodecFactory: extracting mpeg audio...&quot;);
            return new MPEG4CompressionCodec();
        &#125; else &#123;
            System.out.println(&quot;CodecFactory: extracting ogg audio...&quot;);
            return new OggCompressionCodec();
        &#125;
    &#125;
&#125;
</code></pre>
<pre><code class="java">public class BitrateReader &#123;
    public static VideoFile read(VideoFile file, Codec codec) &#123;
        System.out.println(&quot;BitrateReader: reading file...&quot;);
        return file;
    &#125;

    public static VideoFile convert(VideoFile buffer, Codec codec) &#123;
        System.out.println(&quot;BitrateReader: writing file...&quot;);
        return buffer;
    &#125;
&#125;
</code></pre>
<pre><code class="java">import java.io.File;

public class AudioMixer &#123;
    public File fix(VideoFile result) &#123;
        System.out.println(&quot;AudioMixer: fixing audio...&quot;);
        return new File(&quot;tmp&quot;);
    &#125;
&#125;
</code></pre>
<p>2.创建一个外观类，通过上面那些类应用来完成视频格式转换</p>
<pre><code class="java">//格式转换
import java.io.File;

public class VideoConversionFacade &#123;
    public File convertVideo(String fileName, String format) &#123;
        System.out.println(&quot;VideoConversionFacade: conversion started.&quot;);
        VideoFile file = new VideoFile(fileName);
        Codec sourceCodec = CodecFactory.extract(file);
        Codec destinationCodec;
        if(format.equals(&quot;mp4&quot;)) &#123;
            destinationCodec = new MPEG4CompressionCodec();
        &#125; else &#123;
            destinationCodec = new OggCompressionCodec();
        &#125;
        VideoFile buffer = BitrateReader.read(file, sourceCodec);
        VideoFile intermediateResult = BitrateReader.convert(buffer, destinationCodec);
        File result = (new AudioMixer()).fix(intermediateResult);
        System.out.println(&quot;VideoConversionFacade: conversion completed.&quot;);
        return result;
    &#125;
&#125;
</code></pre>
<p>3.编写测试代码</p>
<pre><code class="java">import java.io.File;

public class Demo &#123;
    public static void main(String[] args) &#123;
        VideoConversionFacade converter = new VideoConversionFacade();
        File mp4Video = converter.convertVideo(&quot;youtubevideo.ogg&quot;, &quot;mp4&quot;);
    &#125;
&#125;
</code></pre>
<p>4.输出结果</p>
<pre><code class="java">VideoConversionFacade: conversion started.
CodecFactory: extracting ogg audio...
BitrateReader: reading file...
BitrateReader: writing file...
AudioMixer: fixing audio...
VideoConversionFacade: conversion completed.
</code></pre>
<h3 id="模式结构-8"><a href="#模式结构-8" class="headerlink" title="模式结构"></a>模式结构</h3><ul>
<li><strong>一些基本的类、库</strong></li>
<li><strong>外观类</strong>：通过整合多个库达到功能实现</li>
</ul>
<h3 id="优点-9"><a href="#优点-9" class="headerlink" title="优点"></a>优点</h3><ul>
<li>可以让自己的代码独立于复杂子系统。</li>
<li>减少系统相互依赖。</li>
</ul>
<h3 id="缺点-9"><a href="#缺点-9" class="headerlink" title="缺点"></a>缺点</h3><ul>
<li>外观可能成为与程序中所有类都耦合的<a target="_blank" rel="noopener" href="https://refactoringguru.cn/antipatterns/god-object">上帝对象</a>。</li>
<li>不符合开闭原则，如果要改东西很麻烦，继承重写都不合适。</li>
</ul>
<h2 id="享元模式（Flyweight）"><a href="#享元模式（Flyweight）" class="headerlink" title="享元模式（Flyweight）"></a>享元模式（Flyweight）</h2><h3 id="意图-10"><a href="#意图-10" class="headerlink" title="意图"></a>意图</h3><p>不会在每个对象中保存所有数据， 而是通过共享多个对象所共有的相同状态， 让你能在有限的内存容量中载入更多对象。</p>
<p>由于享元对象可在不同的情景中使用， 你必须确保其状态不能被修改。 享元类的状态只能由构造函数的参数进行一次性初始化， 它不能对其他对象公开其设置器或公有成员变量。</p>
<p>对象的常量数据通常被称为<em>内在状态</em>， 其位于对象中， 其他对象只能读取但不能修改其数值。 而对象的其他状态常常能被其他对象 “从外部” 改变， 因此被称为<em>外在状态</em>。</p>
<p>享元模式建议不在对象中存储外在状态， 而是将其传递给依赖于它的一个特殊方法。 <strong>程序只在对象中保存内在状态， 以方便在不同情景下重用。</strong> 这些对象的区别仅在于其内在状态 （与外在状态相比， 内在状态的变体要少很多）， 因此你所需的对象数量会大大削减。</p>
<h3 id="使用场景-10"><a href="#使用场景-10" class="headerlink" title="使用场景"></a>使用场景</h3><ul>
<li>系统中有大量对象，消耗了大量内存</li>
<li>系统不依赖于这些对象身份，这些对象是不可分辨的</li>
</ul>
<h3 id="示例问题-10"><a href="#示例问题-10" class="headerlink" title="示例问题"></a>示例问题</h3><p>要渲染一片森林 （1,000,000 棵树）， 每棵树都由包含一些状态的对象来表示 （坐标和纹理等），很显然它需要消耗大量内存。</p>
<p>原因很简单： 太多树对象包含重复数据 （名称、 纹理和颜色）。 因此我们可用享元模式来将这些数值存储在单独的享元对象中 （ <code>Tree­Type</code>类）。 现在我们不再将相同数据存储在数千个 <code>Tree</code>对象中， 而是使用一组特殊的数值来引用其中一个享元对象。</p>
<p>客户端代码不会知道任何事情， 因为重用享元对象的复杂机制隐藏在了享元工厂中。</p>
<p>1.创建 <code>Tree</code> 类，包含每棵树的独特状态</p>
<pre><code class="java">import java.awt.*;

public class Tree &#123;
    private int x;
    private int y;
    private TreeType type;

    public Tree(int x, int y, TreeType type) &#123;
        this.x = x;
        this.y = y;
        this.type = type;
    &#125;

    public void draw(Graphics g) &#123;
        type.draw(g, x, y);
    &#125;
&#125;
</code></pre>
<p>2.创建 TreeType 类，包含多棵树共享的状态</p>
<pre><code class="java">import java.awt.*;

public class TreeType &#123;
    private String name;
    private Color color;
    private String otherTreeData;

    public TreeType(String name, Color color, String otherTreeData) &#123;
        this.name = name;
        this.color = color;
        this.otherTreeData = otherTreeData;
    &#125;

    public void draw(Graphics g, int x, int y) &#123;
        g.setColor(Color.BLACK);
        g.fillRect(x - 1, y, 3, 5);
        g.setColor(color);
        g.fillOval(x - 5, y - 10, 10, 10);
    &#125;
&#125;
</code></pre>
<p>3.创建 TreeFactory 类，封装创建享元，避免重复创建。</p>
<pre><code class="java">import java.awt.*;
import java.util.HashMap;
import java.util.Map;

public class TreeFactory &#123;
    static Map&lt;String, TreeType&gt; treeTypes = new HashMap&lt;&gt;();

    public static TreeType getTreeType(String name, Color color, String otherTreeData) &#123;
        TreeType result = treeTypes.get(name);
        //如果没有创建过该类型，要创建一个新对象
        if(result == null) &#123;
            result = new TreeType(name, color, otherTreeData);
            treeTypes.put(name, result);
        &#125;
        return  result;
    &#125;
&#125;
</code></pre>
<p>4.创建 Forest 类，用一个数组来存放具有独特特性的 Tree 对象。</p>
<pre><code class="java">import javax.swing.*;
import java.awt.*;
import java.util.ArrayList;
import java.util.List;

public class Forest extends JFrame &#123;
    private List&lt;Tree&gt; trees = new ArrayList&lt;&gt;();

    public void plantTree(int x, int y, String name, Color color, String otherTreeData) &#123;
        TreeType type = TreeFactory.getTreeType(name, color, otherTreeData);
        Tree tree = new Tree(x, y, type);
        trees.add(tree);
    &#125;

    @Override
    public void paint(Graphics graphics) &#123;
        for(Tree tree : trees) &#123;
            tree.draw(graphics);
        &#125;
    &#125;
&#125;
</code></pre>
<h3 id="模式结构-9"><a href="#模式结构-9" class="headerlink" title="模式结构"></a>模式结构</h3><blockquote>
<p>需要改写为享元的类成员变量拆分为两个部分：</p>
<ul>
<li>内在状态： 包含不变的、 可在许多对象中重复使用的数据的成员变量。</li>
<li>外在状态： 包含每个对象各自不同的情景数据的成员变量</li>
</ul>
</blockquote>
<ul>
<li><strong>享元类</strong>：含有外在状态的成员变量，以及被封装后的内在状态的成员对象</li>
<li><strong>保留类</strong>：包含内在状态成员变量，将其属性设置为不可修改。 这些变量仅可在构造函数中获得初始数值。</li>
<li><strong>享元工厂</strong>：将其属性设置为不可修改。 这些变量仅可在构造函数中获得初始数值。（可选择是否创建）</li>
</ul>
<h3 id="优点-10"><a href="#优点-10" class="headerlink" title="优点"></a>优点</h3><ul>
<li>如果程序中有很多相似对象， 那么你将可以节省大量内存。</li>
</ul>
<h3 id="缺点-10"><a href="#缺点-10" class="headerlink" title="缺点"></a>缺点</h3><ul>
<li>提高了系统的复杂度，需要分离出外部状态和内部状态，而且外部状态具有固有化的性质，不可以随着内部状态的变化而变化</li>
<li>需要牺牲执行速度来换取内存， 因为每次调用享元方法时都需要重新计算部分情景数据。</li>
</ul>
<h2 id="代理模式（Proxy）"><a href="#代理模式（Proxy）" class="headerlink" title="代理模式（Proxy）"></a>代理模式（Proxy）</h2><h3 id="意图-11"><a href="#意图-11" class="headerlink" title="意图"></a>意图</h3><p>一个类代表另一个类的功能，能够提供对象的替代品或其占位符。</p>
<h3 id="使用场景-11"><a href="#使用场景-11" class="headerlink" title="使用场景"></a>使用场景</h3><ul>
<li>在面向对象系统中，有些对象由于某些原因（比如对象创建开销很大，或者某些操作需要安全控制，或者需要进程外的访问），直接访问会给使用者或者系统结构带来很多麻烦，我们可以在访问此对象时加上一个对此对象的访问层。</li>
<li>延迟初始化。有一个偶尔使用的重量级服务对象，如果一直保持该对象的运行会消耗大量系统资源时可以使用代理模式。</li>
<li>访问控制。只希望特定客户端使用服务对象。</li>
<li>本地执行远程服务的代理，适用于服务对象位于远程服务器的情形。</li>
<li>记录日志请求，适用于需要缓存客户请求结果并对缓存生命周期进行管理时， 特别是当返回结果的体积非常大时。</li>
</ul>
<h3 id="示例问题-11"><a href="#示例问题-11" class="headerlink" title="示例问题"></a>示例问题</h3><p>需要在在第三方youtube视频库下载视频，程序库提供了视频下载类。 但是该类的效率非常低。 如果客户端程序多次请求同一视频， 程序库会反复下载该视频， 而不会将首次下载的文件缓存下来复用。</p>
<p>1.创建远程服务接口</p>
<pre><code class="java">import java.util.HashMap;

public interface ThirdPartyYouTubeLib &#123;
    HashMap&lt;String, Video&gt; popularVideos();

    Video getVideo(String videoId);
&#125;
</code></pre>
<p>2.创建远程服务实现类</p>
<pre><code class="java">import java.util.HashMap;

public class ThirdPartyYouTubeClass implements ThirdPartyYouTubeLib &#123;

    @Override
    public HashMap&lt;String, Video&gt; popularVideos() &#123;
        connectToServer(&quot;http://www.youtube.com&quot;);
        return getRandomVideos();
    &#125;

    @Override
    public Video getVideo(String videoId) &#123;
        connectToServer(&quot;http://www.youtube.com/&quot; + videoId);
        return getSomeVideo(videoId);
    &#125;

    // -----------------------------------------------------------------------
    // Fake methods to simulate network activity. They as slow as a real life.

    private int random(int min, int max) &#123;
        return min + (int) (Math.random() * ((max - min) + 1));
    &#125;

    private void experienceNetworkLatency() &#123;
        int randomLatency = random(5, 10);
        for (int i = 0; i &lt; randomLatency; i++) &#123;
            try &#123;
                Thread.sleep(100);
            &#125; catch (InterruptedException ex) &#123;
                ex.printStackTrace();
            &#125;
        &#125;
    &#125;

    private void connectToServer(String server) &#123;
        System.out.print(&quot;Connecting to &quot; + server + &quot;... &quot;);
        experienceNetworkLatency();
        System.out.print(&quot;Connected!&quot; + &quot;\n&quot;);
    &#125;

    private HashMap&lt;String, Video&gt; getRandomVideos() &#123;
        System.out.print(&quot;Downloading populars... &quot;);

        experienceNetworkLatency();
        HashMap&lt;String, Video&gt; hmap = new HashMap&lt;String, Video&gt;();
        hmap.put(&quot;catzzzzzzzzz&quot;, new Video(&quot;sadgahasgdas&quot;, &quot;Catzzzz.avi&quot;));
        hmap.put(&quot;mkafksangasj&quot;, new Video(&quot;mkafksangasj&quot;, &quot;Dog play with ball.mp4&quot;));
        hmap.put(&quot;dancesvideoo&quot;, new Video(&quot;asdfas3ffasd&quot;, &quot;Dancing video.mpq&quot;));
        hmap.put(&quot;dlsdk5jfslaf&quot;, new Video(&quot;dlsdk5jfslaf&quot;, &quot;Barcelona vs RealM.mov&quot;));
        hmap.put(&quot;3sdfgsd1j333&quot;, new Video(&quot;3sdfgsd1j333&quot;, &quot;Programing lesson#1.avi&quot;));

        System.out.print(&quot;Done!&quot; + &quot;\n&quot;);
        return hmap;
    &#125;

    private Video getSomeVideo(String videoId) &#123;
        System.out.print(&quot;Downloading video... &quot;);

        experienceNetworkLatency();
        Video video = new Video(videoId, &quot;Some video title&quot;);

        System.out.print(&quot;Done!&quot; + &quot;\n&quot;);
        return video;
    &#125;

&#125;
</code></pre>
<p>3.创建视频类</p>
<pre><code class="java">public class Video &#123;
    public String id;
    public String title;
    public String data;

    Video(String id, String title) &#123;
        this.id = id;
        this.title = title;
        this.data = &quot;Random video.&quot;;
    &#125;
&#125;
</code></pre>
<p>4.创建油管视频远程服务的缓存代理类，如果当前本地缓存没有请求对象才会向远程服务类发起获取请求。</p>
<pre><code class="java">import java.util.HashMap;

public class YouTubeCacheProxy implements ThirdPartyYouTubeLib &#123;
    private ThirdPartyYouTubeLib youtubeService;
    private HashMap&lt;String, Video&gt; cachePopular = new HashMap&lt;String, Video&gt;();
    private HashMap&lt;String, Video&gt; cacheAll = new HashMap&lt;String, Video&gt;();

    public YouTubeCacheProxy() &#123;
        this.youtubeService = new ThirdPartyYouTubeClass();
    &#125;

    @Override
    public HashMap&lt;String, Video&gt; popularVideos() &#123;
        if (cachePopular.isEmpty()) &#123;
            cachePopular = youtubeService.popularVideos();
        &#125; else &#123;
            System.out.println(&quot;Retrieved list from cache.&quot;);
        &#125;
        return cachePopular;
    &#125;

    @Override
    public Video getVideo(String videoId) &#123;
        Video video = cacheAll.get(videoId);
        if (video == null) &#123;
            video = youtubeService.getVideo(videoId);
            cacheAll.put(videoId, video);
        &#125; else &#123;
            System.out.println(&quot;Retrieved video &#39;&quot; + videoId + &quot;&#39; from cache.&quot;);
        &#125;
        return video;
    &#125;

    public void reset() &#123;
        cachePopular.clear();
        cacheAll.clear();
    &#125;
&#125;
</code></pre>
<p>5.创建油管应用客户端</p>
<pre><code class="java">import java.util.HashMap;

public class YouTubeDownloader &#123;
    private ThirdPartyYouTubeLib api; //利用接口

    public YouTubeDownloader(ThirdPartyYouTubeLib api) &#123;
        this.api = api;
    &#125;

    public void renderVideoPage(String videoId) &#123;
        Video video = api.getVideo(videoId);
        System.out.println(&quot;\n-------------------------------&quot;);
        System.out.println(&quot;Video page (imagine fancy HTML)&quot;);
        System.out.println(&quot;ID: &quot; + video.id);
        System.out.println(&quot;Title: &quot; + video.title);
        System.out.println(&quot;Video: &quot; + video.data);
        System.out.println(&quot;-------------------------------\n&quot;);
    &#125;

    public void renderPopularVideos() &#123;
        HashMap&lt;String, Video&gt; list = api.popularVideo();
        System.out.println(&quot;\n-------------------------------&quot;);
        System.out.println(&quot;Most popular videos on YouTube (imagine fancy HTML)&quot;);
        for (Video video : list.values()) &#123;
            System.out.println(&quot;ID: &quot; + video.id + &quot; / Title: &quot; + video.title);
        &#125;
        System.out.println(&quot;-------------------------------\n&quot;);
    &#125;
&#125;
</code></pre>
<p>6.测试代码，比较直接用远程服务和利用代理处理相同请求内容所需的时间</p>
<pre><code class="java">public class Demo &#123;

    public static void main(String[] args) &#123;
        YouTubeDownloader naiveDownloader = new YouTubeDownloader(new ThirdPartyYouTubeClass());
        YouTubeDownloader smartDownloader = new YouTubeDownloader(new YouTubeCacheProxy());

        long naive = test(naiveDownloader);
        long smart = test(smartDownloader);
        System.out.print(&quot;\nTime saved by caching proxy: &quot; + (naive - smart) + &quot;ms&quot;);

    &#125;

    private static long test(YouTubeDownloader downloader) &#123;
        long startTime = System.currentTimeMillis();

        // User behavior in our app:
        downloader.renderPopularVideos();
        downloader.renderVideoPage(&quot;catzzzzzzzzz&quot;);
        downloader.renderPopularVideos();
        downloader.renderVideoPage(&quot;dancesvideoo&quot;);
        // Users might visit the same page quite often.
        downloader.renderVideoPage(&quot;catzzzzzzzzz&quot;);
        downloader.renderVideoPage(&quot;someothervid&quot;);

        long estimatedTime = System.currentTimeMillis() - startTime;
        System.out.print(&quot;Time elapsed: &quot; + estimatedTime + &quot;ms\n&quot;);
        return estimatedTime;
    &#125;
&#125;
</code></pre>
<p>7.输出结果，可以看到节省了 3479ms</p>
<pre><code>Connecting to http://www.youtube.com... Connected!
Downloading populars... Done!

-------------------------------
Most popular videos on YouTube (imagine fancy HTML)
ID: sadgahasgdas / Title: Catzzzz.avi
ID: asdfas3ffasd / Title: Dancing video.mpq
ID: 3sdfgsd1j333 / Title: Programing lesson#1.avi
ID: mkafksangasj / Title: Dog play with ball.mp4
ID: dlsdk5jfslaf / Title: Barcelona vs RealM.mov
-------------------------------

Connecting to http://www.youtube.com/catzzzzzzzzz... Connected!
Downloading video... Done!

-------------------------------
Video page (imagine fancy HTML)
ID: catzzzzzzzzz
Title: Some video title
Video: Random video.
-------------------------------

Connecting to http://www.youtube.com... Connected!
Downloading populars... Done!

-------------------------------
Most popular videos on YouTube (imagine fancy HTML)
ID: sadgahasgdas / Title: Catzzzz.avi
ID: asdfas3ffasd / Title: Dancing video.mpq
ID: 3sdfgsd1j333 / Title: Programing lesson#1.avi
ID: mkafksangasj / Title: Dog play with ball.mp4
ID: dlsdk5jfslaf / Title: Barcelona vs RealM.mov
-------------------------------

Connecting to http://www.youtube.com/dancesvideoo... Connected!
Downloading video... Done!

-------------------------------
Video page (imagine fancy HTML)
ID: dancesvideoo
Title: Some video title
Video: Random video.
-------------------------------

Connecting to http://www.youtube.com/catzzzzzzzzz... Connected!
Downloading video... Done!

-------------------------------
Video page (imagine fancy HTML)
ID: catzzzzzzzzz
Title: Some video title
Video: Random video.
-------------------------------

Connecting to http://www.youtube.com/someothervid... Connected!
Downloading video... Done!

-------------------------------
Video page (imagine fancy HTML)
ID: someothervid
Title: Some video title
Video: Random video.
-------------------------------

Time elapsed: 9354ms
Connecting to http://www.youtube.com... Connected!
Downloading populars... Done!

-------------------------------
Most popular videos on YouTube (imagine fancy HTML)
ID: sadgahasgdas / Title: Catzzzz.avi
ID: asdfas3ffasd / Title: Dancing video.mpq
ID: 3sdfgsd1j333 / Title: Programing lesson#1.avi
ID: mkafksangasj / Title: Dog play with ball.mp4
ID: dlsdk5jfslaf / Title: Barcelona vs RealM.mov
-------------------------------

Connecting to http://www.youtube.com/catzzzzzzzzz... Connected!
Downloading video... Done!

-------------------------------
Video page (imagine fancy HTML)
ID: catzzzzzzzzz
Title: Some video title
Video: Random video.
-------------------------------

Retrieved list from cache.

-------------------------------
Most popular videos on YouTube (imagine fancy HTML)
ID: sadgahasgdas / Title: Catzzzz.avi
ID: asdfas3ffasd / Title: Dancing video.mpq
ID: 3sdfgsd1j333 / Title: Programing lesson#1.avi
ID: mkafksangasj / Title: Dog play with ball.mp4
ID: dlsdk5jfslaf / Title: Barcelona vs RealM.mov
-------------------------------

Connecting to http://www.youtube.com/dancesvideoo... Connected!
Downloading video... Done!

-------------------------------
Video page (imagine fancy HTML)
ID: dancesvideoo
Title: Some video title
Video: Random video.
-------------------------------

Retrieved video &#39;catzzzzzzzzz&#39; from cache.

-------------------------------
Video page (imagine fancy HTML)
ID: catzzzzzzzzz
Title: Some video title
Video: Random video.
-------------------------------

Connecting to http://www.youtube.com/someothervid... Connected!
Downloading video... Done!

-------------------------------
Video page (imagine fancy HTML)
ID: someothervid
Title: Some video title
Video: Random video.
-------------------------------

Time elapsed: 5875ms

Time saved by caching proxy: 3479ms
</code></pre>
<h3 id="模式结构-10"><a href="#模式结构-10" class="headerlink" title="模式结构"></a>模式结构</h3><ul>
<li><strong>服务接口</strong>：声明了服务接口。 代理必须遵循该接口才能伪装成服务对象。</li>
<li><strong>服务类</strong>：提供了一些实用的业务逻辑。</li>
<li><strong>代理类</strong>：包含一个指向服务对象的引用成员变量。 代理完成其任务 （例如延迟初始化、 记录日志、 访问控制和缓存等） 后会将请求传递给服务对象。 通常情况下， 代理会对其服务对象的整个生命周期进行管理。</li>
<li><strong>客户端</strong>：能通过同一接口与服务或代理进行交互， 所以你可在一切需要服务对象的代码中使用代理。</li>
</ul>
<h3 id="优点-11"><a href="#优点-11" class="headerlink" title="优点"></a>优点</h3><ul>
<li>开闭原则。 你可以在不对服务或客户端做出修改的情况下创建新代理。</li>
<li>即使服务对象还未准备好或不存在， 代理也可以正常工作。</li>
<li>可以在客户端毫无察觉的情况下控制服务对象。</li>
</ul>
<h3 id="缺点-11"><a href="#缺点-11" class="headerlink" title="缺点"></a>缺点</h3><ul>
<li>由于在客户端和真实主题之间增加了代理对象，因此有些类型的代理模式可能会造成请求的处理速度变慢。</li>
<li>实现代理模式需要额外的工作，有些代理模式的实现非常复杂。</li>
</ul>
<h1 id="行为模式"><a href="#行为模式" class="headerlink" title="行为模式"></a>行为模式</h1><h2 id="责任链模式（Chain-of-Responsibility）"><a href="#责任链模式（Chain-of-Responsibility）" class="headerlink" title="责任链模式（Chain of Responsibility）"></a>责任链模式（Chain of Responsibility）</h2><h3 id="意图-12"><a href="#意图-12" class="headerlink" title="意图"></a>意图</h3><p>允许将请求沿着处理者链进行发送。 收到请求后， 每个处理者均可对请求进行处理， 或将其传递给链上的下个处理者。责任链会将特定行为转换为被称作<em>处理者</em>的独立对象。</p>
<h3 id="使用场景-12"><a href="#使用场景-12" class="headerlink" title="使用场景"></a>使用场景</h3><ul>
<li>必须按顺序执行多个处理者</li>
<li>程序需要使用不同方式处理不同种类请求，且请求类型和顺序预先未知</li>
<li>处理者与其顺序必须在运行时进行改变</li>
</ul>
<h3 id="示例问题-12"><a href="#示例问题-12" class="headerlink" title="示例问题"></a>示例问题</h3><p>用户数据的请求如何依次通过处理者链来执行各种不同的行为 （例如认证、 授权与验证）。</p>
<p>1.创建基础验证接口</p>
<pre><code class="java">public abstract class Middleware &#123;
    private Middleware next;

    //连接责任链
    public Middleware linkWith(Middleware next) &#123;
        this.next = next;
        return next;
    &#125;

    public abstract boolean check(String email, String password);
    
    //下一轮的处理
    protected boolean checkNext(String email, String password) &#123;
        if(next == null) return true;
        return next.check(email, password);
    &#125;
&#125;
</code></pre>
<p>2.创建 <code>ThrottlingMiddleware</code> 类检查请求数量限制</p>
<pre><code class="java">public class ThrottlingMiddleware extends Middleware &#123;
    private int requestPerMinute;
    private int request;
    private long currentTime;

    public ThrottlingMiddleware(int requestPerMinute) &#123;
        this.requestPerMinute = requestPerMinute;
        this.currentTime = System.currentTimeMillis();
    &#125;

    public boolean check(String email, String password) &#123;
        if(System.currentTimeMillis() &gt; currentTime + 60_000) &#123;
            request = 0;
            currentTime = System.currentTimeMillis();
        &#125;

        request++;

        if(request &gt; requestPerMinute) &#123;
            System.out.println(&quot;Request limit exceede!&quot;);
            Thread.currentThread().stop();
        &#125;
        return checkNext(email, password);
    &#125;
&#125;
</code></pre>
<p>3.创建 <code>UserExistsMiddleware</code> 类检查用户登录信息</p>
<pre><code class="java">public class UserExistsMiddleware extends Middleware &#123;
    private Server server;

    public UserExistsMiddleware(Server server) &#123;
        this.server = server;
    &#125;

    public boolean check(String email, String password) &#123;
        if(!server.hasEmail(email)) &#123;
            System.out.println(&quot;This email is not registered!&quot;);
            return false;
        &#125;
        if(!server.isValidPassword(email, password)) &#123;
            System.out.println(&quot;Wrong password!&quot;);
            return false;
        &#125;
        return checkNext(email, password);
    &#125;
&#125;
</code></pre>
<p>4.创建 <code>RoleCheckMiddleware</code> 类检查用户角色</p>
<pre><code class="java">public class RoleCheckMiddleware extends Middleware &#123;
    public boolean check(String email, String password) &#123;
        if (email.equals(&quot;admin@example.com&quot;)) &#123;
            System.out.println(&quot;Hello, admin!&quot;);
            return true;
        &#125;
        System.out.println(&quot;Hello, user!&quot;);
        return checkNext(email, password);
    &#125;
&#125;
</code></pre>
<p>5.创建 <code>Server</code> 类，存储用户名和密码</p>
<pre><code class="java">import java.util.HashMap;
import java.util.Map;

public class Server &#123;
    private Map&lt;String, String&gt; users = new HashMap&lt;&gt;();
    private Middleware middleware;

    public void setMiddleware(Middleware middleware) &#123;
        this.middleware = middleware;
    &#125;

    public boolean logIn(String email, String password) &#123;
        if(middleware.check(email, password)) &#123;
            System.out.println(&quot;Authorization have been successful!&quot;);
            return true;
        &#125;
        return false;
    &#125;

    public void register(String email, String password) &#123;
        users.put(email, password);
    &#125;

    public boolean hasEmail(String email) &#123;
        return users.containsKey(email);
    &#125;

    public boolean isValidPassword(String email, String password) &#123;
        return users.get(email).equals(password);
    &#125;
&#125;
</code></pre>
<p>6.创建测试代码</p>
<pre><code class="java">import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class Demo &#123;
    private static BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
    private static Server server;

    private static void init() &#123;
        server = new Server();
        server.register(&quot;admin@example.com&quot;, &quot;admin_pass&quot;);
        server.register(&quot;user@example.com&quot;, &quot;user_pass&quot;);
        Middleware middleware = new ThrottlingMiddleware(2);
        //设置责任链
        middleware.linkWith(new UserExistsMiddleware(server))
                .linkWith(new RoleCheckMiddleware());
        server.setMiddleware(middleware);
    &#125;

    public static void main(String[] args) throws IOException &#123;
        init();

        boolean success;
        do &#123;
            System.out.println(&quot;Enter email: &quot;);
            String email = reader.readLine();
            System.out.println(&quot;Input password: &quot;);
            String password = reader.readLine();
            success = server.logIn(email, password);
        &#125; while (!success);
    &#125;
&#125;
</code></pre>
<p>7.测试结果</p>
<pre><code>Enter email: admin@example.com
Input password: admin_pass
Hello, admin!
Authorization have been successful!


Enter email: user@example.com
Input password: user_pass
Hello, user!
Authorization have been successful!
</code></pre>
<h3 id="模式结构-11"><a href="#模式结构-11" class="headerlink" title="模式结构"></a>模式结构</h3><ul>
<li><strong>处理者</strong>：声明了所有具体处理者的通用接口。该接口通常仅包含单个方法用于请求处理， 但有时其还会包含一个设置链上下个处理者的方法。</li>
<li><strong>基础处理者</strong>：可选类，可以将所有处理者公用的样本代码放置在其中。</li>
<li><strong>具体处理者</strong>：包含处理请求的实际代码。 每个处理者接收到请求后， 都必须决定是否进行处理， 以及是否沿着链传递请求。</li>
<li><strong>客户端</strong>：可根据程序逻辑一次性或者动态地生成链。 值得注意的是， 请求可发送给链上的任意一个处理者， 而非必须是第一个处理者。</li>
</ul>
<h3 id="优点-12"><a href="#优点-12" class="headerlink" title="优点"></a>优点</h3><ul>
<li>可以控制请求处理的顺序</li>
<li>单一职责原则，可以对发起操作和执行操作的类进行解耦</li>
<li>开闭原则，可以在不改现有代码的情况下在程序中新增处理者</li>
</ul>
<h3 id="缺点-12"><a href="#缺点-12" class="headerlink" title="缺点"></a>缺点</h3><ul>
<li>不能保证请求一定被接收，部分请求可能未被处理</li>
<li>系统性能将受到一定影响，而且在进行代码调试时不太方便，可能会造成循环调用</li>
</ul>
<h2 id="命令模式（Command）"><a href="#命令模式（Command）" class="headerlink" title="命令模式（Command）"></a>命令模式（Command）</h2><h3 id="意图-13"><a href="#意图-13" class="headerlink" title="意图"></a>意图</h3><p>请求以命令的形式包裹在对象中，并传给调用对象。调用对象寻找可以处理该命令的合适的对象，并把该命令传给相应的对象，该对象执行命令。</p>
<h3 id="使用场景-13"><a href="#使用场景-13" class="headerlink" title="使用场景"></a>使用场景</h3><p>认为是命令的地方都可以用命令模式</p>
<h3 id="示例问题-13"><a href="#示例问题-13" class="headerlink" title="示例问题"></a>示例问题</h3><p>开发一款文字编辑器时，要创建一个包含多个具有不同功能的按钮的窗口。</p>
<p>已经有一个<code>Button</code>类，最简单的做法是在使用按钮的每个地方都创建大量的子类。 这些子类中包含按钮点击后必须执行的代码。但是这样就创建了大量的子类， 当每次修改基类 <code>Button</code>时， 都有可能需要修改所有子类的代码。另外不同的按钮中又会有一些重合的功能部分，这样每次都需要把相同的代码复制到许多的类当中。</p>
<p>命令模式建议 GUI 对象不直接提交这些请求。 而是将请求的所有细节 （例如调用的对象、 方法名称和参数列表） 抽取出来组成命令类， 该类中仅包含一个用于触发请求的方法，然后让所有命令实现相同的<code>Command</code>接口/抽象类。这样，命令成为了减少 GUI 和业务逻辑层之间耦合的中间层。 </p>
<p>1.创建<code>Command</code>抽象命令类</p>
<pre><code class="java">public abstract class Command &#123;
    public Editor editor;
    private String backup;//用于存储当前编辑器框里的文字

    Command(Editor editor) &#123;
        this.editor = editor;
    &#125;

    void backup() &#123;
        backup = editor.textField.getText();
    &#125;

    public void undo() &#123;
        editor.textField.setText(backup);
    &#125;

    public abstract boolean execute();

&#125;
</code></pre>
<p>2.创建各种命令类继承<code>Command</code></p>
<pre><code class="java">//将所选文字复制到剪贴板
public class CopyCommand extends Command &#123;
    public CopyCommand(Editor editor) &#123;
        super(editor);
    &#125;

    @Override
    public boolean execute() &#123;
        editor.clipboard = editor.textField.getSelectedText();
        //返回值设为false，是为了后序控制复制这一步操作无法撤销
        return false;
    &#125;
&#125;
</code></pre>
<pre><code class="java">//从剪贴板粘贴文字
public class PasteCommand extends Command &#123;
    public PasteCommand(Editor editor) &#123;
        super(editor);
    &#125;

    @Override
    public boolean execute() &#123;
        if (editor.clipboard == null || editor.clipboard.isEmpty()) return false;

        backup();
        editor.textField.insert(editor.clipboard, editor.textField.getCaretPosition());
        return true;
    &#125;
&#125;
</code></pre>
<pre><code class="java">//将文字剪切到剪切板
public class CutCommand extends Command &#123;

    public CutCommand(Editor editor) &#123;
        super(editor);
    &#125;

    @Override
    public boolean execute() &#123;
        if (editor.textField.getSelectedText().isEmpty()) return false;

        backup();
        String source = editor.textField.getText();
        editor.clipboard = editor.textField.getSelectedText();
        editor.textField.setText(cutString(source));
        return true;
    &#125;

    private String cutString(String source) &#123;
        String start = source.substring(0, editor.textField.getSelectionStart());
        String end = source.substring(editor.textField.getSelectionEnd());
        return start + end;
    &#125;
&#125;
</code></pre>
<p>3.创建命令历史类，用一个栈存放之前的所有命令对象</p>
<pre><code class="java">public class CommandHistory &#123;
    private Stack&lt;Command&gt; history = new Stack&lt;&gt;();

    public void push(Command c) &#123;
        history.push(c);
    &#125;

    public Command pop() &#123;
        return history.pop();
    &#125;

    public boolean isEmpty() &#123; return history.isEmpty(); &#125;
&#125;
</code></pre>
<p>4.创建编辑器类</p>
<pre><code class="java">import javax.swing.*;
import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

public class Editor &#123;
    public JTextArea textField;
    public String clipboard;
    private CommandHistory history = new CommandHistory();

    public void init() &#123;
        JFrame frame = new JFrame(&quot;Text editor (type &amp; use buttons, Baby!)&quot;);
        JPanel content = new JPanel();
        frame.setContentPane(content);
        frame.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);
        content.setLayout(new BoxLayout(content, BoxLayout.Y_AXIS));
        textField = new JTextArea();
        textField.setLineWrap(true);
        content.add(textField);
        JPanel buttons = new JPanel(new FlowLayout(FlowLayout.CENTER));
        JButton ctrlC = new JButton(&quot;Ctrl+C&quot;);
        JButton ctrlX = new JButton(&quot;Ctrl+X&quot;);
        JButton ctrlV = new JButton(&quot;Ctrl+V&quot;);
        JButton ctrlZ = new JButton(&quot;Ctrl+Z&quot;);
        Editor editor = this;
        ctrlC.addActionListener(new ActionListener() &#123;
            @Override
            public void actionPerformed(ActionEvent e) &#123;
                executeCommand(new CopyCommand(editor));
            &#125;
        &#125;);
        ctrlX.addActionListener(new ActionListener() &#123;
            @Override
            public void actionPerformed(ActionEvent e) &#123;
                executeCommand(new CutCommand(editor));
            &#125;
        &#125;);
        ctrlV.addActionListener(new ActionListener() &#123;
            @Override
            public void actionPerformed(ActionEvent e) &#123;
                executeCommand(new PasteCommand(editor));
            &#125;
        &#125;);
        ctrlZ.addActionListener(new ActionListener() &#123;
            @Override
            public void actionPerformed(ActionEvent e) &#123;
                undo();
            &#125;
        &#125;);
        buttons.add(ctrlC);
        buttons.add(ctrlX);
        buttons.add(ctrlV);
        buttons.add(ctrlZ);
        content.add(buttons);
        frame.setSize(450, 200);
        frame.setLocationRelativeTo(null);
        frame.setVisible(true);
    &#125;

    private void executeCommand(Command command) &#123;
        if (command.execute()) &#123;
            history.push(command);
        &#125;
    &#125;

    private void undo() &#123;
        if (history.isEmpty()) return;

        Command command = history.pop();
        if (command != null) &#123;
            //重新设置编辑器框内的文字
            command.undo();
        &#125;
    &#125;
&#125;
</code></pre>
<p>5.编写测试代码</p>
<pre><code class="java">public class Demo &#123;
    public static void main(String[] args) &#123;
        Editor editor = new Editor();
        editor.init();
    &#125;
&#125;
</code></pre>
<p>6.测试结果</p>
<p><img src="https://refactoringguru.cn/images/patterns/examples/java/command/OutputDemo.png"></p>
<h3 id="模式结构-12"><a href="#模式结构-12" class="headerlink" title="模式结构"></a>模式结构</h3><ul>
<li><strong>触发者</strong>：负责对请求进行初始化， 其中必须包含一个成员变量来存储对于命令对象的引用。不负责创建命令对象： 它通常会通过构造函数从客户端处获得预先生成的命令。</li>
<li><strong>命令接口</strong>：通常仅声明一个执行命令的方法。</li>
<li><strong>具体命令类</strong>：实现命令接口，实现各种类型的请求。</li>
<li><strong>接收者</strong>：包含部分业务逻辑。 几乎任何对象都可以作为接收者。 绝大部分命令只处理如何将请求传递到接收者的细节， 接收者自己会完成实际的工作。</li>
<li><strong>客户端</strong>：创建并配置接收者、具体的命令对象、发送者并将其与特地命令关联。</li>
</ul>
<h3 id="优点-13"><a href="#优点-13" class="headerlink" title="优点"></a>优点</h3><ul>
<li>单一职责原则。 可以解耦触发和执行操作的类。</li>
<li>开闭原则。可以在不修改已有客户端代码的情况下在程序中创建新的命令。</li>
<li>可以实现撤销和恢复功能，以及操作的延迟执行。</li>
<li>可以将一组简单命令组合成一个复杂命令。</li>
</ul>
<h3 id="缺点-13"><a href="#缺点-13" class="headerlink" title="缺点"></a>缺点</h3><ul>
<li>代码可能会变得更加复杂， 因为在发送者和接收者之间增加了一个全新的层次。</li>
</ul>
<h2 id="迭代器模式（Iterator）"><a href="#迭代器模式（Iterator）" class="headerlink" title="迭代器模式（Iterator）"></a>迭代器模式（Iterator）</h2><h3 id="意图-14"><a href="#意图-14" class="headerlink" title="意图"></a>意图</h3><p>在不暴露集合底层表现形式 （列表、 栈和树等） 的情况下遍历集合中所有的元素。</p>
<h3 id="使用场景-14"><a href="#使用场景-14" class="headerlink" title="使用场景"></a>使用场景</h3><ul>
<li>访问一个聚合对象的内容而无须暴露它的内部表示。</li>
<li>需要为聚合对象提供多种遍历方式。</li>
<li>为遍历不同的聚合结构提供一个统一的接口。</li>
</ul>
<h3 id="示例问题-14"><a href="#示例问题-14" class="headerlink" title="示例问题"></a>示例问题</h3><p>不同的集合会使用不同的数据结构进行存储数据，每种集合都需要提供遍历所有元素的方式。</p>
<p>1.创建迭代器接口，提供基本的<code>hasNext</code>方法和<code>next</code>方法。</p>
<pre><code class="java">public interface Iterator &#123;
    public boolean hasNext();
    public Object next();
&#125;
</code></pre>
<p>2.创建集合接口，提供获取迭代器的方法</p>
<pre><code class="java">public interface Container &#123;
    public Iterator getIterator();
&#125;
</code></pre>
<p>3.创建具体的集合类，采用了不同的存储结构</p>
<pre><code class="java">public class NameRepository implements Container &#123;
    public String[] names = &#123;&quot;Bob&quot;, &quot;Mary&quot;, &quot;Daniel&quot;&#125;;

    @Override
    public Iterator getIterator() &#123;
        return new NameIterator(names);
    &#125;
&#125;
</code></pre>
<pre><code class="java">import java.util.ArrayList;
import java.util.List;

public class EmailRepository implements Container &#123;
    private List&lt;String&gt; emails;

    public EmailRepository() &#123;
        emails = new ArrayList&lt;&gt;();
    &#125;

    public void add(String email) &#123;
        emails.add(email);
    &#125;

    @Override
    public Iterator getIterator() &#123;
        return new EmailIterator(emails);
    &#125;
&#125;
</code></pre>
<p>4.创建具体的迭代器</p>
<pre><code class="java">public class NameIterator implements Iterator &#123;
    private int index = 0;
    private String[] names;

    public NameIterator(String[] names) &#123;
        this.names = names;
    &#125;

    @Override
    public boolean hasNext() &#123;
        return index &lt; names.length;
    &#125;

    @Override
    public Object next() &#123;
        if(hasNext()) &#123;
            return names[index++];
        &#125;
        return null;
    &#125;
&#125;
</code></pre>
<pre><code class="java">import java.util.List;

public class EmailIterator implements Iterator &#123;
    int index = 0;
    List&lt;String&gt; emails;

    public EmailIterator(List&lt;String&gt; emails) &#123;
        this.emails = emails;
    &#125;

    @Override
    public boolean hasNext() &#123;
        return index &lt; emails.size();
    &#125;

    @Override
    public Object next() &#123;
        if(hasNext()) &#123;
            return emails.get(index++);
        &#125;
        return null;
    &#125;
&#125;
</code></pre>
<p>5.编写测试代码</p>
<pre><code class="java">public class Demo &#123;
    public static void main(String[] args) &#123;
        NameRepository nameRepository = new NameRepository();
        for(Iterator iter = nameRepository.getIterator(); iter.hasNext();) &#123;
            String name = (String)iter.next();
            System.out.println(&quot;Name : &quot; + name);
        &#125;

        EmailRepository emailRepository = new EmailRepository();
        emailRepository.add(&quot;111@163.com&quot;);
        emailRepository.add(&quot;222@163.com&quot;);
        for(Iterator iter = emailRepository.getIterator(); iter.hasNext();) &#123;
            System.out.println(&quot;Email : &quot; + iter.next());
        &#125;
    &#125;
&#125;
</code></pre>
<h3 id="模式结构-13"><a href="#模式结构-13" class="headerlink" title="模式结构"></a>模式结构</h3><ul>
<li><strong>迭代器</strong> ：接口声明了遍历集合所需的操作： 获取下一个元素、 获取当前位置和重新开始迭代等。</li>
<li><strong>具体迭代器</strong> ：实现遍历集合的一种特定算法。 迭代器对象必须跟踪自身遍历的进度。 这使得多个迭代器可以相互独立地遍历同一集合。</li>
<li><strong>集合</strong> ：接口声明一个或多个方法来获取与集合兼容的迭代器。  返回方法的类型必须被声明为迭代器接口， 因此具体集合可以返回各种不同种类的迭代器。</li>
<li><strong>具体集合</strong> ：会在客户端请求迭代器时返回一个特定的具体迭代器类实体。</li>
</ul>
<h3 id="优点-14"><a href="#优点-14" class="headerlink" title="优点"></a>优点</h3><ul>
<li>单一职责原则。</li>
<li>开闭原则。</li>
<li>可以并行遍历同一集合， 因为每个迭代器对象都包含其自身的遍历状态。</li>
</ul>
<h3 id="缺点-14"><a href="#缺点-14" class="headerlink" title="缺点"></a>缺点</h3><ul>
<li>对于某些特殊集合， 使用迭代器可能比直接遍历的效率低。</li>
<li>如果程序只与简单的集合进行交互， 应用该模式可能会矫枉过正。</li>
</ul>
<h2 id="中介者模式（Mediator）"><a href="#中介者模式（Mediator）" class="headerlink" title="中介者模式（Mediator）"></a>中介者模式（Mediator）</h2><h3 id="意图-15"><a href="#意图-15" class="headerlink" title="意图"></a>意图</h3><p>用一个中介对象来封装一系列的对象交互，中介者使各对象<strong>不需要显式地</strong>相互引用，从而使其耦合松散，而且可以独立地改变它们之间的交互。</p>
<p>该模式会限制对象之间的直接交互， 迫使它们通过一个中介者对象进行合作。中介者就是一个黑箱。</p>
<p>在 MVC 模式中， 控制器是中介者的同义词。</p>
<h3 id="使用场景-15"><a href="#使用场景-15" class="headerlink" title="使用场景"></a>使用场景</h3><ul>
<li>帮助程序 GUI 组件之间的通信</li>
</ul>
<h3 id="示例问题-15"><a href="#示例问题-15" class="headerlink" title="示例问题"></a>示例问题</h3><p>有一个创建和修改客户资料的对话框， 它由各种控件组成， 例如文本框 （Text­Field）、 显示所有客户的列表 （List） 和按钮 （Button） 等。表单元素之间可能会直接进行互动，如果直接在表单元素代码中实现业务逻辑， 会很难在程序其他表单中复用这些元素类。</p>
<p>创建一个中介者类 <code>Mediator</code>，所有控件通过一个 中介者对象 成员变量重定向调用行为， 以间接的方式进行合作。绝大部分重要的修改都在实际表单元素中进行。</p>
<h3 id="模式结构-14"><a href="#模式结构-14" class="headerlink" title="模式结构"></a>模式结构</h3><ul>
<li><strong>组件接口</strong>：声明了获取操作方法名和设置中介者的方法</li>
<li><strong>具体组件</strong>：每个组件都有一个指向中介者的引用， 该引用被声明为中介者接口类型。 组件不知道中介者实际所属的类， 因此你可通过将其连接到不同的中介者以使其能在其他程序中复用。</li>
<li><strong>中介者接口</strong>：声明了与组件交流的方法， 但通常仅包括一个通知方法。 组件可将任意上下文 （包括自己的对象） 作为该方法的参数， 只有这样接收组件和发送者类之间才不会耦合。</li>
<li><strong>具体中介者</strong>：封装了多种组件间的关系。 具体中介者通常会保存所有组件的引用并对其进行管理， 甚至有时会对其生命周期进行管理。</li>
</ul>
<h3 id="优点-15"><a href="#优点-15" class="headerlink" title="优点"></a>优点</h3><ul>
<li>单一职责原则。可以将多个组件间的交流抽取到同一位置， 使其更易于理解和维护。</li>
<li>开闭原则。无需修改实际组件就能增加新的中介者。</li>
<li>可以减轻应用中多个组件间的耦合情况。</li>
<li>可以更方便地复用各个组件。</li>
</ul>
<h3 id="缺点-15"><a href="#缺点-15" class="headerlink" title="缺点"></a>缺点</h3><ul>
<li>中介者很可能会演变成为上帝对象。</li>
</ul>
<h2 id="备忘录模式（Memento）"><a href="#备忘录模式（Memento）" class="headerlink" title="备忘录模式（Memento）"></a>备忘录模式（Memento）</h2><h3 id="意图-16"><a href="#意图-16" class="headerlink" title="意图"></a>意图</h3><p>允许在不暴露对象实现细节的情况下保存和恢复对象之前的状态。</p>
<h3 id="使用场景-16"><a href="#使用场景-16" class="headerlink" title="使用场景"></a>使用场景</h3><ul>
<li>需要保存/恢复数据的相关状态场景</li>
<li>需要提供可回滚操作</li>
</ul>
<h3 id="示例问题-16"><a href="#示例问题-16" class="headerlink" title="示例问题"></a>示例问题</h3><p>需要开发一款编辑器，任何修改都支持撤销和重做功能。</p>
<p>如果采用直接的方式，让程序每做一次操作都记录下所有的当前对象状态，会遇到一个问题。会需要遍历对象的所有成员变量并将其数值复制保存。 但只有当对象对其内容没有严格访问权限限制的情况下，才能使用该方式。 但是大部分情况下许多对象都是私有成员变量的。另外，生成快照后，未来可能会添加或删除一些成员变量，那么控制复制生成快照的类也需要进行修改。</p>
<p>这些问题都是封装“破损”造成的。采用备忘录模式，将创建快照的工作安排给实际状态的拥有者类，这样其他对象就不需要从外部复制编辑器状态。编辑器类拥有其状态的完全访问权， 因此可以自行生成快照。将对象状态的副本存储在一个名为<em>备忘录</em> （Memento） 的特殊对象中。 除了创建备忘录的对象外， 任何对象都不能访问备忘录的内容。其他对象必须使用受限接口与备忘录进行交互， 它们可以获取快照的元数据 （创建时间和操作名称等）， 但不能获取快照中原始对象的状态。</p>
<p>refactoryguru上的例子实在是太复杂了，用了菜鸟教程上的理解一下即可。</p>
<p>1.创建备忘录</p>
<pre><code class="java">public class Memento &#123;
    private Originator originator;

    public Memento(Originator originator) &#123;
        this.originator = originator;
    &#125;

    public String getState() &#123;
        return originator.getState();
    &#125;
&#125;
</code></pre>
<p>2.创建 <code>Originator</code> 类</p>
<pre><code class="java">public class Originator &#123;
    private String state;

    public Originator(String state) &#123;
        this.state = state;
        System.out.println(&quot;Current state : &quot; + state);
    &#125;

    public void setState(String state) &#123;
        this.state = state;
        System.out.println(&quot;Current state : &quot; + state);
    &#125;

    public String getState() &#123;
        return state;
    &#125;

    public Memento saveStateToMemento() &#123;
        return new Memento(this);
    &#125;

&#125;
</code></pre>
<p>3.创建 <code>CareTaker</code> 类</p>
<pre><code class="java">import java.util.ArrayList;
import java.util.List;

public class CareTaker &#123;
    private List&lt;Memento&gt; mementoList = new ArrayList&lt;&gt;();
    private int virtualSize = 0;

    public void setOriginator(String state) &#123;
        Originator originator = new Originator(state);
        add(originator.saveStateToMemento());
    &#125;

    public void add(Memento memento) &#123;
        if(virtualSize != mementoList.size() &amp;&amp; virtualSize &gt; 0) &#123;
            mementoList = mementoList.subList(0, virtualSize);
        &#125;
        mementoList.add(memento);
        virtualSize = mementoList.size();
    &#125;

    public void undo() &#123;
        if(virtualSize &lt;= 1) &#123;
            System.out.println(&quot;No operations&quot;);
        &#125; else &#123;
            virtualSize--;
            Memento memento = get(virtualSize - 1);
            System.out.println(&quot;Undoing : &quot; + memento.getState());
        &#125;
    &#125;

    public void redo() &#123;
        if(virtualSize == mementoList.size()) &#123;
            System.out.println(&quot;No operations&quot;);
        &#125; else &#123;
            virtualSize++;
            Memento memento = get(virtualSize - 1);
            System.out.println(&quot;Redoing : &quot; + memento.getState());
        &#125;
    &#125;

    public Memento get(int index) &#123;
        return mementoList.get(index);
    &#125;
&#125;
</code></pre>
<p>4.编写测试代码</p>
<pre><code class="java">public class Demo &#123;
    public static void main(String[] args) &#123;
        CareTaker careTaker = new CareTaker();
        careTaker.setOriginator(&quot;State 1&quot;);
        careTaker.setOriginator(&quot;State 2&quot;);
        careTaker.setOriginator(&quot;State 3&quot;);
        careTaker.undo();
        careTaker.undo();
        careTaker.redo();
        careTaker.setOriginator(&quot;State 4&quot;);
        careTaker.redo();
        careTaker.undo();
    &#125;
&#125;
</code></pre>
<p>5.测试结果</p>
<pre><code class="java">Current state : State 1
Current state : State 2
Current state : State 3
Undoing : State 2
Undoing : State 1
Redoing : State 2
Current state : State 4
No operations
Undoing : State 2
</code></pre>
<h3 id="模式结构-15"><a href="#模式结构-15" class="headerlink" title="模式结构"></a>模式结构</h3><ul>
<li><strong>原发器</strong>：可以生成自身状态的快照， 也可以在需要时通过快照恢复自身状态。</li>
<li><strong>备忘录</strong>：是原发器状态快照的值对象 （value object）。 通常做法是将备忘录设为不可变的， 并通过构造函数一次性传递数据。</li>
<li><strong>负责人</strong>：通过保存备忘录栈来记录原发器的历史状态。 当原发器需要回溯历史状态时， 负责人将从栈中获取最顶部的备忘录， 并将其传递给原发器的恢复 （restoration） 方法。</li>
</ul>
<h3 id="优点-16"><a href="#优点-16" class="headerlink" title="优点"></a>优点</h3><ul>
<li>可以在不破坏对象封装情况的前提下创建对象状态快照。</li>
<li>可以通过让负责人维护原发器状态历史记录来简化原发器代码。</li>
</ul>
<h3 id="缺点-16"><a href="#缺点-16" class="headerlink" title="缺点"></a>缺点</h3><ul>
<li>如果客户端过于频繁地创建备忘录， 程序将消耗大量内存。</li>
<li>负责人必须完整跟踪原发器的生命周期， 这样才能销毁弃用的备忘录。</li>
<li>绝大部分动态编程语言 （例如 PHP、 Python 和 JavaScript） 不能确保备忘录中的状态不被修改。</li>
</ul>
<h2 id="观察者模式（Observer）"><a href="#观察者模式（Observer）" class="headerlink" title="观察者模式（Observer）"></a>观察者模式（Observer）</h2><h3 id="意图-17"><a href="#意图-17" class="headerlink" title="意图"></a>意图</h3><p>这是一种订阅机制（就像只有订阅报刊的读者才会收到新一期的报刊）。</p>
<p>当一个对象被修改时，则会自动通知依赖它的对象。观察者模式属于行为型模式。</p>
<h3 id="使用场景-17"><a href="#使用场景-17" class="headerlink" title="使用场景"></a>使用场景</h3><ul>
<li>需要在系统中创建一个触发链，A对象的行为将影响B对象，B对象的行为将影响C对象的时候。</li>
<li>一个对象必须通知其他对象，而并不知道这些对象是谁的时候。</li>
</ul>
<h3 id="示例问题-17"><a href="#示例问题-17" class="headerlink" title="示例问题"></a>示例问题</h3><p>一个文本编辑器 <code>Editor</code> 会对文件进行打开或保存动作，如果进行打开操作，需要将这个动作记录到日志中，如果是保存，那么将以邮件形式通知订阅者。</p>
<p>对于不同的操作类型有着一份订阅者名单，当进行某操作时会通知相应名单上的所有人。</p>
<p>1.创建发布者类，负责订阅和取消订阅以及更新发布的操作</p>
<pre><code class="java">import java.io.File;
import java.util.*;

public class EventManager &#123;
    Map&lt;String, List&lt;EventListener&gt;&gt; listeners = new HashMap&lt;&gt;();

    public EventManager(String... operations) &#123;
        for(String op : operations) &#123;
            this.listeners.put(op, new ArrayList&lt;&gt;());
        &#125;
    &#125;

    public void subscribe(String eventType, EventListener listener) &#123;
        List&lt;EventListener&gt; users = listeners.get(eventType);
        users.add(listener);
    &#125;

    public void unsubscribe(String eventType, EventListener listener) &#123;
        List&lt;EventListener&gt; users = listeners.get(eventType);
        users.remove(listener);
    &#125;

    public void notify(String eventType, File file) &#123;
        List&lt;EventListener&gt; users = listeners.get(eventType);
        for(EventListener listener : users) &#123;
            listener.update(eventType, file);
        &#125;
    &#125;
&#125;
</code></pre>
<p>2.创建编辑器类，包含了打开文件和保存文件操作，通过 <code>EventManager</code> 成员来进行发布消息的工作</p>
<pre><code class="java">import java.io.File;

public class Editor &#123;
    public EventManager events;
    private File file;

    public Editor() &#123;
        this.events = new EventManager(&quot;open&quot;, &quot;save&quot;);
    &#125;

    public void openFile(String filePath) &#123;
        this.file = new File(filePath);
        events.notify(&quot;open&quot;, file);
    &#125;

    public void saveFile() throws Exception &#123;
        if(this.file != null) &#123;
            events.notify(&quot;save&quot;, file);
        &#125; else &#123;
            throw new Exception(&quot;Please open a file first&quot;);
        &#125;
    &#125;
&#125;
</code></pre>
<p>3.创建监听者接口，声明更新操作</p>
<pre><code class="java">import java.io.File;

public interface EventListener &#123;
    void update(String eventType, File file);
&#125;
</code></pre>
<p>4.创建具体的日志监听类和邮件监听类</p>
<pre><code class="java">/**
 *  收到通知后发送邮件
 */

import java.io.File;

public class EmailNotificationListener implements EventListener &#123;

    private String email;

    public EmailNotificationListener(String email) &#123;
        this.email = email;
    &#125;

    @Override
    public void update(String eventType, File file) &#123;
        System.out.println(&quot;Email to&quot;
                + email + &quot;: Someone has performed &quot;
                + eventType + &quot; operation with the following file: &quot; + file.getName());
    &#125;
&#125;
</code></pre>
<pre><code class="java">/**
 * 收到通知后在日志中记录一条消息
 */

import java.io.File;

public class LogOpenListener implements EventListener &#123;
    private File log;

    public LogOpenListener(String fileName) &#123;
        this.log = new File(fileName);
    &#125;

    @Override
    public void update(String eventType, File file) &#123;
        System.out.println(&quot;Save to log &quot;
                + log + &quot;: Someone has performed &quot;
                + eventType + &quot; operation with the following file: &quot; + file.getName());
    &#125;
&#125;
</code></pre>
<p>5.编写测试代码</p>
<pre><code class="java">public class Demo &#123;
    public static void main(String[] args) &#123;
        Editor editor = new Editor();
        editor.events.subscribe(&quot;open&quot;, new LogOpenListener(&quot;file.txt&quot;));
        editor.events.subscribe(&quot;save&quot;, new EmailNotificationListener(&quot;1111@qq.com&quot;));
        editor.events.subscribe(&quot;open&quot;, new EmailNotificationListener(&quot;2222@qq.com&quot;));

        try &#123;
            editor.openFile(&quot;test.txt&quot;);
            editor.saveFile();
        &#125; catch (Exception e) &#123;
            e.printStackTrace();
        &#125;
    &#125;
&#125;
</code></pre>
<p>6.测试结果</p>
<pre><code class="java">Save to log file.txt: Someone has performed open operation with the following file: test.txt
Email to2222@qq.com: Someone has performed open operation with the following file: test.txt
Email to1111@qq.com: Someone has performed save operation with the following file: test.txt
</code></pre>
<h3 id="模式结构-16"><a href="#模式结构-16" class="headerlink" title="模式结构"></a>模式结构</h3><ul>
<li><strong>订阅者接口</strong>：至少声明一个 <code>update</code> 方法</li>
<li><strong>具体的订阅者</strong>：实现通知更新的方法。绝大部分订阅者需要一些与事件相关的上下文数据。 这些数据可作为通知方法的参数来传递；或者是从发布者通过更新方法传递给订阅者的参数中获取所有数据</li>
<li><strong>发布者</strong>：包括添加和删除订阅者，以及通知更新方法</li>
<li><strong>客户端</strong>：分别创建发布者和订阅者对象， 然后为订阅者注册发布者更新</li>
</ul>
<h3 id="优点-17"><a href="#优点-17" class="headerlink" title="优点"></a>优点</h3><ul>
<li>开闭原则。无需修改发布者代码就可以引入新的订阅者类</li>
</ul>
<h3 id="缺点-17"><a href="#缺点-17" class="headerlink" title="缺点"></a>缺点</h3><ul>
<li>订阅者的通知顺序是随机的</li>
<li>如果在观察者和观察目标之间有循环依赖的话，观察目标会触发它们之间进行循环调用，可能导致系统崩溃</li>
</ul>
<h2 id="状态模式（State）"><a href="#状态模式（State）" class="headerlink" title="状态模式（State）"></a>状态模式（State）</h2><h3 id="意图-18"><a href="#意图-18" class="headerlink" title="意图"></a>意图</h3><p>使得类的行为基于它的内部状态而改变。大多应用在有限状态机的情况。</p>
<h3 id="使用场景-18"><a href="#使用场景-18" class="headerlink" title="使用场景"></a>使用场景</h3><ul>
<li>对象需要根据当前自身状态进行补贴的行为，同时状态数量非常多，并且与状态相关的代码会频繁变更。</li>
<li>某个类需要根据成员变量的当前值修改自身行为，要用到大量的条件语句。</li>
</ul>
<h3 id="示例问题-18"><a href="#示例问题-18" class="headerlink" title="示例问题"></a>示例问题</h3><p>一款媒体播放器有许多不同的状态：正在播放、关机不可播放、开机还未播放。这三个状态之间是可以相互转换的，在实现的时候当然可以在播放器类中用选择条件语句 <code>switch</code> 或 <code>if</code> 来实现不同状态之间的切换。但是这样做会导致条件语句非常复杂繁多，当需要修改其转换逻辑时可能会涉及到需要修改所有方法中的状态条件语句，导致代码的维护工作非常困难。</p>
<p>运用状态模式，为对象的所有可能状态新建一个类， 然后将所有状态的对应行为抽取到这些类中。在播放器里保存一个指向表示当前状态对象的引用，并将所有与状态相关的工作委派给这个对象。同时状态对象存储对于播放器对象的反向引用。 状态可以通过该引用从播放器获取所需信息， 并且能触发状态转移。</p>
<p>1.创建通用的状态接口，将播放器对象作为成员变量。</p>
<pre><code class="java">public abstract class State &#123;
    Player player;

    State(Player player) &#123;
        this.player = player;
    &#125;

    public abstract String onLock();
    public abstract String onPlay();
    public abstract String onNext();
    public abstract String onPrevious();
&#125;
</code></pre>
<p>2.创建具体的状态类</p>
<pre><code class="java">public class LockedState extends State &#123;

    public LockedState(Player player) &#123;
        super(player);
        player.setPlaying(false);
    &#125;

    @Override
    public String onLock() &#123;
        if(player.isPlaying()) &#123;
            //实际上不会发生这种情况
            player.changeState(new ReadyState(player));
            return &quot;Stop playing&quot;;
        &#125; else &#123;
            return &quot;Locked...&quot;;
        &#125;
    &#125;

    @Override
    public String onPlay() &#123;
        player.changeState(new ReadyState(player));
        return &quot;Ready&quot;;
    &#125;

    @Override
    public String onNext() &#123;
        return &quot;Locked...&quot;;
    &#125;

    @Override
    public String onPrevious() &#123;
        return &quot;Locked...&quot;;
    &#125;
&#125;
</code></pre>
<pre><code class="java">public class ReadyState extends State &#123;

    public ReadyState(Player player) &#123;
        super(player);
    &#125;

    @Override
    public String onLock() &#123;
        player.changeState(new LockedState(player));
        return &quot;Locked...&quot;;
    &#125;

    @Override
    public String onPlay() &#123;
        String action = player.startPlayback();
        player.changeState(new PlayingState(player));
        return action;
    &#125;

    @Override
    public String onNext() &#123;
        return &quot;Locked...&quot;;
    &#125;

    @Override
    public String onPrevious() &#123;
        return &quot;Locked...&quot;;
    &#125;
&#125;
</code></pre>
<pre><code class="java">public class PlayingState extends State &#123;

    public PlayingState(Player player) &#123;
        super(player);
        player.setPlaying(true);
    &#125;

    @Override
    public String onLock() &#123;
        player.changeState(new LockedState(player));
        player.setCurrentTrackAfterStop();
        return &quot;Stop playing&quot;;
    &#125;

    @Override
    public String onPlay() &#123;
        player.changeState(new ReadyState(player));
        return &quot;Paused...&quot;;
    &#125;

    @Override
    public String onNext() &#123;
        return player.nextTrack();
    &#125;

    @Override
    public String onPrevious() &#123;
        return player.previousTrack();
    &#125;
&#125;
</code></pre>
<p>3.创建播放器类，引用了状态对象，提供改变自身状态的函数。</p>
<pre><code class="java">import java.util.ArrayList;
import java.util.List;

public class Player &#123;
    private State state;
    private boolean playing = false;
    private List&lt;String&gt; playlist = new ArrayList&lt;&gt;();
    private int currentTrack = 0;

    public Player() &#123;
        this.state = new ReadyState(this);
        setPlaying(true);
        for(int i = 1; i &lt;= 12; i++) &#123;
            playlist.add(&quot;Track &quot; + i);
        &#125;
    &#125;

    public void changeState(State state) &#123;
        this.state = state;
    &#125;

    public State getState() &#123;
        return state;
    &#125;

    public void setPlaying(boolean playing) &#123;
        this.playing = playing;
    &#125;

    public boolean isPlaying() &#123;
        return playing;
    &#125;

    public String startPlayback() &#123;
        return &quot;Playing &quot; + playlist.get(currentTrack);
    &#125;

    public String nextTrack() &#123;
        currentTrack++;
        if(currentTrack &gt;= playlist.size()) &#123;
            currentTrack = 0;
        &#125;
        return &quot;Playing &quot; + playlist.get(currentTrack);
    &#125;

    public String previousTrack() &#123;
        currentTrack--;
        if(currentTrack &lt; 0) &#123;
            currentTrack = playlist.size() - 1;
        &#125;
        return &quot;Playing &quot; + playlist.get(currentTrack);
    &#125;

    public void setCurrentTrackAfterStop() &#123;
        this.currentTrack = 0;
    &#125;
&#125;
</code></pre>
<p>4.编写测试代码</p>
<pre><code class="java">public class Demo &#123;
    public static void main(String[] args) &#123;
        Player player = new Player();
        //状态切换以及其他行为动作都委派给状态对象完成
        System.out.println(player.getState().onPlay());
        System.out.println(player.getState().onNext());
        System.out.println(player.getState().onNext());
        System.out.println(player.getState().onPlay());
        System.out.println(player.getState().onLock());
    &#125;
&#125;
</code></pre>
<p>5.输出结果</p>
<pre><code>Playing Track 1
Playing Track 2
Playing Track 3
Paused...
Locked...
</code></pre>
<h3 id="模式结构-17"><a href="#模式结构-17" class="headerlink" title="模式结构"></a>模式结构</h3><ul>
<li><strong>上下文</strong>：保存对具体状态对象的引用，并将所有与状态相关的工作委派给它。上下文通过状态接口与状态对象交互， 且会提供一个 <code>changeState(State stae)</code> 方法用于传递新的状态对象。</li>
<li><strong>状态接口</strong>：会声明特定于状态的方法。 这些方法应能被其他所有具体状态所利用。</li>
<li><strong>具体状态</strong>：状态对象可存储对于上下文对象的反向引用。 状态可以通过该引用从上下文处获取所需信息， 并且能触发状态转移。</li>
</ul>
<h3 id="优点-18"><a href="#优点-18" class="headerlink" title="优点"></a>优点</h3><ul>
<li>单一职责原则，将与特定状态类相关的代码放在单独的类中。</li>
<li>封装了转换机制。</li>
</ul>
<h3 id="缺点-18"><a href="#缺点-18" class="headerlink" title="缺点"></a>缺点</h3><ul>
<li>状态模式的使用必然会增加系统类和对象的个数，结构与实现都较为复杂。</li>
<li>如果状态机只有很少的几个状态， 或者很少发生改变， 那么应用该模式可能会显得小题大作。</li>
</ul>
<h2 id="策略设计模式（Strategy）"><a href="#策略设计模式（Strategy）" class="headerlink" title="策略设计模式（Strategy）"></a>策略设计模式（Strategy）</h2><h3 id="意图-19"><a href="#意图-19" class="headerlink" title="意图"></a>意图</h3><p>一个类的行为或其算法可以在运行时更改。</p>
<p>与状态模式不同的是：在状态模式中， 特定状态知道其他所有状态的存在， 且能触发从一个状态到另一个状态的转换； 策略则几乎完全不知道其他策略的存在，且几个行为或算法的更改并不像状态模式中的状态有必然联系。</p>
<h3 id="使用场景-19"><a href="#使用场景-19" class="headerlink" title="使用场景"></a>使用场景</h3><ul>
<li>如果在一个系统里面有许多类，它们之间的区别仅在于它们的行为</li>
<li>一个系统需要动态地在几种算法中选择一种</li>
</ul>
<h3 id="示例问题-19"><a href="#示例问题-19" class="headerlink" title="示例问题"></a>示例问题</h3><p>需要设计一个计算器，可以提供加、减、乘三种操作，将每一种操作算法单独包装成策略独立类，计算器包含一个成员变量来存储对于策略的引用，计算机自己不执行任务，将工作委派给和自己连接的策略对象。由客户端给计算器传递需要的策略。</p>
<p>1.创建策略接口类</p>
<pre><code class="java">public interface Strategy &#123;
   public int doOperation(int num1, int num2);
&#125;
</code></pre>
<p>2.创建具体策略类</p>
<pre><code class="java">public class OperationAdd implements Strategy &#123;
    @Override
    public int doOperation(int num1, int num2) &#123;
        return num1 + num2;
    &#125;
&#125;
</code></pre>
<pre><code class="java">public class OperationSubtract implements Strategy &#123;
    @Override
    public int doOperation(int num1, int num2) &#123;
        return num1 - num2;
    &#125;
&#125;
</code></pre>
<pre><code class="java">public class OperationMultiply implements Strategy&#123;
    @Override
    public int doOperation(int num1, int num2) &#123;
        return num1 * num2;
    &#125;
&#125;
</code></pre>
<p>3.创建计算器类</p>
<pre><code class="java">public class Computer &#123;
    private Strategy strategy;

    public Computer()&#123;&#125;

    public void setStrategy(Strategy strategy) &#123;
        this.strategy = strategy;
    &#125;

    public int executeStrategy(int num1, int num2, String op) &#123;
        switch (op) &#123;
            case &quot;+&quot; :
                setStrategy(new OperationAdd());
                break;
            case &quot;-&quot; :
                setStrategy(new OperationSubtract());
                break;
            default :
                setStrategy(new OperationMultiply());
        &#125;
        return strategy.doOperation(num1, num2);
    &#125;
&#125;
</code></pre>
<p>4.编写测试代码</p>
<pre><code class="java">public class Demo &#123;
    public static void main(String[] args) &#123;
        Computer comp = new Computer();
        System.out.print(&quot;1 + 2 = &quot;);
        System.out.println(comp.executeStrategy(1, 2, &quot;+&quot;));
        System.out.print(&quot;1 - 2 = &quot;);
        System.out.println(comp.executeStrategy(1, 2, &quot;-&quot;));
    &#125;
&#125;
</code></pre>
<p>5.输出结果</p>
<pre><code class="java">1 + 2 = 3
1 - 2 = -1
</code></pre>
<h3 id="模式结构-18"><a href="#模式结构-18" class="headerlink" title="模式结构"></a>模式结构</h3><ul>
<li><strong>上下文</strong>：维护指向具体策略的引用， 且仅通过策略接口与该对象进行交流。</li>
<li><strong>策略接口</strong>：是所有具体策略的通用接口， 它声明了一个上下文用于执行策略的方法。</li>
<li><strong>具体策略</strong>：实现了上下文所用算法的各种不同变体。</li>
</ul>
<h3 id="优点-19"><a href="#优点-19" class="headerlink" title="优点"></a>优点</h3><ul>
<li>可以在运行时切换对象内的算法。</li>
<li>可以将算法的实现和使用算法的代码隔离开来。</li>
</ul>
<h3 id="缺点-19"><a href="#缺点-19" class="headerlink" title="缺点"></a>缺点</h3><ul>
<li>策略类会增多。</li>
</ul>
<h2 id="模板模式（Template）"><a href="#模板模式（Template）" class="headerlink" title="模板模式（Template）"></a>模板模式（Template）</h2><h3 id="意图-20"><a href="#意图-20" class="headerlink" title="意图"></a>意图</h3><p>定义一个操作中的算法的骨架，而将一些步骤延迟到子类中。</p>
<p>一个抽象类公开定义了执行它的方法的方式/模板。允许子类在不修改结构的情况下重写算法的特定步骤。</p>
<h3 id="使用场景-20"><a href="#使用场景-20" class="headerlink" title="使用场景"></a>使用场景</h3><ul>
<li>有多个子类共有的方法，且逻辑相同</li>
</ul>
<h3 id="示例问题-20"><a href="#示例问题-20" class="headerlink" title="示例问题"></a>示例问题</h3><p>需要实现一个社交网络，有推特和脸书，几种社交软件中包含许多相似代码，数据处理和分析的代码几乎完全一样。为了避免写许多重复代码，可以运用模板模式，在一个抽象的基础社交网络类中实现那些有重复代码的方法。也可以有一些抽象的方法，这些方法需要子类来实现。</p>
<p>1.创建抽象的基础社交网络类</p>
<pre><code class="java">public abstract class Network &#123;
    String userName;
    String password;

    Network() &#123;&#125;

    public boolean post(String message) &#123;
        if(logIn(userName, password)) &#123;
            boolean result = sendData(message.getBytes());
            logOut();
            return result;
        &#125;
        return false;
    &#125;

    abstract boolean logIn(String userName, String password);
    abstract boolean sendData(byte[] data);
    abstract void logOut();
&#125;
</code></pre>
<p>2.创建具体的社交媒体</p>
<pre><code class="java">public class Facebook extends Network &#123;

    public Facebook(String userName, String password) &#123;
        this.userName = userName;
        this.password = password;
    &#125;

    public boolean logIn(String userName, String password) &#123;
        System.out.println(&quot;\nChecking user&#39;s parameters&quot;);
        System.out.println(&quot;Name: &quot; + this.userName);
        System.out.print(&quot;Password: &quot;);
        for (int i = 0; i &lt; this.password.length(); i++) &#123;
            System.out.print(&quot;*&quot;);
        &#125;
        simulateNetworkLatency();
        System.out.println(&quot;\n\nLogIn success on Facebook&quot;);
        return true;
    &#125;

    public boolean sendData(byte[] data) &#123;
        System.out.println(&quot;Message: &#39;&quot; + new String(data) + &quot;&#39; was posted on Facebook&quot;);
        return true;
    &#125;

    public void logOut() &#123;
        System.out.println(&quot;User: &#39;&quot; + userName + &quot;&#39; was logged out from Facebook&quot;);
    &#125;

    private void simulateNetworkLatency() &#123;
        try &#123;
            int i = 0;
            System.out.println();
            while (i &lt; 10) &#123;
                System.out.print(&quot;.&quot;);
                Thread.sleep(500);
                i++;
            &#125;
        &#125; catch (InterruptedException ex) &#123;
            ex.printStackTrace();
        &#125;
    &#125;
&#125;
</code></pre>
<pre><code class="java">public class Twitter extends Network &#123;

    public Twitter(String userName, String password) &#123;
        this.userName = userName;
        this.password = password;
    &#125;

    public boolean logIn(String userName, String password) &#123;
        System.out.println(&quot;\nChecking user&#39;s parameters&quot;);
        System.out.println(&quot;Name: &quot; + this.userName);
        System.out.print(&quot;Password: &quot;);
        for (int i = 0; i &lt; this.password.length(); i++) &#123;
            System.out.print(&quot;*&quot;);
        &#125;
        simulateNetworkLatency();
        System.out.println(&quot;\n\nLogIn success on Twitter&quot;);
        return true;
    &#125;

    public boolean sendData(byte[] data) &#123;
        boolean messagePosted = true;
        if (messagePosted) &#123;
            System.out.println(&quot;Message: &#39;&quot; + new String(data) + &quot;&#39; was posted on Twitter&quot;);
            return true;
        &#125; else &#123;
            return false;
        &#125;
    &#125;

    public void logOut() &#123;
        System.out.println(&quot;User: &#39;&quot; + userName + &quot;&#39; was logged out from Twitter&quot;);
    &#125;

    private void simulateNetworkLatency() &#123;
        try &#123;
            int i = 0;
            System.out.println();
            while (i &lt; 10) &#123;
                System.out.print(&quot;.&quot;);
                Thread.sleep(500);
                i++;
            &#125;
        &#125; catch (InterruptedException ex) &#123;
            ex.printStackTrace();
        &#125;
    &#125;
&#125;
</code></pre>
<p>3.编写测试代码</p>
<pre><code class="java">import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class Demo &#123;
    public static void main(String[] args) throws IOException &#123;
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        Network network = null;
        System.out.print(&quot;Input user name: &quot;);
        String userName = reader.readLine();
        System.out.print(&quot;Input password: &quot;);
        String password = reader.readLine();
        System.out.print(&quot;Input message: &quot;);
        String message = reader.readLine();

        System.out.println(&quot;\nChoose social network for posting message.\n&quot; +
                &quot;1 - Facebook\n&quot; +
                &quot;2 - Twitter&quot;);
        int choice = Integer.parseInt(reader.readLine());

        // Create proper network object and send the message.
        if (choice == 1) &#123;
            network = new Facebook(userName, password);
        &#125; else if (choice == 2) &#123;
            network = new Twitter(userName, password);
        &#125;
        network.post(message);
    &#125;
&#125;
</code></pre>
<p>4.测试结果</p>
<pre><code class="java">Input user name: zyt
Input password: 1999
Input message: Hello, world!

Choose social network for posting message.
1 - Facebook
2 - Twitter
1

Checking user&#39;s parameters
Name: zyt
Password: ****
..........

LogIn success on Facebook
Message: &#39;Hello, world!&#39; was posted on Facebook
User: &#39;zyt&#39; was logged out from Facebook
</code></pre>
<h3 id="模式结构-19"><a href="#模式结构-19" class="headerlink" title="模式结构"></a>模式结构</h3><ul>
<li><strong>抽象类</strong>：声明一些抽象方法，并实现一些默认方法。</li>
<li><strong>具体类</strong>：可以重写所有步骤， 但不能重写模板方法自身。</li>
</ul>
<h3 id="优点-20"><a href="#优点-20" class="headerlink" title="优点"></a>优点</h3><ul>
<li>免去重复代码编写</li>
<li>封装不变部分，扩展可变部分</li>
</ul>
<h3 id="缺点-20"><a href="#缺点-20" class="headerlink" title="缺点"></a>缺点</h3><ul>
<li>每一个不同的实现都需要一个子类来实现，导致类的个数增加，使得系统更加庞大，也使得代码更难维护</li>
</ul>
<h2 id="访问者模式"><a href="#访问者模式" class="headerlink" title="访问者模式"></a>访问者模式</h2><h3 id="意图-21"><a href="#意图-21" class="headerlink" title="意图"></a>意图</h3><p>通过这种方式，元素的执行算法可以随着访问者改变而改变。</p>
<p>能将算法与其所作用的对象隔离开来。</p>
<h3 id="使用场景-21"><a href="#使用场景-21" class="headerlink" title="使用场景"></a>使用场景</h3><ul>
<li>对象结构中对象对应的类很少改变，但经常需要在此对象结构上定义新的操作</li>
</ul>
<h3 id="示例问题-21"><a href="#示例问题-21" class="headerlink" title="示例问题"></a>示例问题</h3><p>现有一种形状类，有多种不同形状，需要将形状导出到 XML 文件中，如果为每个形状添加导出函数，使用多态机制可以让导出方法的调用代码不会和具体的节点类相耦合。虽然这样可以达到目的，但是对已有节点类进行修改可能会引入潜在的缺陷。而且，形状类是用来作图的，把导出格式的代码放进形状类可能并不合适。</p>
<p>可以把导出的工作单独放在一个访问者类中，为每个形状都写一个独立导出方法，这样就从形状类中分离了这个操作。但是该如何调用方法呢？难道要逐个检查每个形状的类然后决定调用哪个方法吗？</p>
<p>这里要使用<a target="_blank" rel="noopener" href="https://refactoringguru.cn/design-patterns/visitor-double-dispatch">双分派</a>的技巧。在形状类中做一个小小的修改，添加一个调用接收者中方法的方法。虽然最终还是修改了节点类， 但毕竟改动很小， 且使得我们能够在后续进一步添加行为时无需再次修改代码。</p>
<p>1.创建形状接口</p>
<pre><code class="java">public interface Shape &#123;
    void move(int x, int y);
    String accept(Visitor visitor);
&#125;
</code></pre>
<p>2.创建具体形状类</p>
<pre><code class="java">public class Dot implements Shape &#123;
    private int id;
    private int x;
    private int y;

    public Dot() &#123;&#125;

    public Dot(int id, int x, int y) &#123;
        this.id = id;
        this.x = x;
        this.y = y;
    &#125;

    @Override
    public void move(int x, int y) &#123;
        this.x = x;
        this.y = y;
    &#125;

    @Override
    public String accept(Visitor visitor) &#123;
        return visitor.visitDot(this);
    &#125;

    public int getX() &#123;
        return x;
    &#125;

    public int getY() &#123;
        return y;
    &#125;

    public int getId() &#123;
        return id;
    &#125;
&#125;
</code></pre>
<pre><code class="java">public class Circle extends Dot &#123;
    private int radius;

    public Circle(int id, int x, int y, int radius) &#123;
        super(id, x, y);
        this.radius = radius;
    &#125;

    @Override
    public String accept(Visitor visitor) &#123;
        return visitor.visitCircle(this);
    &#125;

    public int getRadius() &#123;
        return radius;
    &#125;
&#125;
</code></pre>
<p>3.创建访问者接口</p>
<pre><code class="java">public interface Visitor &#123;
    String visitDot(Dot dot);
    String visitCircle(Circle circle);
&#125;
</code></pre>
<p>4.创建具体的XML导出类</p>
<pre><code class="java">public class XMLExportVisitor implements Visitor &#123;
    @Override
    public String visitDot(Dot d) &#123;
        return &quot;&lt;dot&gt;&quot; + &quot;\n&quot; +
                &quot;    &lt;id&gt;&quot; + d.getId() + &quot;&lt;/id&gt;&quot; + &quot;\n&quot; +
                &quot;    &lt;x&gt;&quot; + d.getX() + &quot;&lt;/x&gt;&quot; + &quot;\n&quot; +
                &quot;    &lt;y&gt;&quot; + d.getY() + &quot;&lt;/y&gt;&quot; + &quot;\n&quot; +
                &quot;&lt;/dot&gt;&quot;;
    &#125;

    @Override
    public String visitCircle(Circle c) &#123;
        return &quot;&lt;circle&gt;&quot; + &quot;\n&quot; +
                &quot;    &lt;id&gt;&quot; + c.getId() + &quot;&lt;/id&gt;&quot; + &quot;\n&quot; +
                &quot;    &lt;x&gt;&quot; + c.getX() + &quot;&lt;/x&gt;&quot; + &quot;\n&quot; +
                &quot;    &lt;y&gt;&quot; + c.getY() + &quot;&lt;/y&gt;&quot; + &quot;\n&quot; +
                &quot;    &lt;radius&gt;&quot; + c.getRadius() + &quot;&lt;/radius&gt;&quot; + &quot;\n&quot; +
                &quot;&lt;/circle&gt;&quot;;
    &#125;
&#125;
</code></pre>
<p>5.编写测试代码</p>
<pre><code class="java">public class Demo &#123;
    public static void main(String[] args) &#123;
        Dot dot = new Dot(1, 0, 0);
        Circle circle = new Circle(2, 3,4, 5);
        XMLExportVisitor exportVisitor = new XMLExportVisitor();
        System.out.println(dot.accept(exportVisitor));
        System.out.println(circle.accept(exportVisitor));
    &#125;
&#125;
</code></pre>
<p>6.测试结果</p>
<pre><code class="java">&lt;dot&gt;
    &lt;id&gt;1&lt;/id&gt;
    &lt;x&gt;0&lt;/x&gt;
    &lt;y&gt;0&lt;/y&gt;
&lt;/dot&gt;
&lt;circle&gt;
    &lt;id&gt;2&lt;/id&gt;
    &lt;x&gt;3&lt;/x&gt;
    &lt;y&gt;4&lt;/y&gt;
    &lt;radius&gt;5&lt;/radius&gt;
&lt;/circle&gt;
</code></pre>
<h3 id="模式结构-20"><a href="#模式结构-20" class="headerlink" title="模式结构"></a>模式结构</h3><ul>
<li><strong>访问者</strong>：接口声明了一系列以对象结构的具体元素为参数的访问者方法。 如果编程语言支持重载， 这些方法的名称可以是相同的， 但是其参数一定是不同的。</li>
<li><strong>具体访问者</strong>：为不同的元素实现不同的访问者方法。</li>
<li><strong>元素接口</strong>：声明了一个方法来 “接收” 访问者。 该方法必须有一个被声明为访问者接口类型的参数。</li>
<li><strong>具体元素</strong>：必须实现接收方法。即使元素基类实现了该方法， 所有子类都必须对其进行重写并调用访问者对象中的合适方法。</li>
</ul>
<h3 id="优点-21"><a href="#优点-21" class="headerlink" title="优点"></a>优点</h3><ul>
<li>开闭原则，可以引入在不同类对象上执行的新行为而不需要对这些类作出修改。</li>
<li>单一职责原则，可将同一行为的不同版本移到同一个类中。</li>
</ul>
<h3 id="缺点-21"><a href="#缺点-21" class="headerlink" title="缺点"></a>缺点</h3><ul>
<li>具体元素对访问者公布细节，违反了迪米特原则。</li>
<li>每次在元素层次结构中添加或移除一个类时， 都要更新所有的访问者。</li>
<li>违反了依赖倒置原则，依赖了具体类，没有依赖抽象。</li>
</ul>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">编程基础</a>
        		</li>
      		
		</ul>
	</div>

      

      

      
        
<div class="share-btn share-icons tooltip-left">
  <div class="tooltip tooltip-east">
    <span class="tooltip-item">
      <a href="javascript:;" class="share-sns share-outer">
        <i class="icon icon-share"></i>
      </a>
    </span>
    <span class="tooltip-content">
      <div class="share-wrap">
        <div class="share-icons">
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="icon icon-weibo"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="icon icon-weixin"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="icon icon-qq"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="icon icon-douban"></i>
          </a>
          <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a>
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="icon icon-facebook"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="icon icon-twitter"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="icon icon-google"></i>
          </a>
        </div>
      </div>
    </span>
  </div>
</div>

<div class="page-modal wx-share js-wx-box">
    <a class="close js-modal-close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <div class="wx-qrcode">
      <img src="//pan.baidu.com/share/qrcode?url=http://woojou.github.io/2021/07/16/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" alt="微信分享二维码">
    </div>
</div>

<div class="mask js-mask"></div>
      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

  
<nav id="article-nav">
  
    <a href="/2021/08/03/Spring%E6%A1%86%E6%9E%B6/" id="article-nav-newer" class="article-nav-link-wrap">
      <i class="icon-circle-left"></i>
      <div class="article-nav-title">
        
          Spring框架
        
      </div>
    </a>
  
  
    <a href="/2021/07/13/JVM/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">JVM</div>
      <i class="icon-circle-right"></i>
    </a>
  
</nav>


<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
        <div class="toc-container tooltip-left">
            <i class="icon-font icon-category"></i>
            <div class="tooltip tooltip-east">
                <span class="tooltip-item">
                </span>
                <span class="tooltip-content">
                    <div class="toc-article">
                    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%AE%80%E4%BB%8B"><span class="toc-number">1.</span> <span class="toc-text">设计模式简介</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-number">1.1.</span> <span class="toc-text">设计模式是什么？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GOF%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-number">1.2.</span> <span class="toc-text">GOF是什么？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.3.</span> <span class="toc-text">设计模式的类型</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F"><span class="toc-number">2.</span> <span class="toc-text">创建型模式</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F%EF%BC%88Factory-Method%EF%BC%89"><span class="toc-number">2.1.</span> <span class="toc-text">工厂方法模式（Factory Method）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%84%8F%E5%9B%BE"><span class="toc-number">2.1.1.</span> <span class="toc-text">意图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">2.1.2.</span> <span class="toc-text">使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E9%97%AE%E9%A2%98"><span class="toc-number">2.1.3.</span> <span class="toc-text">示例问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84"><span class="toc-number">2.1.4.</span> <span class="toc-text">模式结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E7%82%B9"><span class="toc-number">2.1.5.</span> <span class="toc-text">优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%BA%E7%82%B9"><span class="toc-number">2.1.6.</span> <span class="toc-text">缺点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F%EF%BC%88Abstract-Factory%EF%BC%89"><span class="toc-number">2.2.</span> <span class="toc-text">抽象工厂模式（Abstract Factory）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%84%8F%E5%9B%BE-1"><span class="toc-number">2.2.1.</span> <span class="toc-text">意图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-1"><span class="toc-number">2.2.2.</span> <span class="toc-text">使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E9%97%AE%E9%A2%98-1"><span class="toc-number">2.2.3.</span> <span class="toc-text">示例问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84-1"><span class="toc-number">2.2.4.</span> <span class="toc-text">模式结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E7%82%B9-1"><span class="toc-number">2.2.5.</span> <span class="toc-text">优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%BA%E7%82%B9-1"><span class="toc-number">2.2.6.</span> <span class="toc-text">缺点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%88Builder%EF%BC%89"><span class="toc-number">2.3.</span> <span class="toc-text">建造者模式（Builder）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%84%8F%E5%9B%BE-2"><span class="toc-number">2.3.1.</span> <span class="toc-text">意图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-2"><span class="toc-number">2.3.2.</span> <span class="toc-text">使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E9%97%AE%E9%A2%98-2"><span class="toc-number">2.3.3.</span> <span class="toc-text">示例问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84-2"><span class="toc-number">2.3.4.</span> <span class="toc-text">模式结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E7%82%B9-2"><span class="toc-number">2.3.5.</span> <span class="toc-text">优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%BA%E7%82%B9-2"><span class="toc-number">2.3.6.</span> <span class="toc-text">缺点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F%EF%BC%88Prototype%EF%BC%89"><span class="toc-number">2.4.</span> <span class="toc-text">原型模式（Prototype）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%84%8F%E5%9B%BE-3"><span class="toc-number">2.4.1.</span> <span class="toc-text">意图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-3"><span class="toc-number">2.4.2.</span> <span class="toc-text">使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E9%97%AE%E9%A2%98-3"><span class="toc-number">2.4.3.</span> <span class="toc-text">示例问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84-3"><span class="toc-number">2.4.4.</span> <span class="toc-text">模式结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E7%82%B9-3"><span class="toc-number">2.4.5.</span> <span class="toc-text">优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%BA%E7%82%B9-3"><span class="toc-number">2.4.6.</span> <span class="toc-text">缺点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%EF%BC%88Singleton%EF%BC%89"><span class="toc-number">2.5.</span> <span class="toc-text">单例模式（Singleton）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%84%8F%E5%9B%BE-4"><span class="toc-number">2.5.1.</span> <span class="toc-text">意图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-4"><span class="toc-number">2.5.2.</span> <span class="toc-text">使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E9%97%AE%E9%A2%98-4"><span class="toc-number">2.5.3.</span> <span class="toc-text">示例问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%87%A0%E7%A7%8D%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F"><span class="toc-number">2.5.4.</span> <span class="toc-text">单例模式的几种实现方式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%87%92%E6%B1%89%E5%BC%8F%EF%BC%8C%E7%BA%BF%E7%A8%8B%E4%B8%8D%E5%AE%89%E5%85%A8"><span class="toc-number">2.5.4.1.</span> <span class="toc-text">1. 懒汉式，线程不安全</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%87%92%E6%B1%89%E5%BC%8F%EF%BC%8C%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8"><span class="toc-number">2.5.4.2.</span> <span class="toc-text">2. 懒汉式，线程安全</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E9%A5%BF%E6%B1%89%E5%BC%8F"><span class="toc-number">2.5.4.3.</span> <span class="toc-text">3. 饿汉式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E5%8F%8C%E6%A3%80%E9%94%81-%E5%8F%8C%E9%87%8D%E6%A0%A1%E9%AA%8C%E9%94%81%EF%BC%88DCL%EF%BC%8C%E5%8D%B3-double-checked-locking%EF%BC%89"><span class="toc-number">2.5.4.4.</span> <span class="toc-text">4. 双检锁&#x2F;双重校验锁（DCL，即 double-checked locking）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E6%9E%9A%E4%B8%BE"><span class="toc-number">2.5.4.5.</span> <span class="toc-text">5. 枚举</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E7%82%B9-4"><span class="toc-number">2.5.5.</span> <span class="toc-text">优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%BA%E7%82%B9-4"><span class="toc-number">2.5.6.</span> <span class="toc-text">缺点</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E5%9E%8B%E6%A8%A1%E5%BC%8F"><span class="toc-number">3.</span> <span class="toc-text">结构型模式</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F%EF%BC%88Wrapper-Adapter%EF%BC%89"><span class="toc-number">3.1.</span> <span class="toc-text">适配器模式（Wrapper&#x2F;Adapter）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%84%8F%E5%9B%BE-5"><span class="toc-number">3.1.1.</span> <span class="toc-text">意图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-5"><span class="toc-number">3.1.2.</span> <span class="toc-text">使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E9%97%AE%E9%A2%98-5"><span class="toc-number">3.1.3.</span> <span class="toc-text">示例问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84-4"><span class="toc-number">3.1.4.</span> <span class="toc-text">模式结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E7%82%B9-5"><span class="toc-number">3.1.5.</span> <span class="toc-text">优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%BA%E7%82%B9-5"><span class="toc-number">3.1.6.</span> <span class="toc-text">缺点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F%EF%BC%88Bridge%EF%BC%89"><span class="toc-number">3.2.</span> <span class="toc-text">桥接模式（Bridge）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%84%8F%E5%9B%BE-6"><span class="toc-number">3.2.1.</span> <span class="toc-text">意图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-6"><span class="toc-number">3.2.2.</span> <span class="toc-text">使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E9%97%AE%E9%A2%98-6"><span class="toc-number">3.2.3.</span> <span class="toc-text">示例问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84-5"><span class="toc-number">3.2.4.</span> <span class="toc-text">模式结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E7%82%B9-6"><span class="toc-number">3.2.5.</span> <span class="toc-text">优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%BA%E7%82%B9-6"><span class="toc-number">3.2.6.</span> <span class="toc-text">缺点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F%EF%BC%88Composite%EF%BC%89"><span class="toc-number">3.3.</span> <span class="toc-text">组合模式（Composite）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%84%8F%E5%9B%BE-7"><span class="toc-number">3.3.1.</span> <span class="toc-text">意图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-7"><span class="toc-number">3.3.2.</span> <span class="toc-text">使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E9%97%AE%E9%A2%98-7"><span class="toc-number">3.3.3.</span> <span class="toc-text">示例问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84-6"><span class="toc-number">3.3.4.</span> <span class="toc-text">模式结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E7%82%B9-7"><span class="toc-number">3.3.5.</span> <span class="toc-text">优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%BA%E7%82%B9-7"><span class="toc-number">3.3.6.</span> <span class="toc-text">缺点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A3%85%E9%A5%B0%E6%A8%A1%E5%BC%8F%EF%BC%88Decorator%EF%BC%89"><span class="toc-number">3.4.</span> <span class="toc-text">装饰模式（Decorator）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%84%8F%E5%9B%BE-8"><span class="toc-number">3.4.1.</span> <span class="toc-text">意图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-8"><span class="toc-number">3.4.2.</span> <span class="toc-text">使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E9%97%AE%E9%A2%98-8"><span class="toc-number">3.4.3.</span> <span class="toc-text">示例问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84-7"><span class="toc-number">3.4.4.</span> <span class="toc-text">模式结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E7%82%B9-8"><span class="toc-number">3.4.5.</span> <span class="toc-text">优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%BA%E7%82%B9-8"><span class="toc-number">3.4.6.</span> <span class="toc-text">缺点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F%EF%BC%88Facade%EF%BC%89"><span class="toc-number">3.5.</span> <span class="toc-text">外观模式（Facade）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%84%8F%E5%9B%BE-9"><span class="toc-number">3.5.1.</span> <span class="toc-text">意图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-9"><span class="toc-number">3.5.2.</span> <span class="toc-text">使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E9%97%AE%E9%A2%98-9"><span class="toc-number">3.5.3.</span> <span class="toc-text">示例问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84-8"><span class="toc-number">3.5.4.</span> <span class="toc-text">模式结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E7%82%B9-9"><span class="toc-number">3.5.5.</span> <span class="toc-text">优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%BA%E7%82%B9-9"><span class="toc-number">3.5.6.</span> <span class="toc-text">缺点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8F%EF%BC%88Flyweight%EF%BC%89"><span class="toc-number">3.6.</span> <span class="toc-text">享元模式（Flyweight）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%84%8F%E5%9B%BE-10"><span class="toc-number">3.6.1.</span> <span class="toc-text">意图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-10"><span class="toc-number">3.6.2.</span> <span class="toc-text">使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E9%97%AE%E9%A2%98-10"><span class="toc-number">3.6.3.</span> <span class="toc-text">示例问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84-9"><span class="toc-number">3.6.4.</span> <span class="toc-text">模式结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E7%82%B9-10"><span class="toc-number">3.6.5.</span> <span class="toc-text">优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%BA%E7%82%B9-10"><span class="toc-number">3.6.6.</span> <span class="toc-text">缺点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F%EF%BC%88Proxy%EF%BC%89"><span class="toc-number">3.7.</span> <span class="toc-text">代理模式（Proxy）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%84%8F%E5%9B%BE-11"><span class="toc-number">3.7.1.</span> <span class="toc-text">意图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-11"><span class="toc-number">3.7.2.</span> <span class="toc-text">使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E9%97%AE%E9%A2%98-11"><span class="toc-number">3.7.3.</span> <span class="toc-text">示例问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84-10"><span class="toc-number">3.7.4.</span> <span class="toc-text">模式结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E7%82%B9-11"><span class="toc-number">3.7.5.</span> <span class="toc-text">优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%BA%E7%82%B9-11"><span class="toc-number">3.7.6.</span> <span class="toc-text">缺点</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%A1%8C%E4%B8%BA%E6%A8%A1%E5%BC%8F"><span class="toc-number">4.</span> <span class="toc-text">行为模式</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B4%A3%E4%BB%BB%E9%93%BE%E6%A8%A1%E5%BC%8F%EF%BC%88Chain-of-Responsibility%EF%BC%89"><span class="toc-number">4.1.</span> <span class="toc-text">责任链模式（Chain of Responsibility）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%84%8F%E5%9B%BE-12"><span class="toc-number">4.1.1.</span> <span class="toc-text">意图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-12"><span class="toc-number">4.1.2.</span> <span class="toc-text">使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E9%97%AE%E9%A2%98-12"><span class="toc-number">4.1.3.</span> <span class="toc-text">示例问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84-11"><span class="toc-number">4.1.4.</span> <span class="toc-text">模式结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E7%82%B9-12"><span class="toc-number">4.1.5.</span> <span class="toc-text">优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%BA%E7%82%B9-12"><span class="toc-number">4.1.6.</span> <span class="toc-text">缺点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F%EF%BC%88Command%EF%BC%89"><span class="toc-number">4.2.</span> <span class="toc-text">命令模式（Command）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%84%8F%E5%9B%BE-13"><span class="toc-number">4.2.1.</span> <span class="toc-text">意图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-13"><span class="toc-number">4.2.2.</span> <span class="toc-text">使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E9%97%AE%E9%A2%98-13"><span class="toc-number">4.2.3.</span> <span class="toc-text">示例问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84-12"><span class="toc-number">4.2.4.</span> <span class="toc-text">模式结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E7%82%B9-13"><span class="toc-number">4.2.5.</span> <span class="toc-text">优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%BA%E7%82%B9-13"><span class="toc-number">4.2.6.</span> <span class="toc-text">缺点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%AD%E4%BB%A3%E5%99%A8%E6%A8%A1%E5%BC%8F%EF%BC%88Iterator%EF%BC%89"><span class="toc-number">4.3.</span> <span class="toc-text">迭代器模式（Iterator）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%84%8F%E5%9B%BE-14"><span class="toc-number">4.3.1.</span> <span class="toc-text">意图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-14"><span class="toc-number">4.3.2.</span> <span class="toc-text">使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E9%97%AE%E9%A2%98-14"><span class="toc-number">4.3.3.</span> <span class="toc-text">示例问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84-13"><span class="toc-number">4.3.4.</span> <span class="toc-text">模式结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E7%82%B9-14"><span class="toc-number">4.3.5.</span> <span class="toc-text">优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%BA%E7%82%B9-14"><span class="toc-number">4.3.6.</span> <span class="toc-text">缺点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%AD%E4%BB%8B%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%88Mediator%EF%BC%89"><span class="toc-number">4.4.</span> <span class="toc-text">中介者模式（Mediator）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%84%8F%E5%9B%BE-15"><span class="toc-number">4.4.1.</span> <span class="toc-text">意图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-15"><span class="toc-number">4.4.2.</span> <span class="toc-text">使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E9%97%AE%E9%A2%98-15"><span class="toc-number">4.4.3.</span> <span class="toc-text">示例问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84-14"><span class="toc-number">4.4.4.</span> <span class="toc-text">模式结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E7%82%B9-15"><span class="toc-number">4.4.5.</span> <span class="toc-text">优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%BA%E7%82%B9-15"><span class="toc-number">4.4.6.</span> <span class="toc-text">缺点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%87%E5%BF%98%E5%BD%95%E6%A8%A1%E5%BC%8F%EF%BC%88Memento%EF%BC%89"><span class="toc-number">4.5.</span> <span class="toc-text">备忘录模式（Memento）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%84%8F%E5%9B%BE-16"><span class="toc-number">4.5.1.</span> <span class="toc-text">意图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-16"><span class="toc-number">4.5.2.</span> <span class="toc-text">使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E9%97%AE%E9%A2%98-16"><span class="toc-number">4.5.3.</span> <span class="toc-text">示例问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84-15"><span class="toc-number">4.5.4.</span> <span class="toc-text">模式结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E7%82%B9-16"><span class="toc-number">4.5.5.</span> <span class="toc-text">优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%BA%E7%82%B9-16"><span class="toc-number">4.5.6.</span> <span class="toc-text">缺点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%88Observer%EF%BC%89"><span class="toc-number">4.6.</span> <span class="toc-text">观察者模式（Observer）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%84%8F%E5%9B%BE-17"><span class="toc-number">4.6.1.</span> <span class="toc-text">意图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-17"><span class="toc-number">4.6.2.</span> <span class="toc-text">使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E9%97%AE%E9%A2%98-17"><span class="toc-number">4.6.3.</span> <span class="toc-text">示例问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84-16"><span class="toc-number">4.6.4.</span> <span class="toc-text">模式结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E7%82%B9-17"><span class="toc-number">4.6.5.</span> <span class="toc-text">优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%BA%E7%82%B9-17"><span class="toc-number">4.6.6.</span> <span class="toc-text">缺点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8A%B6%E6%80%81%E6%A8%A1%E5%BC%8F%EF%BC%88State%EF%BC%89"><span class="toc-number">4.7.</span> <span class="toc-text">状态模式（State）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%84%8F%E5%9B%BE-18"><span class="toc-number">4.7.1.</span> <span class="toc-text">意图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-18"><span class="toc-number">4.7.2.</span> <span class="toc-text">使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E9%97%AE%E9%A2%98-18"><span class="toc-number">4.7.3.</span> <span class="toc-text">示例问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84-17"><span class="toc-number">4.7.4.</span> <span class="toc-text">模式结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E7%82%B9-18"><span class="toc-number">4.7.5.</span> <span class="toc-text">优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%BA%E7%82%B9-18"><span class="toc-number">4.7.6.</span> <span class="toc-text">缺点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AD%96%E7%95%A5%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%EF%BC%88Strategy%EF%BC%89"><span class="toc-number">4.8.</span> <span class="toc-text">策略设计模式（Strategy）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%84%8F%E5%9B%BE-19"><span class="toc-number">4.8.1.</span> <span class="toc-text">意图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-19"><span class="toc-number">4.8.2.</span> <span class="toc-text">使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E9%97%AE%E9%A2%98-19"><span class="toc-number">4.8.3.</span> <span class="toc-text">示例问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84-18"><span class="toc-number">4.8.4.</span> <span class="toc-text">模式结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E7%82%B9-19"><span class="toc-number">4.8.5.</span> <span class="toc-text">优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%BA%E7%82%B9-19"><span class="toc-number">4.8.6.</span> <span class="toc-text">缺点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E6%9D%BF%E6%A8%A1%E5%BC%8F%EF%BC%88Template%EF%BC%89"><span class="toc-number">4.9.</span> <span class="toc-text">模板模式（Template）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%84%8F%E5%9B%BE-20"><span class="toc-number">4.9.1.</span> <span class="toc-text">意图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-20"><span class="toc-number">4.9.2.</span> <span class="toc-text">使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E9%97%AE%E9%A2%98-20"><span class="toc-number">4.9.3.</span> <span class="toc-text">示例问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84-19"><span class="toc-number">4.9.4.</span> <span class="toc-text">模式结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E7%82%B9-20"><span class="toc-number">4.9.5.</span> <span class="toc-text">优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%BA%E7%82%B9-20"><span class="toc-number">4.9.6.</span> <span class="toc-text">缺点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E8%80%85%E6%A8%A1%E5%BC%8F"><span class="toc-number">4.10.</span> <span class="toc-text">访问者模式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%84%8F%E5%9B%BE-21"><span class="toc-number">4.10.1.</span> <span class="toc-text">意图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF-21"><span class="toc-number">4.10.2.</span> <span class="toc-text">使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E9%97%AE%E9%A2%98-21"><span class="toc-number">4.10.3.</span> <span class="toc-text">示例问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84-20"><span class="toc-number">4.10.4.</span> <span class="toc-text">模式结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E7%82%B9-21"><span class="toc-number">4.10.5.</span> <span class="toc-text">优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%BA%E7%82%B9-21"><span class="toc-number">4.10.6.</span> <span class="toc-text">缺点</span></a></li></ol></li></ol></li></ol>
                    </div>
                </span>
            </div>
        </div>
        
    </div>
</aside>



  
  
  

  

  

  


          </div>
        </div>
      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2022 Woojou
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    <script>
	var yiliaConfig = {
		mathjax: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false,
		toc_hide_index: true,
		root: "/",
		innerArchive: true,
		showTags: false
	}
</script>

<script>!function(t){function n(e){if(r[e])return r[e].exports;var i=r[e]={exports:{},id:e,loaded:!1};return t[e].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}var r={};n.m=t,n.c=r,n.p="./",n(0)}([function(t,n,r){r(195),t.exports=r(191)},function(t,n,r){var e=r(3),i=r(52),o=r(27),u=r(28),c=r(53),f="prototype",a=function(t,n,r){var s,l,h,v,p=t&a.F,d=t&a.G,y=t&a.S,g=t&a.P,b=t&a.B,m=d?e:y?e[n]||(e[n]={}):(e[n]||{})[f],x=d?i:i[n]||(i[n]={}),w=x[f]||(x[f]={});d&&(r=n);for(s in r)l=!p&&m&&void 0!==m[s],h=(l?m:r)[s],v=b&&l?c(h,e):g&&"function"==typeof h?c(Function.call,h):h,m&&u(m,s,h,t&a.U),x[s]!=h&&o(x,s,v),g&&w[s]!=h&&(w[s]=h)};e.core=i,a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,a.U=64,a.R=128,t.exports=a},function(t,n,r){var e=r(6);t.exports=function(t){if(!e(t))throw TypeError(t+" is not an object!");return t}},function(t,n){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,n){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(t,n){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,n,r){var e=r(126)("wks"),i=r(76),o=r(3).Symbol,u="function"==typeof o;(t.exports=function(t){return e[t]||(e[t]=u&&o[t]||(u?o:i)("Symbol."+t))}).store=e},function(t,n){var r={}.hasOwnProperty;t.exports=function(t,n){return r.call(t,n)}},function(t,n,r){var e=r(94),i=r(33);t.exports=function(t){return e(i(t))}},function(t,n,r){t.exports=!r(4)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,n,r){var e=r(2),i=r(167),o=r(50),u=Object.defineProperty;n.f=r(10)?Object.defineProperty:function(t,n,r){if(e(t),n=o(n,!0),e(r),i)try{return u(t,n,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[n]=r.value),t}},function(t,n,r){t.exports=!r(18)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,n,r){var e=r(14),i=r(22);t.exports=r(12)?function(t,n,r){return e.f(t,n,i(1,r))}:function(t,n,r){return t[n]=r,t}},function(t,n,r){var e=r(20),i=r(58),o=r(42),u=Object.defineProperty;n.f=r(12)?Object.defineProperty:function(t,n,r){if(e(t),n=o(n,!0),e(r),i)try{return u(t,n,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[n]=r.value),t}},function(t,n,r){var e=r(40)("wks"),i=r(23),o=r(5).Symbol,u="function"==typeof o;(t.exports=function(t){return e[t]||(e[t]=u&&o[t]||(u?o:i)("Symbol."+t))}).store=e},function(t,n,r){var e=r(67),i=Math.min;t.exports=function(t){return t>0?i(e(t),9007199254740991):0}},function(t,n,r){var e=r(46);t.exports=function(t){return Object(e(t))}},function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,n,r){var e=r(63),i=r(34);t.exports=Object.keys||function(t){return e(t,i)}},function(t,n,r){var e=r(21);t.exports=function(t){if(!e(t))throw TypeError(t+" is not an object!");return t}},function(t,n){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n){var r=0,e=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+e).toString(36))}},function(t,n){var r={}.hasOwnProperty;t.exports=function(t,n){return r.call(t,n)}},function(t,n){var r=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=r)},function(t,n){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,n,r){var e=r(11),i=r(66);t.exports=r(10)?function(t,n,r){return e.f(t,n,i(1,r))}:function(t,n,r){return t[n]=r,t}},function(t,n,r){var e=r(3),i=r(27),o=r(24),u=r(76)("src"),c="toString",f=Function[c],a=(""+f).split(c);r(52).inspectSource=function(t){return f.call(t)},(t.exports=function(t,n,r,c){var f="function"==typeof r;f&&(o(r,"name")||i(r,"name",n)),t[n]!==r&&(f&&(o(r,u)||i(r,u,t[n]?""+t[n]:a.join(String(n)))),t===e?t[n]=r:c?t[n]?t[n]=r:i(t,n,r):(delete t[n],i(t,n,r)))})(Function.prototype,c,function(){return"function"==typeof this&&this[u]||f.call(this)})},function(t,n,r){var e=r(1),i=r(4),o=r(46),u=function(t,n,r,e){var i=String(o(t)),u="<"+n;return""!==r&&(u+=" "+r+'="'+String(e).replace(/"/g,"&quot;")+'"'),u+">"+i+"</"+n+">"};t.exports=function(t,n){var r={};r[t]=n(u),e(e.P+e.F*i(function(){var n=""[t]('"');return n!==n.toLowerCase()||n.split('"').length>3}),"String",r)}},function(t,n,r){var e=r(115),i=r(46);t.exports=function(t){return e(i(t))}},function(t,n,r){var e=r(116),i=r(66),o=r(30),u=r(50),c=r(24),f=r(167),a=Object.getOwnPropertyDescriptor;n.f=r(10)?a:function(t,n){if(t=o(t),n=u(n,!0),f)try{return a(t,n)}catch(t){}if(c(t,n))return i(!e.f.call(t,n),t[n])}},function(t,n,r){var e=r(24),i=r(17),o=r(145)("IE_PROTO"),u=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),e(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,n){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,n){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,n){t.exports={}},function(t,n){t.exports=!0},function(t,n){n.f={}.propertyIsEnumerable},function(t,n,r){var e=r(14).f,i=r(8),o=r(15)("toStringTag");t.exports=function(t,n,r){t&&!i(t=r?t:t.prototype,o)&&e(t,o,{configurable:!0,value:n})}},function(t,n,r){var e=r(40)("keys"),i=r(23);t.exports=function(t){return e[t]||(e[t]=i(t))}},function(t,n,r){var e=r(5),i="__core-js_shared__",o=e[i]||(e[i]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,n){var r=Math.ceil,e=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?e:r)(t)}},function(t,n,r){var e=r(21);t.exports=function(t,n){if(!e(t))return t;var r,i;if(n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!e(i=r.call(t)))return i;if(!n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,n,r){var e=r(5),i=r(25),o=r(36),u=r(44),c=r(14).f;t.exports=function(t){var n=i.Symbol||(i.Symbol=o?{}:e.Symbol||{});"_"==t.charAt(0)||t in n||c(n,t,{value:u.f(t)})}},function(t,n,r){n.f=r(15)},function(t,n){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},function(t,n){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,n,r){var e=r(4);t.exports=function(t,n){return!!t&&e(function(){n?t.call(null,function(){},1):t.call(null)})}},function(t,n,r){var e=r(53),i=r(115),o=r(17),u=r(16),c=r(203);t.exports=function(t,n){var r=1==t,f=2==t,a=3==t,s=4==t,l=6==t,h=5==t||l,v=n||c;return function(n,c,p){for(var d,y,g=o(n),b=i(g),m=e(c,p,3),x=u(b.length),w=0,S=r?v(n,x):f?v(n,0):void 0;x>w;w++)if((h||w in b)&&(d=b[w],y=m(d,w,g),t))if(r)S[w]=y;else if(y)switch(t){case 3:return!0;case 5:return d;case 6:return w;case 2:S.push(d)}else if(s)return!1;return l?-1:a||s?s:S}}},function(t,n,r){var e=r(1),i=r(52),o=r(4);t.exports=function(t,n){var r=(i.Object||{})[t]||Object[t],u={};u[t]=n(r),e(e.S+e.F*o(function(){r(1)}),"Object",u)}},function(t,n,r){var e=r(6);t.exports=function(t,n){if(!e(t))return t;var r,i;if(n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!e(i=r.call(t)))return i;if(!n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,n,r){var e=r(5),i=r(25),o=r(91),u=r(13),c="prototype",f=function(t,n,r){var a,s,l,h=t&f.F,v=t&f.G,p=t&f.S,d=t&f.P,y=t&f.B,g=t&f.W,b=v?i:i[n]||(i[n]={}),m=b[c],x=v?e:p?e[n]:(e[n]||{})[c];v&&(r=n);for(a in r)(s=!h&&x&&void 0!==x[a])&&a in b||(l=s?x[a]:r[a],b[a]=v&&"function"!=typeof x[a]?r[a]:y&&s?o(l,e):g&&x[a]==l?function(t){var n=function(n,r,e){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(n);case 2:return new t(n,r)}return new t(n,r,e)}return t.apply(this,arguments)};return n[c]=t[c],n}(l):d&&"function"==typeof l?o(Function.call,l):l,d&&((b.virtual||(b.virtual={}))[a]=l,t&f.R&&m&&!m[a]&&u(m,a,l)))};f.F=1,f.G=2,f.S=4,f.P=8,f.B=16,f.W=32,f.U=64,f.R=128,t.exports=f},function(t,n){var r=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=r)},function(t,n,r){var e=r(26);t.exports=function(t,n,r){if(e(t),void 0===n)return t;switch(r){case 1:return function(r){return t.call(n,r)};case 2:return function(r,e){return t.call(n,r,e)};case 3:return function(r,e,i){return t.call(n,r,e,i)}}return function(){return t.apply(n,arguments)}}},function(t,n,r){var e=r(183),i=r(1),o=r(126)("metadata"),u=o.store||(o.store=new(r(186))),c=function(t,n,r){var i=u.get(t);if(!i){if(!r)return;u.set(t,i=new e)}var o=i.get(n);if(!o){if(!r)return;i.set(n,o=new e)}return o},f=function(t,n,r){var e=c(n,r,!1);return void 0!==e&&e.has(t)},a=function(t,n,r){var e=c(n,r,!1);return void 0===e?void 0:e.get(t)},s=function(t,n,r,e){c(r,e,!0).set(t,n)},l=function(t,n){var r=c(t,n,!1),e=[];return r&&r.forEach(function(t,n){e.push(n)}),e},h=function(t){return void 0===t||"symbol"==typeof t?t:String(t)},v=function(t){i(i.S,"Reflect",t)};t.exports={store:u,map:c,has:f,get:a,set:s,keys:l,key:h,exp:v}},function(t,n,r){"use strict";if(r(10)){var e=r(69),i=r(3),o=r(4),u=r(1),c=r(127),f=r(152),a=r(53),s=r(68),l=r(66),h=r(27),v=r(73),p=r(67),d=r(16),y=r(75),g=r(50),b=r(24),m=r(180),x=r(114),w=r(6),S=r(17),_=r(137),O=r(70),E=r(32),P=r(71).f,j=r(154),F=r(76),M=r(7),A=r(48),N=r(117),T=r(146),I=r(155),k=r(80),L=r(123),R=r(74),C=r(130),D=r(160),U=r(11),W=r(31),G=U.f,B=W.f,V=i.RangeError,z=i.TypeError,q=i.Uint8Array,K="ArrayBuffer",J="Shared"+K,Y="BYTES_PER_ELEMENT",H="prototype",$=Array[H],X=f.ArrayBuffer,Q=f.DataView,Z=A(0),tt=A(2),nt=A(3),rt=A(4),et=A(5),it=A(6),ot=N(!0),ut=N(!1),ct=I.values,ft=I.keys,at=I.entries,st=$.lastIndexOf,lt=$.reduce,ht=$.reduceRight,vt=$.join,pt=$.sort,dt=$.slice,yt=$.toString,gt=$.toLocaleString,bt=M("iterator"),mt=M("toStringTag"),xt=F("typed_constructor"),wt=F("def_constructor"),St=c.CONSTR,_t=c.TYPED,Ot=c.VIEW,Et="Wrong length!",Pt=A(1,function(t,n){return Tt(T(t,t[wt]),n)}),jt=o(function(){return 1===new q(new Uint16Array([1]).buffer)[0]}),Ft=!!q&&!!q[H].set&&o(function(){new q(1).set({})}),Mt=function(t,n){if(void 0===t)throw z(Et);var r=+t,e=d(t);if(n&&!m(r,e))throw V(Et);return e},At=function(t,n){var r=p(t);if(r<0||r%n)throw V("Wrong offset!");return r},Nt=function(t){if(w(t)&&_t in t)return t;throw z(t+" is not a typed array!")},Tt=function(t,n){if(!(w(t)&&xt in t))throw z("It is not a typed array constructor!");return new t(n)},It=function(t,n){return kt(T(t,t[wt]),n)},kt=function(t,n){for(var r=0,e=n.length,i=Tt(t,e);e>r;)i[r]=n[r++];return i},Lt=function(t,n,r){G(t,n,{get:function(){return this._d[r]}})},Rt=function(t){var n,r,e,i,o,u,c=S(t),f=arguments.length,s=f>1?arguments[1]:void 0,l=void 0!==s,h=j(c);if(void 0!=h&&!_(h)){for(u=h.call(c),e=[],n=0;!(o=u.next()).done;n++)e.push(o.value);c=e}for(l&&f>2&&(s=a(s,arguments[2],2)),n=0,r=d(c.length),i=Tt(this,r);r>n;n++)i[n]=l?s(c[n],n):c[n];return i},Ct=function(){for(var t=0,n=arguments.length,r=Tt(this,n);n>t;)r[t]=arguments[t++];return r},Dt=!!q&&o(function(){gt.call(new q(1))}),Ut=function(){return gt.apply(Dt?dt.call(Nt(this)):Nt(this),arguments)},Wt={copyWithin:function(t,n){return D.call(Nt(this),t,n,arguments.length>2?arguments[2]:void 0)},every:function(t){return rt(Nt(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return C.apply(Nt(this),arguments)},filter:function(t){return It(this,tt(Nt(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return et(Nt(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return it(Nt(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){Z(Nt(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return ut(Nt(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return ot(Nt(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return vt.apply(Nt(this),arguments)},lastIndexOf:function(t){return st.apply(Nt(this),arguments)},map:function(t){return Pt(Nt(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return lt.apply(Nt(this),arguments)},reduceRight:function(t){return ht.apply(Nt(this),arguments)},reverse:function(){for(var t,n=this,r=Nt(n).length,e=Math.floor(r/2),i=0;i<e;)t=n[i],n[i++]=n[--r],n[r]=t;return n},some:function(t){return nt(Nt(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return pt.call(Nt(this),t)},subarray:function(t,n){var r=Nt(this),e=r.length,i=y(t,e);return new(T(r,r[wt]))(r.buffer,r.byteOffset+i*r.BYTES_PER_ELEMENT,d((void 0===n?e:y(n,e))-i))}},Gt=function(t,n){return It(this,dt.call(Nt(this),t,n))},Bt=function(t){Nt(this);var n=At(arguments[1],1),r=this.length,e=S(t),i=d(e.length),o=0;if(i+n>r)throw V(Et);for(;o<i;)this[n+o]=e[o++]},Vt={entries:function(){return at.call(Nt(this))},keys:function(){return ft.call(Nt(this))},values:function(){return ct.call(Nt(this))}},zt=function(t,n){return w(t)&&t[_t]&&"symbol"!=typeof n&&n in t&&String(+n)==String(n)},qt=function(t,n){return zt(t,n=g(n,!0))?l(2,t[n]):B(t,n)},Kt=function(t,n,r){return!(zt(t,n=g(n,!0))&&w(r)&&b(r,"value"))||b(r,"get")||b(r,"set")||r.configurable||b(r,"writable")&&!r.writable||b(r,"enumerable")&&!r.enumerable?G(t,n,r):(t[n]=r.value,t)};St||(W.f=qt,U.f=Kt),u(u.S+u.F*!St,"Object",{getOwnPropertyDescriptor:qt,defineProperty:Kt}),o(function(){yt.call({})})&&(yt=gt=function(){return vt.call(this)});var Jt=v({},Wt);v(Jt,Vt),h(Jt,bt,Vt.values),v(Jt,{slice:Gt,set:Bt,constructor:function(){},toString:yt,toLocaleString:Ut}),Lt(Jt,"buffer","b"),Lt(Jt,"byteOffset","o"),Lt(Jt,"byteLength","l"),Lt(Jt,"length","e"),G(Jt,mt,{get:function(){return this[_t]}}),t.exports=function(t,n,r,f){f=!!f;var a=t+(f?"Clamped":"")+"Array",l="Uint8Array"!=a,v="get"+t,p="set"+t,y=i[a],g=y||{},b=y&&E(y),m=!y||!c.ABV,S={},_=y&&y[H],j=function(t,r){var e=t._d;return e.v[v](r*n+e.o,jt)},F=function(t,r,e){var i=t._d;f&&(e=(e=Math.round(e))<0?0:e>255?255:255&e),i.v[p](r*n+i.o,e,jt)},M=function(t,n){G(t,n,{get:function(){return j(this,n)},set:function(t){return F(this,n,t)},enumerable:!0})};m?(y=r(function(t,r,e,i){s(t,y,a,"_d");var o,u,c,f,l=0,v=0;if(w(r)){if(!(r instanceof X||(f=x(r))==K||f==J))return _t in r?kt(y,r):Rt.call(y,r);o=r,v=At(e,n);var p=r.byteLength;if(void 0===i){if(p%n)throw V(Et);if((u=p-v)<0)throw V(Et)}else if((u=d(i)*n)+v>p)throw V(Et);c=u/n}else c=Mt(r,!0),u=c*n,o=new X(u);for(h(t,"_d",{b:o,o:v,l:u,e:c,v:new Q(o)});l<c;)M(t,l++)}),_=y[H]=O(Jt),h(_,"constructor",y)):L(function(t){new y(null),new y(t)},!0)||(y=r(function(t,r,e,i){s(t,y,a);var o;return w(r)?r instanceof X||(o=x(r))==K||o==J?void 0!==i?new g(r,At(e,n),i):void 0!==e?new g(r,At(e,n)):new g(r):_t in r?kt(y,r):Rt.call(y,r):new g(Mt(r,l))}),Z(b!==Function.prototype?P(g).concat(P(b)):P(g),function(t){t in y||h(y,t,g[t])}),y[H]=_,e||(_.constructor=y));var A=_[bt],N=!!A&&("values"==A.name||void 0==A.name),T=Vt.values;h(y,xt,!0),h(_,_t,a),h(_,Ot,!0),h(_,wt,y),(f?new y(1)[mt]==a:mt in _)||G(_,mt,{get:function(){return a}}),S[a]=y,u(u.G+u.W+u.F*(y!=g),S),u(u.S,a,{BYTES_PER_ELEMENT:n,from:Rt,of:Ct}),Y in _||h(_,Y,n),u(u.P,a,Wt),R(a),u(u.P+u.F*Ft,a,{set:Bt}),u(u.P+u.F*!N,a,Vt),u(u.P+u.F*(_.toString!=yt),a,{toString:yt}),u(u.P+u.F*o(function(){new y(1).slice()}),a,{slice:Gt}),u(u.P+u.F*(o(function(){return[1,2].toLocaleString()!=new y([1,2]).toLocaleString()})||!o(function(){_.toLocaleString.call([1,2])})),a,{toLocaleString:Ut}),k[a]=N?A:T,e||N||h(_,bt,T)}}else t.exports=function(){}},function(t,n){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},function(t,n,r){var e=r(21),i=r(5).document,o=e(i)&&e(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,n,r){t.exports=!r(12)&&!r(18)(function(){return 7!=Object.defineProperty(r(57)("div"),"a",{get:function(){return 7}}).a})},function(t,n,r){"use strict";var e=r(36),i=r(51),o=r(64),u=r(13),c=r(8),f=r(35),a=r(96),s=r(38),l=r(103),h=r(15)("iterator"),v=!([].keys&&"next"in[].keys()),p="keys",d="values",y=function(){return this};t.exports=function(t,n,r,g,b,m,x){a(r,n,g);var w,S,_,O=function(t){if(!v&&t in F)return F[t];switch(t){case p:case d:return function(){return new r(this,t)}}return function(){return new r(this,t)}},E=n+" Iterator",P=b==d,j=!1,F=t.prototype,M=F[h]||F["@@iterator"]||b&&F[b],A=M||O(b),N=b?P?O("entries"):A:void 0,T="Array"==n?F.entries||M:M;if(T&&(_=l(T.call(new t)))!==Object.prototype&&(s(_,E,!0),e||c(_,h)||u(_,h,y)),P&&M&&M.name!==d&&(j=!0,A=function(){return M.call(this)}),e&&!x||!v&&!j&&F[h]||u(F,h,A),f[n]=A,f[E]=y,b)if(w={values:P?A:O(d),keys:m?A:O(p),entries:N},x)for(S in w)S in F||o(F,S,w[S]);else i(i.P+i.F*(v||j),n,w);return w}},function(t,n,r){var e=r(20),i=r(100),o=r(34),u=r(39)("IE_PROTO"),c=function(){},f="prototype",a=function(){var t,n=r(57)("iframe"),e=o.length;for(n.style.display="none",r(93).appendChild(n),n.src="javascript:",t=n.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),a=t.F;e--;)delete a[f][o[e]];return a()};t.exports=Object.create||function(t,n){var r;return null!==t?(c[f]=e(t),r=new c,c[f]=null,r[u]=t):r=a(),void 0===n?r:i(r,n)}},function(t,n,r){var e=r(63),i=r(34).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return e(t,i)}},function(t,n){n.f=Object.getOwnPropertySymbols},function(t,n,r){var e=r(8),i=r(9),o=r(90)(!1),u=r(39)("IE_PROTO");t.exports=function(t,n){var r,c=i(t),f=0,a=[];for(r in c)r!=u&&e(c,r)&&a.push(r);for(;n.length>f;)e(c,r=n[f++])&&(~o(a,r)||a.push(r));return a}},function(t,n,r){t.exports=r(13)},function(t,n,r){var e=r(76)("meta"),i=r(6),o=r(24),u=r(11).f,c=0,f=Object.isExtensible||function(){return!0},a=!r(4)(function(){return f(Object.preventExtensions({}))}),s=function(t){u(t,e,{value:{i:"O"+ ++c,w:{}}})},l=function(t,n){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,e)){if(!f(t))return"F";if(!n)return"E";s(t)}return t[e].i},h=function(t,n){if(!o(t,e)){if(!f(t))return!0;if(!n)return!1;s(t)}return t[e].w},v=function(t){return a&&p.NEED&&f(t)&&!o(t,e)&&s(t),t},p=t.exports={KEY:e,NEED:!1,fastKey:l,getWeak:h,onFreeze:v}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n){var r=Math.ceil,e=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?e:r)(t)}},function(t,n){t.exports=function(t,n,r,e){if(!(t instanceof n)||void 0!==e&&e in t)throw TypeError(r+": incorrect invocation!");return t}},function(t,n){t.exports=!1},function(t,n,r){var e=r(2),i=r(173),o=r(133),u=r(145)("IE_PROTO"),c=function(){},f="prototype",a=function(){var t,n=r(132)("iframe"),e=o.length;for(n.style.display="none",r(135).appendChild(n),n.src="javascript:",t=n.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),a=t.F;e--;)delete a[f][o[e]];return a()};t.exports=Object.create||function(t,n){var r;return null!==t?(c[f]=e(t),r=new c,c[f]=null,r[u]=t):r=a(),void 0===n?r:i(r,n)}},function(t,n,r){var e=r(175),i=r(133).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return e(t,i)}},function(t,n,r){var e=r(175),i=r(133);t.exports=Object.keys||function(t){return e(t,i)}},function(t,n,r){var e=r(28);t.exports=function(t,n,r){for(var i in n)e(t,i,n[i],r);return t}},function(t,n,r){"use strict";var e=r(3),i=r(11),o=r(10),u=r(7)("species");t.exports=function(t){var n=e[t];o&&n&&!n[u]&&i.f(n,u,{configurable:!0,get:function(){return this}})}},function(t,n,r){var e=r(67),i=Math.max,o=Math.min;t.exports=function(t,n){return t=e(t),t<0?i(t+n,0):o(t,n)}},function(t,n){var r=0,e=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+e).toString(36))}},function(t,n,r){var e=r(33);t.exports=function(t){return Object(e(t))}},function(t,n,r){var e=r(7)("unscopables"),i=Array.prototype;void 0==i[e]&&r(27)(i,e,{}),t.exports=function(t){i[e][t]=!0}},function(t,n,r){var e=r(53),i=r(169),o=r(137),u=r(2),c=r(16),f=r(154),a={},s={},n=t.exports=function(t,n,r,l,h){var v,p,d,y,g=h?function(){return t}:f(t),b=e(r,l,n?2:1),m=0;if("function"!=typeof g)throw TypeError(t+" is not iterable!");if(o(g)){for(v=c(t.length);v>m;m++)if((y=n?b(u(p=t[m])[0],p[1]):b(t[m]))===a||y===s)return y}else for(d=g.call(t);!(p=d.next()).done;)if((y=i(d,b,p.value,n))===a||y===s)return y};n.BREAK=a,n.RETURN=s},function(t,n){t.exports={}},function(t,n,r){var e=r(11).f,i=r(24),o=r(7)("toStringTag");t.exports=function(t,n,r){t&&!i(t=r?t:t.prototype,o)&&e(t,o,{configurable:!0,value:n})}},function(t,n,r){var e=r(1),i=r(46),o=r(4),u=r(150),c="["+u+"]",f="​",a=RegExp("^"+c+c+"*"),s=RegExp(c+c+"*$"),l=function(t,n,r){var i={},c=o(function(){return!!u[t]()||f[t]()!=f}),a=i[t]=c?n(h):u[t];r&&(i[r]=a),e(e.P+e.F*c,"String",i)},h=l.trim=function(t,n){return t=String(i(t)),1&n&&(t=t.replace(a,"")),2&n&&(t=t.replace(s,"")),t};t.exports=l},function(t,n,r){t.exports={default:r(86),__esModule:!0}},function(t,n,r){t.exports={default:r(87),__esModule:!0}},function(t,n,r){"use strict";function e(t){return t&&t.__esModule?t:{default:t}}n.__esModule=!0;var i=r(84),o=e(i),u=r(83),c=e(u),f="function"==typeof c.default&&"symbol"==typeof o.default?function(t){return typeof t}:function(t){return t&&"function"==typeof c.default&&t.constructor===c.default&&t!==c.default.prototype?"symbol":typeof t};n.default="function"==typeof c.default&&"symbol"===f(o.default)?function(t){return void 0===t?"undefined":f(t)}:function(t){return t&&"function"==typeof c.default&&t.constructor===c.default&&t!==c.default.prototype?"symbol":void 0===t?"undefined":f(t)}},function(t,n,r){r(110),r(108),r(111),r(112),t.exports=r(25).Symbol},function(t,n,r){r(109),r(113),t.exports=r(44).f("iterator")},function(t,n){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,n){t.exports=function(){}},function(t,n,r){var e=r(9),i=r(106),o=r(105);t.exports=function(t){return function(n,r,u){var c,f=e(n),a=i(f.length),s=o(u,a);if(t&&r!=r){for(;a>s;)if((c=f[s++])!=c)return!0}else for(;a>s;s++)if((t||s in f)&&f[s]===r)return t||s||0;return!t&&-1}}},function(t,n,r){var e=r(88);t.exports=function(t,n,r){if(e(t),void 0===n)return t;switch(r){case 1:return function(r){return t.call(n,r)};case 2:return function(r,e){return t.call(n,r,e)};case 3:return function(r,e,i){return t.call(n,r,e,i)}}return function(){return t.apply(n,arguments)}}},function(t,n,r){var e=r(19),i=r(62),o=r(37);t.exports=function(t){var n=e(t),r=i.f;if(r)for(var u,c=r(t),f=o.f,a=0;c.length>a;)f.call(t,u=c[a++])&&n.push(u);return n}},function(t,n,r){t.exports=r(5).document&&document.documentElement},function(t,n,r){var e=r(56);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==e(t)?t.split(""):Object(t)}},function(t,n,r){var e=r(56);t.exports=Array.isArray||function(t){return"Array"==e(t)}},function(t,n,r){"use strict";var e=r(60),i=r(22),o=r(38),u={};r(13)(u,r(15)("iterator"),function(){return this}),t.exports=function(t,n,r){t.prototype=e(u,{next:i(1,r)}),o(t,n+" Iterator")}},function(t,n){t.exports=function(t,n){return{value:n,done:!!t}}},function(t,n,r){var e=r(19),i=r(9);t.exports=function(t,n){for(var r,o=i(t),u=e(o),c=u.length,f=0;c>f;)if(o[r=u[f++]]===n)return r}},function(t,n,r){var e=r(23)("meta"),i=r(21),o=r(8),u=r(14).f,c=0,f=Object.isExtensible||function(){return!0},a=!r(18)(function(){return f(Object.preventExtensions({}))}),s=function(t){u(t,e,{value:{i:"O"+ ++c,w:{}}})},l=function(t,n){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,e)){if(!f(t))return"F";if(!n)return"E";s(t)}return t[e].i},h=function(t,n){if(!o(t,e)){if(!f(t))return!0;if(!n)return!1;s(t)}return t[e].w},v=function(t){return a&&p.NEED&&f(t)&&!o(t,e)&&s(t),t},p=t.exports={KEY:e,NEED:!1,fastKey:l,getWeak:h,onFreeze:v}},function(t,n,r){var e=r(14),i=r(20),o=r(19);t.exports=r(12)?Object.defineProperties:function(t,n){i(t);for(var r,u=o(n),c=u.length,f=0;c>f;)e.f(t,r=u[f++],n[r]);return t}},function(t,n,r){var e=r(37),i=r(22),o=r(9),u=r(42),c=r(8),f=r(58),a=Object.getOwnPropertyDescriptor;n.f=r(12)?a:function(t,n){if(t=o(t),n=u(n,!0),f)try{return a(t,n)}catch(t){}if(c(t,n))return i(!e.f.call(t,n),t[n])}},function(t,n,r){var e=r(9),i=r(61).f,o={}.toString,u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],c=function(t){try{return i(t)}catch(t){return u.slice()}};t.exports.f=function(t){return u&&"[object Window]"==o.call(t)?c(t):i(e(t))}},function(t,n,r){var e=r(8),i=r(77),o=r(39)("IE_PROTO"),u=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),e(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,n,r){var e=r(41),i=r(33);t.exports=function(t){return function(n,r){var o,u,c=String(i(n)),f=e(r),a=c.length;return f<0||f>=a?t?"":void 0:(o=c.charCodeAt(f),o<55296||o>56319||f+1===a||(u=c.charCodeAt(f+1))<56320||u>57343?t?c.charAt(f):o:t?c.slice(f,f+2):u-56320+(o-55296<<10)+65536)}}},function(t,n,r){var e=r(41),i=Math.max,o=Math.min;t.exports=function(t,n){return t=e(t),t<0?i(t+n,0):o(t,n)}},function(t,n,r){var e=r(41),i=Math.min;t.exports=function(t){return t>0?i(e(t),9007199254740991):0}},function(t,n,r){"use strict";var e=r(89),i=r(97),o=r(35),u=r(9);t.exports=r(59)(Array,"Array",function(t,n){this._t=u(t),this._i=0,this._k=n},function(){var t=this._t,n=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,i(1)):"keys"==n?i(0,r):"values"==n?i(0,t[r]):i(0,[r,t[r]])},"values"),o.Arguments=o.Array,e("keys"),e("values"),e("entries")},function(t,n){},function(t,n,r){"use strict";var e=r(104)(!0);r(59)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,r=this._i;return r>=n.length?{value:void 0,done:!0}:(t=e(n,r),this._i+=t.length,{value:t,done:!1})})},function(t,n,r){"use strict";var e=r(5),i=r(8),o=r(12),u=r(51),c=r(64),f=r(99).KEY,a=r(18),s=r(40),l=r(38),h=r(23),v=r(15),p=r(44),d=r(43),y=r(98),g=r(92),b=r(95),m=r(20),x=r(9),w=r(42),S=r(22),_=r(60),O=r(102),E=r(101),P=r(14),j=r(19),F=E.f,M=P.f,A=O.f,N=e.Symbol,T=e.JSON,I=T&&T.stringify,k="prototype",L=v("_hidden"),R=v("toPrimitive"),C={}.propertyIsEnumerable,D=s("symbol-registry"),U=s("symbols"),W=s("op-symbols"),G=Object[k],B="function"==typeof N,V=e.QObject,z=!V||!V[k]||!V[k].findChild,q=o&&a(function(){return 7!=_(M({},"a",{get:function(){return M(this,"a",{value:7}).a}})).a})?function(t,n,r){var e=F(G,n);e&&delete G[n],M(t,n,r),e&&t!==G&&M(G,n,e)}:M,K=function(t){var n=U[t]=_(N[k]);return n._k=t,n},J=B&&"symbol"==typeof N.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof N},Y=function(t,n,r){return t===G&&Y(W,n,r),m(t),n=w(n,!0),m(r),i(U,n)?(r.enumerable?(i(t,L)&&t[L][n]&&(t[L][n]=!1),r=_(r,{enumerable:S(0,!1)})):(i(t,L)||M(t,L,S(1,{})),t[L][n]=!0),q(t,n,r)):M(t,n,r)},H=function(t,n){m(t);for(var r,e=g(n=x(n)),i=0,o=e.length;o>i;)Y(t,r=e[i++],n[r]);return t},$=function(t,n){return void 0===n?_(t):H(_(t),n)},X=function(t){var n=C.call(this,t=w(t,!0));return!(this===G&&i(U,t)&&!i(W,t))&&(!(n||!i(this,t)||!i(U,t)||i(this,L)&&this[L][t])||n)},Q=function(t,n){if(t=x(t),n=w(n,!0),t!==G||!i(U,n)||i(W,n)){var r=F(t,n);return!r||!i(U,n)||i(t,L)&&t[L][n]||(r.enumerable=!0),r}},Z=function(t){for(var n,r=A(x(t)),e=[],o=0;r.length>o;)i(U,n=r[o++])||n==L||n==f||e.push(n);return e},tt=function(t){for(var n,r=t===G,e=A(r?W:x(t)),o=[],u=0;e.length>u;)!i(U,n=e[u++])||r&&!i(G,n)||o.push(U[n]);return o};B||(N=function(){if(this instanceof N)throw TypeError("Symbol is not a constructor!");var t=h(arguments.length>0?arguments[0]:void 0),n=function(r){this===G&&n.call(W,r),i(this,L)&&i(this[L],t)&&(this[L][t]=!1),q(this,t,S(1,r))};return o&&z&&q(G,t,{configurable:!0,set:n}),K(t)},c(N[k],"toString",function(){return this._k}),E.f=Q,P.f=Y,r(61).f=O.f=Z,r(37).f=X,r(62).f=tt,o&&!r(36)&&c(G,"propertyIsEnumerable",X,!0),p.f=function(t){return K(v(t))}),u(u.G+u.W+u.F*!B,{Symbol:N});for(var nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),rt=0;nt.length>rt;)v(nt[rt++]);for(var nt=j(v.store),rt=0;nt.length>rt;)d(nt[rt++]);u(u.S+u.F*!B,"Symbol",{for:function(t){return i(D,t+="")?D[t]:D[t]=N(t)},keyFor:function(t){if(J(t))return y(D,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){z=!0},useSimple:function(){z=!1}}),u(u.S+u.F*!B,"Object",{create:$,defineProperty:Y,defineProperties:H,getOwnPropertyDescriptor:Q,getOwnPropertyNames:Z,getOwnPropertySymbols:tt}),T&&u(u.S+u.F*(!B||a(function(){var t=N();return"[null]"!=I([t])||"{}"!=I({a:t})||"{}"!=I(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!J(t)){for(var n,r,e=[t],i=1;arguments.length>i;)e.push(arguments[i++]);return n=e[1],"function"==typeof n&&(r=n),!r&&b(n)||(n=function(t,n){if(r&&(n=r.call(this,t,n)),!J(n))return n}),e[1]=n,I.apply(T,e)}}}),N[k][R]||r(13)(N[k],R,N[k].valueOf),l(N,"Symbol"),l(Math,"Math",!0),l(e.JSON,"JSON",!0)},function(t,n,r){r(43)("asyncIterator")},function(t,n,r){r(43)("observable")},function(t,n,r){r(107);for(var e=r(5),i=r(13),o=r(35),u=r(15)("toStringTag"),c=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],f=0;f<5;f++){var a=c[f],s=e[a],l=s&&s.prototype;l&&!l[u]&&i(l,u,a),o[a]=o.Array}},function(t,n,r){var e=r(45),i=r(7)("toStringTag"),o="Arguments"==e(function(){return arguments}()),u=function(t,n){try{return t[n]}catch(t){}};t.exports=function(t){var n,r,c;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=u(n=Object(t),i))?r:o?e(n):"Object"==(c=e(n))&&"function"==typeof n.callee?"Arguments":c}},function(t,n,r){var e=r(45);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==e(t)?t.split(""):Object(t)}},function(t,n){n.f={}.propertyIsEnumerable},function(t,n,r){var e=r(30),i=r(16),o=r(75);t.exports=function(t){return function(n,r,u){var c,f=e(n),a=i(f.length),s=o(u,a);if(t&&r!=r){for(;a>s;)if((c=f[s++])!=c)return!0}else for(;a>s;s++)if((t||s in f)&&f[s]===r)return t||s||0;return!t&&-1}}},function(t,n,r){"use strict";var e=r(3),i=r(1),o=r(28),u=r(73),c=r(65),f=r(79),a=r(68),s=r(6),l=r(4),h=r(123),v=r(81),p=r(136);t.exports=function(t,n,r,d,y,g){var b=e[t],m=b,x=y?"set":"add",w=m&&m.prototype,S={},_=function(t){var n=w[t];o(w,t,"delete"==t?function(t){return!(g&&!s(t))&&n.call(this,0===t?0:t)}:"has"==t?function(t){return!(g&&!s(t))&&n.call(this,0===t?0:t)}:"get"==t?function(t){return g&&!s(t)?void 0:n.call(this,0===t?0:t)}:"add"==t?function(t){return n.call(this,0===t?0:t),this}:function(t,r){return n.call(this,0===t?0:t,r),this})};if("function"==typeof m&&(g||w.forEach&&!l(function(){(new m).entries().next()}))){var O=new m,E=O[x](g?{}:-0,1)!=O,P=l(function(){O.has(1)}),j=h(function(t){new m(t)}),F=!g&&l(function(){for(var t=new m,n=5;n--;)t[x](n,n);return!t.has(-0)});j||(m=n(function(n,r){a(n,m,t);var e=p(new b,n,m);return void 0!=r&&f(r,y,e[x],e),e}),m.prototype=w,w.constructor=m),(P||F)&&(_("delete"),_("has"),y&&_("get")),(F||E)&&_(x),g&&w.clear&&delete w.clear}else m=d.getConstructor(n,t,y,x),u(m.prototype,r),c.NEED=!0;return v(m,t),S[t]=m,i(i.G+i.W+i.F*(m!=b),S),g||d.setStrong(m,t,y),m}},function(t,n,r){"use strict";var e=r(27),i=r(28),o=r(4),u=r(46),c=r(7);t.exports=function(t,n,r){var f=c(t),a=r(u,f,""[t]),s=a[0],l=a[1];o(function(){var n={};return n[f]=function(){return 7},7!=""[t](n)})&&(i(String.prototype,t,s),e(RegExp.prototype,f,2==n?function(t,n){return l.call(t,this,n)}:function(t){return l.call(t,this)}))}
},function(t,n,r){"use strict";var e=r(2);t.exports=function(){var t=e(this),n="";return t.global&&(n+="g"),t.ignoreCase&&(n+="i"),t.multiline&&(n+="m"),t.unicode&&(n+="u"),t.sticky&&(n+="y"),n}},function(t,n){t.exports=function(t,n,r){var e=void 0===r;switch(n.length){case 0:return e?t():t.call(r);case 1:return e?t(n[0]):t.call(r,n[0]);case 2:return e?t(n[0],n[1]):t.call(r,n[0],n[1]);case 3:return e?t(n[0],n[1],n[2]):t.call(r,n[0],n[1],n[2]);case 4:return e?t(n[0],n[1],n[2],n[3]):t.call(r,n[0],n[1],n[2],n[3])}return t.apply(r,n)}},function(t,n,r){var e=r(6),i=r(45),o=r(7)("match");t.exports=function(t){var n;return e(t)&&(void 0!==(n=t[o])?!!n:"RegExp"==i(t))}},function(t,n,r){var e=r(7)("iterator"),i=!1;try{var o=[7][e]();o.return=function(){i=!0},Array.from(o,function(){throw 2})}catch(t){}t.exports=function(t,n){if(!n&&!i)return!1;var r=!1;try{var o=[7],u=o[e]();u.next=function(){return{done:r=!0}},o[e]=function(){return u},t(o)}catch(t){}return r}},function(t,n,r){t.exports=r(69)||!r(4)(function(){var t=Math.random();__defineSetter__.call(null,t,function(){}),delete r(3)[t]})},function(t,n){n.f=Object.getOwnPropertySymbols},function(t,n,r){var e=r(3),i="__core-js_shared__",o=e[i]||(e[i]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,n,r){for(var e,i=r(3),o=r(27),u=r(76),c=u("typed_array"),f=u("view"),a=!(!i.ArrayBuffer||!i.DataView),s=a,l=0,h="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");l<9;)(e=i[h[l++]])?(o(e.prototype,c,!0),o(e.prototype,f,!0)):s=!1;t.exports={ABV:a,CONSTR:s,TYPED:c,VIEW:f}},function(t,n){"use strict";var r={versions:function(){var t=window.navigator.userAgent;return{trident:t.indexOf("Trident")>-1,presto:t.indexOf("Presto")>-1,webKit:t.indexOf("AppleWebKit")>-1,gecko:t.indexOf("Gecko")>-1&&-1==t.indexOf("KHTML"),mobile:!!t.match(/AppleWebKit.*Mobile.*/),ios:!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:t.indexOf("Android")>-1||t.indexOf("Linux")>-1,iPhone:t.indexOf("iPhone")>-1||t.indexOf("Mac")>-1,iPad:t.indexOf("iPad")>-1,webApp:-1==t.indexOf("Safari"),weixin:-1==t.indexOf("MicroMessenger")}}()};t.exports=r},function(t,n,r){"use strict";var e=r(85),i=function(t){return t&&t.__esModule?t:{default:t}}(e),o=function(){function t(t,n,e){return n||e?String.fromCharCode(n||e):r[t]||t}function n(t){return e[t]}var r={"&quot;":'"',"&lt;":"<","&gt;":">","&amp;":"&","&nbsp;":" "},e={};for(var u in r)e[r[u]]=u;return r["&apos;"]="'",e["'"]="&#39;",{encode:function(t){return t?(""+t).replace(/['<> "&]/g,n).replace(/\r?\n/g,"<br/>").replace(/\s/g,"&nbsp;"):""},decode:function(n){return n?(""+n).replace(/<br\s*\/?>/gi,"\n").replace(/&quot;|&lt;|&gt;|&amp;|&nbsp;|&apos;|&#(\d+);|&#(\d+)/g,t).replace(/\u00a0/g," "):""},encodeBase16:function(t){if(!t)return t;t+="";for(var n=[],r=0,e=t.length;e>r;r++)n.push(t.charCodeAt(r).toString(16).toUpperCase());return n.join("")},encodeBase16forJSON:function(t){if(!t)return t;t=t.replace(/[\u4E00-\u9FBF]/gi,function(t){return escape(t).replace("%u","\\u")});for(var n=[],r=0,e=t.length;e>r;r++)n.push(t.charCodeAt(r).toString(16).toUpperCase());return n.join("")},decodeBase16:function(t){if(!t)return t;t+="";for(var n=[],r=0,e=t.length;e>r;r+=2)n.push(String.fromCharCode("0x"+t.slice(r,r+2)));return n.join("")},encodeObject:function(t){if(t instanceof Array)for(var n=0,r=t.length;r>n;n++)t[n]=o.encodeObject(t[n]);else if("object"==(void 0===t?"undefined":(0,i.default)(t)))for(var e in t)t[e]=o.encodeObject(t[e]);else if("string"==typeof t)return o.encode(t);return t},loadScript:function(t){var n=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(n),n.setAttribute("src",t)},addLoadEvent:function(t){var n=window.onload;"function"!=typeof window.onload?window.onload=t:window.onload=function(){n(),t()}}}}();t.exports=o},function(t,n,r){"use strict";var e=r(17),i=r(75),o=r(16);t.exports=function(t){for(var n=e(this),r=o(n.length),u=arguments.length,c=i(u>1?arguments[1]:void 0,r),f=u>2?arguments[2]:void 0,a=void 0===f?r:i(f,r);a>c;)n[c++]=t;return n}},function(t,n,r){"use strict";var e=r(11),i=r(66);t.exports=function(t,n,r){n in t?e.f(t,n,i(0,r)):t[n]=r}},function(t,n,r){var e=r(6),i=r(3).document,o=e(i)&&e(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,n){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,n,r){var e=r(7)("match");t.exports=function(t){var n=/./;try{"/./"[t](n)}catch(r){try{return n[e]=!1,!"/./"[t](n)}catch(t){}}return!0}},function(t,n,r){t.exports=r(3).document&&document.documentElement},function(t,n,r){var e=r(6),i=r(144).set;t.exports=function(t,n,r){var o,u=n.constructor;return u!==r&&"function"==typeof u&&(o=u.prototype)!==r.prototype&&e(o)&&i&&i(t,o),t}},function(t,n,r){var e=r(80),i=r(7)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(e.Array===t||o[i]===t)}},function(t,n,r){var e=r(45);t.exports=Array.isArray||function(t){return"Array"==e(t)}},function(t,n,r){"use strict";var e=r(70),i=r(66),o=r(81),u={};r(27)(u,r(7)("iterator"),function(){return this}),t.exports=function(t,n,r){t.prototype=e(u,{next:i(1,r)}),o(t,n+" Iterator")}},function(t,n,r){"use strict";var e=r(69),i=r(1),o=r(28),u=r(27),c=r(24),f=r(80),a=r(139),s=r(81),l=r(32),h=r(7)("iterator"),v=!([].keys&&"next"in[].keys()),p="keys",d="values",y=function(){return this};t.exports=function(t,n,r,g,b,m,x){a(r,n,g);var w,S,_,O=function(t){if(!v&&t in F)return F[t];switch(t){case p:case d:return function(){return new r(this,t)}}return function(){return new r(this,t)}},E=n+" Iterator",P=b==d,j=!1,F=t.prototype,M=F[h]||F["@@iterator"]||b&&F[b],A=M||O(b),N=b?P?O("entries"):A:void 0,T="Array"==n?F.entries||M:M;if(T&&(_=l(T.call(new t)))!==Object.prototype&&(s(_,E,!0),e||c(_,h)||u(_,h,y)),P&&M&&M.name!==d&&(j=!0,A=function(){return M.call(this)}),e&&!x||!v&&!j&&F[h]||u(F,h,A),f[n]=A,f[E]=y,b)if(w={values:P?A:O(d),keys:m?A:O(p),entries:N},x)for(S in w)S in F||o(F,S,w[S]);else i(i.P+i.F*(v||j),n,w);return w}},function(t,n){var r=Math.expm1;t.exports=!r||r(10)>22025.465794806718||r(10)<22025.465794806718||-2e-17!=r(-2e-17)?function(t){return 0==(t=+t)?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:r},function(t,n){t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},function(t,n,r){var e=r(3),i=r(151).set,o=e.MutationObserver||e.WebKitMutationObserver,u=e.process,c=e.Promise,f="process"==r(45)(u);t.exports=function(){var t,n,r,a=function(){var e,i;for(f&&(e=u.domain)&&e.exit();t;){i=t.fn,t=t.next;try{i()}catch(e){throw t?r():n=void 0,e}}n=void 0,e&&e.enter()};if(f)r=function(){u.nextTick(a)};else if(o){var s=!0,l=document.createTextNode("");new o(a).observe(l,{characterData:!0}),r=function(){l.data=s=!s}}else if(c&&c.resolve){var h=c.resolve();r=function(){h.then(a)}}else r=function(){i.call(e,a)};return function(e){var i={fn:e,next:void 0};n&&(n.next=i),t||(t=i,r()),n=i}}},function(t,n,r){var e=r(6),i=r(2),o=function(t,n){if(i(t),!e(n)&&null!==n)throw TypeError(n+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,n,e){try{e=r(53)(Function.call,r(31).f(Object.prototype,"__proto__").set,2),e(t,[]),n=!(t instanceof Array)}catch(t){n=!0}return function(t,r){return o(t,r),n?t.__proto__=r:e(t,r),t}}({},!1):void 0),check:o}},function(t,n,r){var e=r(126)("keys"),i=r(76);t.exports=function(t){return e[t]||(e[t]=i(t))}},function(t,n,r){var e=r(2),i=r(26),o=r(7)("species");t.exports=function(t,n){var r,u=e(t).constructor;return void 0===u||void 0==(r=e(u)[o])?n:i(r)}},function(t,n,r){var e=r(67),i=r(46);t.exports=function(t){return function(n,r){var o,u,c=String(i(n)),f=e(r),a=c.length;return f<0||f>=a?t?"":void 0:(o=c.charCodeAt(f),o<55296||o>56319||f+1===a||(u=c.charCodeAt(f+1))<56320||u>57343?t?c.charAt(f):o:t?c.slice(f,f+2):u-56320+(o-55296<<10)+65536)}}},function(t,n,r){var e=r(122),i=r(46);t.exports=function(t,n,r){if(e(n))throw TypeError("String#"+r+" doesn't accept regex!");return String(i(t))}},function(t,n,r){"use strict";var e=r(67),i=r(46);t.exports=function(t){var n=String(i(this)),r="",o=e(t);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(n+=n))1&o&&(r+=n);return r}},function(t,n){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(t,n,r){var e,i,o,u=r(53),c=r(121),f=r(135),a=r(132),s=r(3),l=s.process,h=s.setImmediate,v=s.clearImmediate,p=s.MessageChannel,d=0,y={},g="onreadystatechange",b=function(){var t=+this;if(y.hasOwnProperty(t)){var n=y[t];delete y[t],n()}},m=function(t){b.call(t.data)};h&&v||(h=function(t){for(var n=[],r=1;arguments.length>r;)n.push(arguments[r++]);return y[++d]=function(){c("function"==typeof t?t:Function(t),n)},e(d),d},v=function(t){delete y[t]},"process"==r(45)(l)?e=function(t){l.nextTick(u(b,t,1))}:p?(i=new p,o=i.port2,i.port1.onmessage=m,e=u(o.postMessage,o,1)):s.addEventListener&&"function"==typeof postMessage&&!s.importScripts?(e=function(t){s.postMessage(t+"","*")},s.addEventListener("message",m,!1)):e=g in a("script")?function(t){f.appendChild(a("script"))[g]=function(){f.removeChild(this),b.call(t)}}:function(t){setTimeout(u(b,t,1),0)}),t.exports={set:h,clear:v}},function(t,n,r){"use strict";var e=r(3),i=r(10),o=r(69),u=r(127),c=r(27),f=r(73),a=r(4),s=r(68),l=r(67),h=r(16),v=r(71).f,p=r(11).f,d=r(130),y=r(81),g="ArrayBuffer",b="DataView",m="prototype",x="Wrong length!",w="Wrong index!",S=e[g],_=e[b],O=e.Math,E=e.RangeError,P=e.Infinity,j=S,F=O.abs,M=O.pow,A=O.floor,N=O.log,T=O.LN2,I="buffer",k="byteLength",L="byteOffset",R=i?"_b":I,C=i?"_l":k,D=i?"_o":L,U=function(t,n,r){var e,i,o,u=Array(r),c=8*r-n-1,f=(1<<c)-1,a=f>>1,s=23===n?M(2,-24)-M(2,-77):0,l=0,h=t<0||0===t&&1/t<0?1:0;for(t=F(t),t!=t||t===P?(i=t!=t?1:0,e=f):(e=A(N(t)/T),t*(o=M(2,-e))<1&&(e--,o*=2),t+=e+a>=1?s/o:s*M(2,1-a),t*o>=2&&(e++,o/=2),e+a>=f?(i=0,e=f):e+a>=1?(i=(t*o-1)*M(2,n),e+=a):(i=t*M(2,a-1)*M(2,n),e=0));n>=8;u[l++]=255&i,i/=256,n-=8);for(e=e<<n|i,c+=n;c>0;u[l++]=255&e,e/=256,c-=8);return u[--l]|=128*h,u},W=function(t,n,r){var e,i=8*r-n-1,o=(1<<i)-1,u=o>>1,c=i-7,f=r-1,a=t[f--],s=127&a;for(a>>=7;c>0;s=256*s+t[f],f--,c-=8);for(e=s&(1<<-c)-1,s>>=-c,c+=n;c>0;e=256*e+t[f],f--,c-=8);if(0===s)s=1-u;else{if(s===o)return e?NaN:a?-P:P;e+=M(2,n),s-=u}return(a?-1:1)*e*M(2,s-n)},G=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},B=function(t){return[255&t]},V=function(t){return[255&t,t>>8&255]},z=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},q=function(t){return U(t,52,8)},K=function(t){return U(t,23,4)},J=function(t,n,r){p(t[m],n,{get:function(){return this[r]}})},Y=function(t,n,r,e){var i=+r,o=l(i);if(i!=o||o<0||o+n>t[C])throw E(w);var u=t[R]._b,c=o+t[D],f=u.slice(c,c+n);return e?f:f.reverse()},H=function(t,n,r,e,i,o){var u=+r,c=l(u);if(u!=c||c<0||c+n>t[C])throw E(w);for(var f=t[R]._b,a=c+t[D],s=e(+i),h=0;h<n;h++)f[a+h]=s[o?h:n-h-1]},$=function(t,n){s(t,S,g);var r=+n,e=h(r);if(r!=e)throw E(x);return e};if(u.ABV){if(!a(function(){new S})||!a(function(){new S(.5)})){S=function(t){return new j($(this,t))};for(var X,Q=S[m]=j[m],Z=v(j),tt=0;Z.length>tt;)(X=Z[tt++])in S||c(S,X,j[X]);o||(Q.constructor=S)}var nt=new _(new S(2)),rt=_[m].setInt8;nt.setInt8(0,2147483648),nt.setInt8(1,2147483649),!nt.getInt8(0)&&nt.getInt8(1)||f(_[m],{setInt8:function(t,n){rt.call(this,t,n<<24>>24)},setUint8:function(t,n){rt.call(this,t,n<<24>>24)}},!0)}else S=function(t){var n=$(this,t);this._b=d.call(Array(n),0),this[C]=n},_=function(t,n,r){s(this,_,b),s(t,S,b);var e=t[C],i=l(n);if(i<0||i>e)throw E("Wrong offset!");if(r=void 0===r?e-i:h(r),i+r>e)throw E(x);this[R]=t,this[D]=i,this[C]=r},i&&(J(S,k,"_l"),J(_,I,"_b"),J(_,k,"_l"),J(_,L,"_o")),f(_[m],{getInt8:function(t){return Y(this,1,t)[0]<<24>>24},getUint8:function(t){return Y(this,1,t)[0]},getInt16:function(t){var n=Y(this,2,t,arguments[1]);return(n[1]<<8|n[0])<<16>>16},getUint16:function(t){var n=Y(this,2,t,arguments[1]);return n[1]<<8|n[0]},getInt32:function(t){return G(Y(this,4,t,arguments[1]))},getUint32:function(t){return G(Y(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return W(Y(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return W(Y(this,8,t,arguments[1]),52,8)},setInt8:function(t,n){H(this,1,t,B,n)},setUint8:function(t,n){H(this,1,t,B,n)},setInt16:function(t,n){H(this,2,t,V,n,arguments[2])},setUint16:function(t,n){H(this,2,t,V,n,arguments[2])},setInt32:function(t,n){H(this,4,t,z,n,arguments[2])},setUint32:function(t,n){H(this,4,t,z,n,arguments[2])},setFloat32:function(t,n){H(this,4,t,K,n,arguments[2])},setFloat64:function(t,n){H(this,8,t,q,n,arguments[2])}});y(S,g),y(_,b),c(_[m],u.VIEW,!0),n[g]=S,n[b]=_},function(t,n,r){var e=r(3),i=r(52),o=r(69),u=r(182),c=r(11).f;t.exports=function(t){var n=i.Symbol||(i.Symbol=o?{}:e.Symbol||{});"_"==t.charAt(0)||t in n||c(n,t,{value:u.f(t)})}},function(t,n,r){var e=r(114),i=r(7)("iterator"),o=r(80);t.exports=r(52).getIteratorMethod=function(t){if(void 0!=t)return t[i]||t["@@iterator"]||o[e(t)]}},function(t,n,r){"use strict";var e=r(78),i=r(170),o=r(80),u=r(30);t.exports=r(140)(Array,"Array",function(t,n){this._t=u(t),this._i=0,this._k=n},function(){var t=this._t,n=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,i(1)):"keys"==n?i(0,r):"values"==n?i(0,t[r]):i(0,[r,t[r]])},"values"),o.Arguments=o.Array,e("keys"),e("values"),e("entries")},function(t,n){function r(t,n){t.classList?t.classList.add(n):t.className+=" "+n}t.exports=r},function(t,n){function r(t,n){if(t.classList)t.classList.remove(n);else{var r=new RegExp("(^|\\b)"+n.split(" ").join("|")+"(\\b|$)","gi");t.className=t.className.replace(r," ")}}t.exports=r},function(t,n){function r(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}function i(t){if(s===setTimeout)return setTimeout(t,0);if((s===r||!s)&&setTimeout)return s=setTimeout,setTimeout(t,0);try{return s(t,0)}catch(n){try{return s.call(null,t,0)}catch(n){return s.call(this,t,0)}}}function o(t){if(l===clearTimeout)return clearTimeout(t);if((l===e||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(t);try{return l(t)}catch(n){try{return l.call(null,t)}catch(n){return l.call(this,t)}}}function u(){d&&v&&(d=!1,v.length?p=v.concat(p):y=-1,p.length&&c())}function c(){if(!d){var t=i(u);d=!0;for(var n=p.length;n;){for(v=p,p=[];++y<n;)v&&v[y].run();y=-1,n=p.length}v=null,d=!1,o(t)}}function f(t,n){this.fun=t,this.array=n}function a(){}var s,l,h=t.exports={};!function(){try{s="function"==typeof setTimeout?setTimeout:r}catch(t){s=r}try{l="function"==typeof clearTimeout?clearTimeout:e}catch(t){l=e}}();var v,p=[],d=!1,y=-1;h.nextTick=function(t){var n=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)n[r-1]=arguments[r];p.push(new f(t,n)),1!==p.length||d||i(c)},f.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=a,h.addListener=a,h.once=a,h.off=a,h.removeListener=a,h.removeAllListeners=a,h.emit=a,h.prependListener=a,h.prependOnceListener=a,h.listeners=function(t){return[]},h.binding=function(t){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(t){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(t,n,r){var e=r(45);t.exports=function(t,n){if("number"!=typeof t&&"Number"!=e(t))throw TypeError(n);return+t}},function(t,n,r){"use strict";var e=r(17),i=r(75),o=r(16);t.exports=[].copyWithin||function(t,n){var r=e(this),u=o(r.length),c=i(t,u),f=i(n,u),a=arguments.length>2?arguments[2]:void 0,s=Math.min((void 0===a?u:i(a,u))-f,u-c),l=1;for(f<c&&c<f+s&&(l=-1,f+=s-1,c+=s-1);s-- >0;)f in r?r[c]=r[f]:delete r[c],c+=l,f+=l;return r}},function(t,n,r){var e=r(79);t.exports=function(t,n){var r=[];return e(t,!1,r.push,r,n),r}},function(t,n,r){var e=r(26),i=r(17),o=r(115),u=r(16);t.exports=function(t,n,r,c,f){e(n);var a=i(t),s=o(a),l=u(a.length),h=f?l-1:0,v=f?-1:1;if(r<2)for(;;){if(h in s){c=s[h],h+=v;break}if(h+=v,f?h<0:l<=h)throw TypeError("Reduce of empty array with no initial value")}for(;f?h>=0:l>h;h+=v)h in s&&(c=n(c,s[h],h,a));return c}},function(t,n,r){"use strict";var e=r(26),i=r(6),o=r(121),u=[].slice,c={},f=function(t,n,r){if(!(n in c)){for(var e=[],i=0;i<n;i++)e[i]="a["+i+"]";c[n]=Function("F,a","return new F("+e.join(",")+")")}return c[n](t,r)};t.exports=Function.bind||function(t){var n=e(this),r=u.call(arguments,1),c=function(){var e=r.concat(u.call(arguments));return this instanceof c?f(n,e.length,e):o(n,e,t)};return i(n.prototype)&&(c.prototype=n.prototype),c}},function(t,n,r){"use strict";var e=r(11).f,i=r(70),o=r(73),u=r(53),c=r(68),f=r(46),a=r(79),s=r(140),l=r(170),h=r(74),v=r(10),p=r(65).fastKey,d=v?"_s":"size",y=function(t,n){var r,e=p(n);if("F"!==e)return t._i[e];for(r=t._f;r;r=r.n)if(r.k==n)return r};t.exports={getConstructor:function(t,n,r,s){var l=t(function(t,e){c(t,l,n,"_i"),t._i=i(null),t._f=void 0,t._l=void 0,t[d]=0,void 0!=e&&a(e,r,t[s],t)});return o(l.prototype,{clear:function(){for(var t=this,n=t._i,r=t._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];t._f=t._l=void 0,t[d]=0},delete:function(t){var n=this,r=y(n,t);if(r){var e=r.n,i=r.p;delete n._i[r.i],r.r=!0,i&&(i.n=e),e&&(e.p=i),n._f==r&&(n._f=e),n._l==r&&(n._l=i),n[d]--}return!!r},forEach:function(t){c(this,l,"forEach");for(var n,r=u(t,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!y(this,t)}}),v&&e(l.prototype,"size",{get:function(){return f(this[d])}}),l},def:function(t,n,r){var e,i,o=y(t,n);return o?o.v=r:(t._l=o={i:i=p(n,!0),k:n,v:r,p:e=t._l,n:void 0,r:!1},t._f||(t._f=o),e&&(e.n=o),t[d]++,"F"!==i&&(t._i[i]=o)),t},getEntry:y,setStrong:function(t,n,r){s(t,n,function(t,n){this._t=t,this._k=n,this._l=void 0},function(){for(var t=this,n=t._k,r=t._l;r&&r.r;)r=r.p;return t._t&&(t._l=r=r?r.n:t._t._f)?"keys"==n?l(0,r.k):"values"==n?l(0,r.v):l(0,[r.k,r.v]):(t._t=void 0,l(1))},r?"entries":"values",!r,!0),h(n)}}},function(t,n,r){var e=r(114),i=r(161);t.exports=function(t){return function(){if(e(this)!=t)throw TypeError(t+"#toJSON isn't generic");return i(this)}}},function(t,n,r){"use strict";var e=r(73),i=r(65).getWeak,o=r(2),u=r(6),c=r(68),f=r(79),a=r(48),s=r(24),l=a(5),h=a(6),v=0,p=function(t){return t._l||(t._l=new d)},d=function(){this.a=[]},y=function(t,n){return l(t.a,function(t){return t[0]===n})};d.prototype={get:function(t){var n=y(this,t);if(n)return n[1]},has:function(t){return!!y(this,t)},set:function(t,n){var r=y(this,t);r?r[1]=n:this.a.push([t,n])},delete:function(t){var n=h(this.a,function(n){return n[0]===t});return~n&&this.a.splice(n,1),!!~n}},t.exports={getConstructor:function(t,n,r,o){var a=t(function(t,e){c(t,a,n,"_i"),t._i=v++,t._l=void 0,void 0!=e&&f(e,r,t[o],t)});return e(a.prototype,{delete:function(t){if(!u(t))return!1;var n=i(t);return!0===n?p(this).delete(t):n&&s(n,this._i)&&delete n[this._i]},has:function(t){if(!u(t))return!1;var n=i(t);return!0===n?p(this).has(t):n&&s(n,this._i)}}),a},def:function(t,n,r){var e=i(o(n),!0);return!0===e?p(t).set(n,r):e[t._i]=r,t},ufstore:p}},function(t,n,r){t.exports=!r(10)&&!r(4)(function(){return 7!=Object.defineProperty(r(132)("div"),"a",{get:function(){return 7}}).a})},function(t,n,r){var e=r(6),i=Math.floor;t.exports=function(t){return!e(t)&&isFinite(t)&&i(t)===t}},function(t,n,r){var e=r(2);t.exports=function(t,n,r,i){try{return i?n(e(r)[0],r[1]):n(r)}catch(n){var o=t.return;throw void 0!==o&&e(o.call(t)),n}}},function(t,n){t.exports=function(t,n){return{value:n,done:!!t}}},function(t,n){t.exports=Math.log1p||function(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},function(t,n,r){"use strict";var e=r(72),i=r(125),o=r(116),u=r(17),c=r(115),f=Object.assign;t.exports=!f||r(4)(function(){var t={},n={},r=Symbol(),e="abcdefghijklmnopqrst";return t[r]=7,e.split("").forEach(function(t){n[t]=t}),7!=f({},t)[r]||Object.keys(f({},n)).join("")!=e})?function(t,n){for(var r=u(t),f=arguments.length,a=1,s=i.f,l=o.f;f>a;)for(var h,v=c(arguments[a++]),p=s?e(v).concat(s(v)):e(v),d=p.length,y=0;d>y;)l.call(v,h=p[y++])&&(r[h]=v[h]);return r}:f},function(t,n,r){var e=r(11),i=r(2),o=r(72);t.exports=r(10)?Object.defineProperties:function(t,n){i(t);for(var r,u=o(n),c=u.length,f=0;c>f;)e.f(t,r=u[f++],n[r]);return t}},function(t,n,r){var e=r(30),i=r(71).f,o={}.toString,u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],c=function(t){try{return i(t)}catch(t){return u.slice()}};t.exports.f=function(t){return u&&"[object Window]"==o.call(t)?c(t):i(e(t))}},function(t,n,r){var e=r(24),i=r(30),o=r(117)(!1),u=r(145)("IE_PROTO");t.exports=function(t,n){var r,c=i(t),f=0,a=[];for(r in c)r!=u&&e(c,r)&&a.push(r);for(;n.length>f;)e(c,r=n[f++])&&(~o(a,r)||a.push(r));return a}},function(t,n,r){var e=r(72),i=r(30),o=r(116).f;t.exports=function(t){return function(n){for(var r,u=i(n),c=e(u),f=c.length,a=0,s=[];f>a;)o.call(u,r=c[a++])&&s.push(t?[r,u[r]]:u[r]);return s}}},function(t,n,r){var e=r(71),i=r(125),o=r(2),u=r(3).Reflect;t.exports=u&&u.ownKeys||function(t){var n=e.f(o(t)),r=i.f;return r?n.concat(r(t)):n}},function(t,n,r){var e=r(3).parseFloat,i=r(82).trim;t.exports=1/e(r(150)+"-0")!=-1/0?function(t){var n=i(String(t),3),r=e(n);return 0===r&&"-"==n.charAt(0)?-0:r}:e},function(t,n,r){var e=r(3).parseInt,i=r(82).trim,o=r(150),u=/^[\-+]?0[xX]/;t.exports=8!==e(o+"08")||22!==e(o+"0x16")?function(t,n){var r=i(String(t),3);return e(r,n>>>0||(u.test(r)?16:10))}:e},function(t,n){t.exports=Object.is||function(t,n){return t===n?0!==t||1/t==1/n:t!=t&&n!=n}},function(t,n,r){var e=r(16),i=r(149),o=r(46);t.exports=function(t,n,r,u){var c=String(o(t)),f=c.length,a=void 0===r?" ":String(r),s=e(n);if(s<=f||""==a)return c;var l=s-f,h=i.call(a,Math.ceil(l/a.length));return h.length>l&&(h=h.slice(0,l)),u?h+c:c+h}},function(t,n,r){n.f=r(7)},function(t,n,r){"use strict";var e=r(164);t.exports=r(118)("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var n=e.getEntry(this,t);return n&&n.v},set:function(t,n){return e.def(this,0===t?0:t,n)}},e,!0)},function(t,n,r){r(10)&&"g"!=/./g.flags&&r(11).f(RegExp.prototype,"flags",{configurable:!0,get:r(120)})},function(t,n,r){"use strict";var e=r(164);t.exports=r(118)("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return e.def(this,t=0===t?0:t,t)}},e)},function(t,n,r){"use strict";var e,i=r(48)(0),o=r(28),u=r(65),c=r(172),f=r(166),a=r(6),s=u.getWeak,l=Object.isExtensible,h=f.ufstore,v={},p=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},d={get:function(t){if(a(t)){var n=s(t);return!0===n?h(this).get(t):n?n[this._i]:void 0}},set:function(t,n){return f.def(this,t,n)}},y=t.exports=r(118)("WeakMap",p,d,f,!0,!0);7!=(new y).set((Object.freeze||Object)(v),7).get(v)&&(e=f.getConstructor(p),c(e.prototype,d),u.NEED=!0,i(["delete","has","get","set"],function(t){var n=y.prototype,r=n[t];o(n,t,function(n,i){if(a(n)&&!l(n)){this._f||(this._f=new e);var o=this._f[t](n,i);return"set"==t?this:o}return r.call(this,n,i)})}))},,,,function(t,n){"use strict";function r(){var t=document.querySelector("#page-nav");if(t&&!document.querySelector("#page-nav .extend.prev")&&(t.innerHTML='<a class="extend prev disabled" rel="prev">&laquo; Prev</a>'+t.innerHTML),t&&!document.querySelector("#page-nav .extend.next")&&(t.innerHTML=t.innerHTML+'<a class="extend next disabled" rel="next">Next &raquo;</a>'),yiliaConfig&&yiliaConfig.open_in_new){document.querySelectorAll(".article-entry a:not(.article-more-a)").forEach(function(t){var n=t.getAttribute("target");n&&""!==n||t.setAttribute("target","_blank")})}if(yiliaConfig&&yiliaConfig.toc_hide_index){document.querySelectorAll(".toc-number").forEach(function(t){t.style.display="none"})}var n=document.querySelector("#js-aboutme");n&&0!==n.length&&(n.innerHTML=n.innerText)}t.exports={init:r}},function(t,n,r){"use strict";function e(t){return t&&t.__esModule?t:{default:t}}function i(t,n){var r=/\/|index.html/g;return t.replace(r,"")===n.replace(r,"")}function o(){for(var t=document.querySelectorAll(".js-header-menu li a"),n=window.location.pathname,r=0,e=t.length;r<e;r++){var o=t[r];i(n,o.getAttribute("href"))&&(0,h.default)(o,"active")}}function u(t){for(var n=t.offsetLeft,r=t.offsetParent;null!==r;)n+=r.offsetLeft,r=r.offsetParent;return n}function c(t){for(var n=t.offsetTop,r=t.offsetParent;null!==r;)n+=r.offsetTop,r=r.offsetParent;return n}function f(t,n,r,e,i){var o=u(t),f=c(t)-n;if(f-r<=i){var a=t.$newDom;a||(a=t.cloneNode(!0),(0,d.default)(t,a),t.$newDom=a,a.style.position="fixed",a.style.top=(r||f)+"px",a.style.left=o+"px",a.style.zIndex=e||2,a.style.width="100%",a.style.color="#fff"),a.style.visibility="visible",t.style.visibility="hidden"}else{t.style.visibility="visible";var s=t.$newDom;s&&(s.style.visibility="hidden")}}function a(){var t=document.querySelector(".js-overlay"),n=document.querySelector(".js-header-menu");f(t,document.body.scrollTop,-63,2,0),f(n,document.body.scrollTop,1,3,0)}function s(){document.querySelector("#container").addEventListener("scroll",function(t){a()}),window.addEventListener("scroll",function(t){a()}),a()}var l=r(156),h=e(l),v=r(157),p=(e(v),r(382)),d=e(p),y=r(128),g=e(y),b=r(190),m=e(b),x=r(129);(function(){g.default.versions.mobile&&window.screen.width<800&&(o(),s())})(),(0,x.addLoadEvent)(function(){m.default.init()}),t.exports={}},,,,function(t,n,r){(function(t){"use strict";function n(t,n,r){t[n]||Object[e](t,n,{writable:!0,configurable:!0,value:r})}if(r(381),r(391),r(198),t._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");t._babelPolyfill=!0;var e="defineProperty";n(String.prototype,"padLeft","".padStart),n(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(t){[][t]&&n(Array,t,Function.call.bind([][t]))})}).call(n,function(){return this}())},,,function(t,n,r){r(210),t.exports=r(52).RegExp.escape},,,,function(t,n,r){var e=r(6),i=r(138),o=r(7)("species");t.exports=function(t){var n;return i(t)&&(n=t.constructor,"function"!=typeof n||n!==Array&&!i(n.prototype)||(n=void 0),e(n)&&null===(n=n[o])&&(n=void 0)),void 0===n?Array:n}},function(t,n,r){var e=r(202);t.exports=function(t,n){return new(e(t))(n)}},function(t,n,r){"use strict";var e=r(2),i=r(50),o="number";t.exports=function(t){if("string"!==t&&t!==o&&"default"!==t)throw TypeError("Incorrect hint");return i(e(this),t!=o)}},function(t,n,r){var e=r(72),i=r(125),o=r(116);t.exports=function(t){var n=e(t),r=i.f;if(r)for(var u,c=r(t),f=o.f,a=0;c.length>a;)f.call(t,u=c[a++])&&n.push(u);return n}},function(t,n,r){var e=r(72),i=r(30);t.exports=function(t,n){for(var r,o=i(t),u=e(o),c=u.length,f=0;c>f;)if(o[r=u[f++]]===n)return r}},function(t,n,r){"use strict";var e=r(208),i=r(121),o=r(26);t.exports=function(){for(var t=o(this),n=arguments.length,r=Array(n),u=0,c=e._,f=!1;n>u;)(r[u]=arguments[u++])===c&&(f=!0);return function(){var e,o=this,u=arguments.length,a=0,s=0;if(!f&&!u)return i(t,r,o);if(e=r.slice(),f)for(;n>a;a++)e[a]===c&&(e[a]=arguments[s++]);for(;u>s;)e.push(arguments[s++]);return i(t,e,o)}}},function(t,n,r){t.exports=r(3)},function(t,n){t.exports=function(t,n){var r=n===Object(n)?function(t){return n[t]}:n;return function(n){return String(n).replace(t,r)}}},function(t,n,r){var e=r(1),i=r(209)(/[\\^$*+?.()|[\]{}]/g,"\\$&");e(e.S,"RegExp",{escape:function(t){return i(t)}})},function(t,n,r){var e=r(1);e(e.P,"Array",{copyWithin:r(160)}),r(78)("copyWithin")},function(t,n,r){"use strict";var e=r(1),i=r(48)(4);e(e.P+e.F*!r(47)([].every,!0),"Array",{every:function(t){return i(this,t,arguments[1])}})},function(t,n,r){var e=r(1);e(e.P,"Array",{fill:r(130)}),r(78)("fill")},function(t,n,r){"use strict";var e=r(1),i=r(48)(2);e(e.P+e.F*!r(47)([].filter,!0),"Array",{filter:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(1),i=r(48)(6),o="findIndex",u=!0;o in[]&&Array(1)[o](function(){u=!1}),e(e.P+e.F*u,"Array",{findIndex:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(78)(o)},function(t,n,r){"use strict";var e=r(1),i=r(48)(5),o="find",u=!0;o in[]&&Array(1)[o](function(){u=!1}),e(e.P+e.F*u,"Array",{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(78)(o)},function(t,n,r){"use strict";var e=r(1),i=r(48)(0),o=r(47)([].forEach,!0);e(e.P+e.F*!o,"Array",{forEach:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(53),i=r(1),o=r(17),u=r(169),c=r(137),f=r(16),a=r(131),s=r(154);i(i.S+i.F*!r(123)(function(t){Array.from(t)}),"Array",{from:function(t){var n,r,i,l,h=o(t),v="function"==typeof this?this:Array,p=arguments.length,d=p>1?arguments[1]:void 0,y=void 0!==d,g=0,b=s(h);if(y&&(d=e(d,p>2?arguments[2]:void 0,2)),void 0==b||v==Array&&c(b))for(n=f(h.length),r=new v(n);n>g;g++)a(r,g,y?d(h[g],g):h[g]);else for(l=b.call(h),r=new v;!(i=l.next()).done;g++)a(r,g,y?u(l,d,[i.value,g],!0):i.value);return r.length=g,r}})},function(t,n,r){"use strict";var e=r(1),i=r(117)(!1),o=[].indexOf,u=!!o&&1/[1].indexOf(1,-0)<0;e(e.P+e.F*(u||!r(47)(o)),"Array",{indexOf:function(t){return u?o.apply(this,arguments)||0:i(this,t,arguments[1])}})},function(t,n,r){var e=r(1);e(e.S,"Array",{isArray:r(138)})},function(t,n,r){"use strict";var e=r(1),i=r(30),o=[].join;e(e.P+e.F*(r(115)!=Object||!r(47)(o)),"Array",{join:function(t){return o.call(i(this),void 0===t?",":t)}})},function(t,n,r){"use strict";var e=r(1),i=r(30),o=r(67),u=r(16),c=[].lastIndexOf,f=!!c&&1/[1].lastIndexOf(1,-0)<0;e(e.P+e.F*(f||!r(47)(c)),"Array",{lastIndexOf:function(t){if(f)return c.apply(this,arguments)||0;var n=i(this),r=u(n.length),e=r-1;for(arguments.length>1&&(e=Math.min(e,o(arguments[1]))),e<0&&(e=r+e);e>=0;e--)if(e in n&&n[e]===t)return e||0;return-1}})},function(t,n,r){"use strict";var e=r(1),i=r(48)(1);e(e.P+e.F*!r(47)([].map,!0),"Array",{map:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(1),i=r(131);e(e.S+e.F*r(4)(function(){function t(){}return!(Array.of.call(t)instanceof t)}),"Array",{of:function(){for(var t=0,n=arguments.length,r=new("function"==typeof this?this:Array)(n);n>t;)i(r,t,arguments[t++]);return r.length=n,r}})},function(t,n,r){"use strict";var e=r(1),i=r(162);e(e.P+e.F*!r(47)([].reduceRight,!0),"Array",{reduceRight:function(t){return i(this,t,arguments.length,arguments[1],!0)}})},function(t,n,r){"use strict";var e=r(1),i=r(162);e(e.P+e.F*!r(47)([].reduce,!0),"Array",{reduce:function(t){return i(this,t,arguments.length,arguments[1],!1)}})},function(t,n,r){"use strict";var e=r(1),i=r(135),o=r(45),u=r(75),c=r(16),f=[].slice;e(e.P+e.F*r(4)(function(){i&&f.call(i)}),"Array",{slice:function(t,n){var r=c(this.length),e=o(this);if(n=void 0===n?r:n,"Array"==e)return f.call(this,t,n);for(var i=u(t,r),a=u(n,r),s=c(a-i),l=Array(s),h=0;h<s;h++)l[h]="String"==e?this.charAt(i+h):this[i+h];return l}})},function(t,n,r){"use strict";var e=r(1),i=r(48)(3);e(e.P+e.F*!r(47)([].some,!0),"Array",{some:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(1),i=r(26),o=r(17),u=r(4),c=[].sort,f=[1,2,3];e(e.P+e.F*(u(function(){f.sort(void 0)})||!u(function(){f.sort(null)})||!r(47)(c)),"Array",{sort:function(t){return void 0===t?c.call(o(this)):c.call(o(this),i(t))}})},function(t,n,r){r(74)("Array")},function(t,n,r){var e=r(1);e(e.S,"Date",{now:function(){return(new Date).getTime()}})},function(t,n,r){"use strict";var e=r(1),i=r(4),o=Date.prototype.getTime,u=function(t){return t>9?t:"0"+t};e(e.P+e.F*(i(function(){return"0385-07-25T07:06:39.999Z"!=new Date(-5e13-1).toISOString()})||!i(function(){new Date(NaN).toISOString()})),"Date",{toISOString:function(){
if(!isFinite(o.call(this)))throw RangeError("Invalid time value");var t=this,n=t.getUTCFullYear(),r=t.getUTCMilliseconds(),e=n<0?"-":n>9999?"+":"";return e+("00000"+Math.abs(n)).slice(e?-6:-4)+"-"+u(t.getUTCMonth()+1)+"-"+u(t.getUTCDate())+"T"+u(t.getUTCHours())+":"+u(t.getUTCMinutes())+":"+u(t.getUTCSeconds())+"."+(r>99?r:"0"+u(r))+"Z"}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(50);e(e.P+e.F*r(4)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(t){var n=i(this),r=o(n);return"number"!=typeof r||isFinite(r)?n.toISOString():null}})},function(t,n,r){var e=r(7)("toPrimitive"),i=Date.prototype;e in i||r(27)(i,e,r(204))},function(t,n,r){var e=Date.prototype,i="Invalid Date",o="toString",u=e[o],c=e.getTime;new Date(NaN)+""!=i&&r(28)(e,o,function(){var t=c.call(this);return t===t?u.call(this):i})},function(t,n,r){var e=r(1);e(e.P,"Function",{bind:r(163)})},function(t,n,r){"use strict";var e=r(6),i=r(32),o=r(7)("hasInstance"),u=Function.prototype;o in u||r(11).f(u,o,{value:function(t){if("function"!=typeof this||!e(t))return!1;if(!e(this.prototype))return t instanceof this;for(;t=i(t);)if(this.prototype===t)return!0;return!1}})},function(t,n,r){var e=r(11).f,i=r(66),o=r(24),u=Function.prototype,c="name",f=Object.isExtensible||function(){return!0};c in u||r(10)&&e(u,c,{configurable:!0,get:function(){try{var t=this,n=(""+t).match(/^\s*function ([^ (]*)/)[1];return o(t,c)||!f(t)||e(t,c,i(5,n)),n}catch(t){return""}}})},function(t,n,r){var e=r(1),i=r(171),o=Math.sqrt,u=Math.acosh;e(e.S+e.F*!(u&&710==Math.floor(u(Number.MAX_VALUE))&&u(1/0)==1/0),"Math",{acosh:function(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:i(t-1+o(t-1)*o(t+1))}})},function(t,n,r){function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):Math.log(t+Math.sqrt(t*t+1)):t}var i=r(1),o=Math.asinh;i(i.S+i.F*!(o&&1/o(0)>0),"Math",{asinh:e})},function(t,n,r){var e=r(1),i=Math.atanh;e(e.S+e.F*!(i&&1/i(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},function(t,n,r){var e=r(1),i=r(142);e(e.S,"Math",{cbrt:function(t){return i(t=+t)*Math.pow(Math.abs(t),1/3)}})},function(t,n,r){var e=r(1);e(e.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},function(t,n,r){var e=r(1),i=Math.exp;e(e.S,"Math",{cosh:function(t){return(i(t=+t)+i(-t))/2}})},function(t,n,r){var e=r(1),i=r(141);e(e.S+e.F*(i!=Math.expm1),"Math",{expm1:i})},function(t,n,r){var e=r(1),i=r(142),o=Math.pow,u=o(2,-52),c=o(2,-23),f=o(2,127)*(2-c),a=o(2,-126),s=function(t){return t+1/u-1/u};e(e.S,"Math",{fround:function(t){var n,r,e=Math.abs(t),o=i(t);return e<a?o*s(e/a/c)*a*c:(n=(1+c/u)*e,r=n-(n-e),r>f||r!=r?o*(1/0):o*r)}})},function(t,n,r){var e=r(1),i=Math.abs;e(e.S,"Math",{hypot:function(t,n){for(var r,e,o=0,u=0,c=arguments.length,f=0;u<c;)r=i(arguments[u++]),f<r?(e=f/r,o=o*e*e+1,f=r):r>0?(e=r/f,o+=e*e):o+=r;return f===1/0?1/0:f*Math.sqrt(o)}})},function(t,n,r){var e=r(1),i=Math.imul;e(e.S+e.F*r(4)(function(){return-5!=i(4294967295,5)||2!=i.length}),"Math",{imul:function(t,n){var r=65535,e=+t,i=+n,o=r&e,u=r&i;return 0|o*u+((r&e>>>16)*u+o*(r&i>>>16)<<16>>>0)}})},function(t,n,r){var e=r(1);e(e.S,"Math",{log10:function(t){return Math.log(t)/Math.LN10}})},function(t,n,r){var e=r(1);e(e.S,"Math",{log1p:r(171)})},function(t,n,r){var e=r(1);e(e.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},function(t,n,r){var e=r(1);e(e.S,"Math",{sign:r(142)})},function(t,n,r){var e=r(1),i=r(141),o=Math.exp;e(e.S+e.F*r(4)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(i(t)-i(-t))/2:(o(t-1)-o(-t-1))*(Math.E/2)}})},function(t,n,r){var e=r(1),i=r(141),o=Math.exp;e(e.S,"Math",{tanh:function(t){var n=i(t=+t),r=i(-t);return n==1/0?1:r==1/0?-1:(n-r)/(o(t)+o(-t))}})},function(t,n,r){var e=r(1);e(e.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}})},function(t,n,r){"use strict";var e=r(3),i=r(24),o=r(45),u=r(136),c=r(50),f=r(4),a=r(71).f,s=r(31).f,l=r(11).f,h=r(82).trim,v="Number",p=e[v],d=p,y=p.prototype,g=o(r(70)(y))==v,b="trim"in String.prototype,m=function(t){var n=c(t,!1);if("string"==typeof n&&n.length>2){n=b?n.trim():h(n,3);var r,e,i,o=n.charCodeAt(0);if(43===o||45===o){if(88===(r=n.charCodeAt(2))||120===r)return NaN}else if(48===o){switch(n.charCodeAt(1)){case 66:case 98:e=2,i=49;break;case 79:case 111:e=8,i=55;break;default:return+n}for(var u,f=n.slice(2),a=0,s=f.length;a<s;a++)if((u=f.charCodeAt(a))<48||u>i)return NaN;return parseInt(f,e)}}return+n};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(t){var n=arguments.length<1?0:t,r=this;return r instanceof p&&(g?f(function(){y.valueOf.call(r)}):o(r)!=v)?u(new d(m(n)),r,p):m(n)};for(var x,w=r(10)?a(d):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),S=0;w.length>S;S++)i(d,x=w[S])&&!i(p,x)&&l(p,x,s(d,x));p.prototype=y,y.constructor=p,r(28)(e,v,p)}},function(t,n,r){var e=r(1);e(e.S,"Number",{EPSILON:Math.pow(2,-52)})},function(t,n,r){var e=r(1),i=r(3).isFinite;e(e.S,"Number",{isFinite:function(t){return"number"==typeof t&&i(t)}})},function(t,n,r){var e=r(1);e(e.S,"Number",{isInteger:r(168)})},function(t,n,r){var e=r(1);e(e.S,"Number",{isNaN:function(t){return t!=t}})},function(t,n,r){var e=r(1),i=r(168),o=Math.abs;e(e.S,"Number",{isSafeInteger:function(t){return i(t)&&o(t)<=9007199254740991}})},function(t,n,r){var e=r(1);e(e.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(t,n,r){var e=r(1);e(e.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(t,n,r){var e=r(1),i=r(178);e(e.S+e.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},function(t,n,r){var e=r(1),i=r(179);e(e.S+e.F*(Number.parseInt!=i),"Number",{parseInt:i})},function(t,n,r){"use strict";var e=r(1),i=r(67),o=r(159),u=r(149),c=1..toFixed,f=Math.floor,a=[0,0,0,0,0,0],s="Number.toFixed: incorrect invocation!",l="0",h=function(t,n){for(var r=-1,e=n;++r<6;)e+=t*a[r],a[r]=e%1e7,e=f(e/1e7)},v=function(t){for(var n=6,r=0;--n>=0;)r+=a[n],a[n]=f(r/t),r=r%t*1e7},p=function(){for(var t=6,n="";--t>=0;)if(""!==n||0===t||0!==a[t]){var r=String(a[t]);n=""===n?r:n+u.call(l,7-r.length)+r}return n},d=function(t,n,r){return 0===n?r:n%2==1?d(t,n-1,r*t):d(t*t,n/2,r)},y=function(t){for(var n=0,r=t;r>=4096;)n+=12,r/=4096;for(;r>=2;)n+=1,r/=2;return n};e(e.P+e.F*(!!c&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!r(4)(function(){c.call({})})),"Number",{toFixed:function(t){var n,r,e,c,f=o(this,s),a=i(t),g="",b=l;if(a<0||a>20)throw RangeError(s);if(f!=f)return"NaN";if(f<=-1e21||f>=1e21)return String(f);if(f<0&&(g="-",f=-f),f>1e-21)if(n=y(f*d(2,69,1))-69,r=n<0?f*d(2,-n,1):f/d(2,n,1),r*=4503599627370496,(n=52-n)>0){for(h(0,r),e=a;e>=7;)h(1e7,0),e-=7;for(h(d(10,e,1),0),e=n-1;e>=23;)v(1<<23),e-=23;v(1<<e),h(1,1),v(2),b=p()}else h(0,r),h(1<<-n,0),b=p()+u.call(l,a);return a>0?(c=b.length,b=g+(c<=a?"0."+u.call(l,a-c)+b:b.slice(0,c-a)+"."+b.slice(c-a))):b=g+b,b}})},function(t,n,r){"use strict";var e=r(1),i=r(4),o=r(159),u=1..toPrecision;e(e.P+e.F*(i(function(){return"1"!==u.call(1,void 0)})||!i(function(){u.call({})})),"Number",{toPrecision:function(t){var n=o(this,"Number#toPrecision: incorrect invocation!");return void 0===t?u.call(n):u.call(n,t)}})},function(t,n,r){var e=r(1);e(e.S+e.F,"Object",{assign:r(172)})},function(t,n,r){var e=r(1);e(e.S,"Object",{create:r(70)})},function(t,n,r){var e=r(1);e(e.S+e.F*!r(10),"Object",{defineProperties:r(173)})},function(t,n,r){var e=r(1);e(e.S+e.F*!r(10),"Object",{defineProperty:r(11).f})},function(t,n,r){var e=r(6),i=r(65).onFreeze;r(49)("freeze",function(t){return function(n){return t&&e(n)?t(i(n)):n}})},function(t,n,r){var e=r(30),i=r(31).f;r(49)("getOwnPropertyDescriptor",function(){return function(t,n){return i(e(t),n)}})},function(t,n,r){r(49)("getOwnPropertyNames",function(){return r(174).f})},function(t,n,r){var e=r(17),i=r(32);r(49)("getPrototypeOf",function(){return function(t){return i(e(t))}})},function(t,n,r){var e=r(6);r(49)("isExtensible",function(t){return function(n){return!!e(n)&&(!t||t(n))}})},function(t,n,r){var e=r(6);r(49)("isFrozen",function(t){return function(n){return!e(n)||!!t&&t(n)}})},function(t,n,r){var e=r(6);r(49)("isSealed",function(t){return function(n){return!e(n)||!!t&&t(n)}})},function(t,n,r){var e=r(1);e(e.S,"Object",{is:r(180)})},function(t,n,r){var e=r(17),i=r(72);r(49)("keys",function(){return function(t){return i(e(t))}})},function(t,n,r){var e=r(6),i=r(65).onFreeze;r(49)("preventExtensions",function(t){return function(n){return t&&e(n)?t(i(n)):n}})},function(t,n,r){var e=r(6),i=r(65).onFreeze;r(49)("seal",function(t){return function(n){return t&&e(n)?t(i(n)):n}})},function(t,n,r){var e=r(1);e(e.S,"Object",{setPrototypeOf:r(144).set})},function(t,n,r){"use strict";var e=r(114),i={};i[r(7)("toStringTag")]="z",i+""!="[object z]"&&r(28)(Object.prototype,"toString",function(){return"[object "+e(this)+"]"},!0)},function(t,n,r){var e=r(1),i=r(178);e(e.G+e.F*(parseFloat!=i),{parseFloat:i})},function(t,n,r){var e=r(1),i=r(179);e(e.G+e.F*(parseInt!=i),{parseInt:i})},function(t,n,r){"use strict";var e,i,o,u=r(69),c=r(3),f=r(53),a=r(114),s=r(1),l=r(6),h=r(26),v=r(68),p=r(79),d=r(146),y=r(151).set,g=r(143)(),b="Promise",m=c.TypeError,x=c.process,w=c[b],x=c.process,S="process"==a(x),_=function(){},O=!!function(){try{var t=w.resolve(1),n=(t.constructor={})[r(7)("species")]=function(t){t(_,_)};return(S||"function"==typeof PromiseRejectionEvent)&&t.then(_)instanceof n}catch(t){}}(),E=function(t,n){return t===n||t===w&&n===o},P=function(t){var n;return!(!l(t)||"function"!=typeof(n=t.then))&&n},j=function(t){return E(w,t)?new F(t):new i(t)},F=i=function(t){var n,r;this.promise=new t(function(t,e){if(void 0!==n||void 0!==r)throw m("Bad Promise constructor");n=t,r=e}),this.resolve=h(n),this.reject=h(r)},M=function(t){try{t()}catch(t){return{error:t}}},A=function(t,n){if(!t._n){t._n=!0;var r=t._c;g(function(){for(var e=t._v,i=1==t._s,o=0;r.length>o;)!function(n){var r,o,u=i?n.ok:n.fail,c=n.resolve,f=n.reject,a=n.domain;try{u?(i||(2==t._h&&I(t),t._h=1),!0===u?r=e:(a&&a.enter(),r=u(e),a&&a.exit()),r===n.promise?f(m("Promise-chain cycle")):(o=P(r))?o.call(r,c,f):c(r)):f(e)}catch(t){f(t)}}(r[o++]);t._c=[],t._n=!1,n&&!t._h&&N(t)})}},N=function(t){y.call(c,function(){var n,r,e,i=t._v;if(T(t)&&(n=M(function(){S?x.emit("unhandledRejection",i,t):(r=c.onunhandledrejection)?r({promise:t,reason:i}):(e=c.console)&&e.error&&e.error("Unhandled promise rejection",i)}),t._h=S||T(t)?2:1),t._a=void 0,n)throw n.error})},T=function(t){if(1==t._h)return!1;for(var n,r=t._a||t._c,e=0;r.length>e;)if(n=r[e++],n.fail||!T(n.promise))return!1;return!0},I=function(t){y.call(c,function(){var n;S?x.emit("rejectionHandled",t):(n=c.onrejectionhandled)&&n({promise:t,reason:t._v})})},k=function(t){var n=this;n._d||(n._d=!0,n=n._w||n,n._v=t,n._s=2,n._a||(n._a=n._c.slice()),A(n,!0))},L=function(t){var n,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===t)throw m("Promise can't be resolved itself");(n=P(t))?g(function(){var e={_w:r,_d:!1};try{n.call(t,f(L,e,1),f(k,e,1))}catch(t){k.call(e,t)}}):(r._v=t,r._s=1,A(r,!1))}catch(t){k.call({_w:r,_d:!1},t)}}};O||(w=function(t){v(this,w,b,"_h"),h(t),e.call(this);try{t(f(L,this,1),f(k,this,1))}catch(t){k.call(this,t)}},e=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},e.prototype=r(73)(w.prototype,{then:function(t,n){var r=j(d(this,w));return r.ok="function"!=typeof t||t,r.fail="function"==typeof n&&n,r.domain=S?x.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&A(this,!1),r.promise},catch:function(t){return this.then(void 0,t)}}),F=function(){var t=new e;this.promise=t,this.resolve=f(L,t,1),this.reject=f(k,t,1)}),s(s.G+s.W+s.F*!O,{Promise:w}),r(81)(w,b),r(74)(b),o=r(52)[b],s(s.S+s.F*!O,b,{reject:function(t){var n=j(this);return(0,n.reject)(t),n.promise}}),s(s.S+s.F*(u||!O),b,{resolve:function(t){if(t instanceof w&&E(t.constructor,this))return t;var n=j(this);return(0,n.resolve)(t),n.promise}}),s(s.S+s.F*!(O&&r(123)(function(t){w.all(t).catch(_)})),b,{all:function(t){var n=this,r=j(n),e=r.resolve,i=r.reject,o=M(function(){var r=[],o=0,u=1;p(t,!1,function(t){var c=o++,f=!1;r.push(void 0),u++,n.resolve(t).then(function(t){f||(f=!0,r[c]=t,--u||e(r))},i)}),--u||e(r)});return o&&i(o.error),r.promise},race:function(t){var n=this,r=j(n),e=r.reject,i=M(function(){p(t,!1,function(t){n.resolve(t).then(r.resolve,e)})});return i&&e(i.error),r.promise}})},function(t,n,r){var e=r(1),i=r(26),o=r(2),u=(r(3).Reflect||{}).apply,c=Function.apply;e(e.S+e.F*!r(4)(function(){u(function(){})}),"Reflect",{apply:function(t,n,r){var e=i(t),f=o(r);return u?u(e,n,f):c.call(e,n,f)}})},function(t,n,r){var e=r(1),i=r(70),o=r(26),u=r(2),c=r(6),f=r(4),a=r(163),s=(r(3).Reflect||{}).construct,l=f(function(){function t(){}return!(s(function(){},[],t)instanceof t)}),h=!f(function(){s(function(){})});e(e.S+e.F*(l||h),"Reflect",{construct:function(t,n){o(t),u(n);var r=arguments.length<3?t:o(arguments[2]);if(h&&!l)return s(t,n,r);if(t==r){switch(n.length){case 0:return new t;case 1:return new t(n[0]);case 2:return new t(n[0],n[1]);case 3:return new t(n[0],n[1],n[2]);case 4:return new t(n[0],n[1],n[2],n[3])}var e=[null];return e.push.apply(e,n),new(a.apply(t,e))}var f=r.prototype,v=i(c(f)?f:Object.prototype),p=Function.apply.call(t,v,n);return c(p)?p:v}})},function(t,n,r){var e=r(11),i=r(1),o=r(2),u=r(50);i(i.S+i.F*r(4)(function(){Reflect.defineProperty(e.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(t,n,r){o(t),n=u(n,!0),o(r);try{return e.f(t,n,r),!0}catch(t){return!1}}})},function(t,n,r){var e=r(1),i=r(31).f,o=r(2);e(e.S,"Reflect",{deleteProperty:function(t,n){var r=i(o(t),n);return!(r&&!r.configurable)&&delete t[n]}})},function(t,n,r){"use strict";var e=r(1),i=r(2),o=function(t){this._t=i(t),this._i=0;var n,r=this._k=[];for(n in t)r.push(n)};r(139)(o,"Object",function(){var t,n=this,r=n._k;do{if(n._i>=r.length)return{value:void 0,done:!0}}while(!((t=r[n._i++])in n._t));return{value:t,done:!1}}),e(e.S,"Reflect",{enumerate:function(t){return new o(t)}})},function(t,n,r){var e=r(31),i=r(1),o=r(2);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(t,n){return e.f(o(t),n)}})},function(t,n,r){var e=r(1),i=r(32),o=r(2);e(e.S,"Reflect",{getPrototypeOf:function(t){return i(o(t))}})},function(t,n,r){function e(t,n){var r,c,s=arguments.length<3?t:arguments[2];return a(t)===s?t[n]:(r=i.f(t,n))?u(r,"value")?r.value:void 0!==r.get?r.get.call(s):void 0:f(c=o(t))?e(c,n,s):void 0}var i=r(31),o=r(32),u=r(24),c=r(1),f=r(6),a=r(2);c(c.S,"Reflect",{get:e})},function(t,n,r){var e=r(1);e(e.S,"Reflect",{has:function(t,n){return n in t}})},function(t,n,r){var e=r(1),i=r(2),o=Object.isExtensible;e(e.S,"Reflect",{isExtensible:function(t){return i(t),!o||o(t)}})},function(t,n,r){var e=r(1);e(e.S,"Reflect",{ownKeys:r(177)})},function(t,n,r){var e=r(1),i=r(2),o=Object.preventExtensions;e(e.S,"Reflect",{preventExtensions:function(t){i(t);try{return o&&o(t),!0}catch(t){return!1}}})},function(t,n,r){var e=r(1),i=r(144);i&&e(e.S,"Reflect",{setPrototypeOf:function(t,n){i.check(t,n);try{return i.set(t,n),!0}catch(t){return!1}}})},function(t,n,r){function e(t,n,r){var f,h,v=arguments.length<4?t:arguments[3],p=o.f(s(t),n);if(!p){if(l(h=u(t)))return e(h,n,r,v);p=a(0)}return c(p,"value")?!(!1===p.writable||!l(v)||(f=o.f(v,n)||a(0),f.value=r,i.f(v,n,f),0)):void 0!==p.set&&(p.set.call(v,r),!0)}var i=r(11),o=r(31),u=r(32),c=r(24),f=r(1),a=r(66),s=r(2),l=r(6);f(f.S,"Reflect",{set:e})},function(t,n,r){var e=r(3),i=r(136),o=r(11).f,u=r(71).f,c=r(122),f=r(120),a=e.RegExp,s=a,l=a.prototype,h=/a/g,v=/a/g,p=new a(h)!==h;if(r(10)&&(!p||r(4)(function(){return v[r(7)("match")]=!1,a(h)!=h||a(v)==v||"/a/i"!=a(h,"i")}))){a=function(t,n){var r=this instanceof a,e=c(t),o=void 0===n;return!r&&e&&t.constructor===a&&o?t:i(p?new s(e&&!o?t.source:t,n):s((e=t instanceof a)?t.source:t,e&&o?f.call(t):n),r?this:l,a)};for(var d=u(s),y=0;d.length>y;)!function(t){t in a||o(a,t,{configurable:!0,get:function(){return s[t]},set:function(n){s[t]=n}})}(d[y++]);l.constructor=a,a.prototype=l,r(28)(e,"RegExp",a)}r(74)("RegExp")},function(t,n,r){r(119)("match",1,function(t,n,r){return[function(r){"use strict";var e=t(this),i=void 0==r?void 0:r[n];return void 0!==i?i.call(r,e):new RegExp(r)[n](String(e))},r]})},function(t,n,r){r(119)("replace",2,function(t,n,r){return[function(e,i){"use strict";var o=t(this),u=void 0==e?void 0:e[n];return void 0!==u?u.call(e,o,i):r.call(String(o),e,i)},r]})},function(t,n,r){r(119)("search",1,function(t,n,r){return[function(r){"use strict";var e=t(this),i=void 0==r?void 0:r[n];return void 0!==i?i.call(r,e):new RegExp(r)[n](String(e))},r]})},function(t,n,r){r(119)("split",2,function(t,n,e){"use strict";var i=r(122),o=e,u=[].push,c="split",f="length",a="lastIndex";if("c"=="abbc"[c](/(b)*/)[1]||4!="test"[c](/(?:)/,-1)[f]||2!="ab"[c](/(?:ab)*/)[f]||4!="."[c](/(.?)(.?)/)[f]||"."[c](/()()/)[f]>1||""[c](/.?/)[f]){var s=void 0===/()??/.exec("")[1];e=function(t,n){var r=String(this);if(void 0===t&&0===n)return[];if(!i(t))return o.call(r,t,n);var e,c,l,h,v,p=[],d=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),y=0,g=void 0===n?4294967295:n>>>0,b=new RegExp(t.source,d+"g");for(s||(e=new RegExp("^"+b.source+"$(?!\\s)",d));(c=b.exec(r))&&!((l=c.index+c[0][f])>y&&(p.push(r.slice(y,c.index)),!s&&c[f]>1&&c[0].replace(e,function(){for(v=1;v<arguments[f]-2;v++)void 0===arguments[v]&&(c[v]=void 0)}),c[f]>1&&c.index<r[f]&&u.apply(p,c.slice(1)),h=c[0][f],y=l,p[f]>=g));)b[a]===c.index&&b[a]++;return y===r[f]?!h&&b.test("")||p.push(""):p.push(r.slice(y)),p[f]>g?p.slice(0,g):p}}else"0"[c](void 0,0)[f]&&(e=function(t,n){return void 0===t&&0===n?[]:o.call(this,t,n)});return[function(r,i){var o=t(this),u=void 0==r?void 0:r[n];return void 0!==u?u.call(r,o,i):e.call(String(o),r,i)},e]})},function(t,n,r){"use strict";r(184);var e=r(2),i=r(120),o=r(10),u="toString",c=/./[u],f=function(t){r(28)(RegExp.prototype,u,t,!0)};r(4)(function(){return"/a/b"!=c.call({source:"a",flags:"b"})})?f(function(){var t=e(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?i.call(t):void 0)}):c.name!=u&&f(function(){return c.call(this)})},function(t,n,r){"use strict";r(29)("anchor",function(t){return function(n){return t(this,"a","name",n)}})},function(t,n,r){"use strict";r(29)("big",function(t){return function(){return t(this,"big","","")}})},function(t,n,r){"use strict";r(29)("blink",function(t){return function(){return t(this,"blink","","")}})},function(t,n,r){"use strict";r(29)("bold",function(t){return function(){return t(this,"b","","")}})},function(t,n,r){"use strict";var e=r(1),i=r(147)(!1);e(e.P,"String",{codePointAt:function(t){return i(this,t)}})},function(t,n,r){"use strict";var e=r(1),i=r(16),o=r(148),u="endsWith",c=""[u];e(e.P+e.F*r(134)(u),"String",{endsWith:function(t){var n=o(this,t,u),r=arguments.length>1?arguments[1]:void 0,e=i(n.length),f=void 0===r?e:Math.min(i(r),e),a=String(t);return c?c.call(n,a,f):n.slice(f-a.length,f)===a}})},function(t,n,r){"use strict";r(29)("fixed",function(t){return function(){return t(this,"tt","","")}})},function(t,n,r){"use strict";r(29)("fontcolor",function(t){return function(n){return t(this,"font","color",n)}})},function(t,n,r){"use strict";r(29)("fontsize",function(t){return function(n){return t(this,"font","size",n)}})},function(t,n,r){var e=r(1),i=r(75),o=String.fromCharCode,u=String.fromCodePoint;e(e.S+e.F*(!!u&&1!=u.length),"String",{fromCodePoint:function(t){for(var n,r=[],e=arguments.length,u=0;e>u;){if(n=+arguments[u++],i(n,1114111)!==n)throw RangeError(n+" is not a valid code point");r.push(n<65536?o(n):o(55296+((n-=65536)>>10),n%1024+56320))}return r.join("")}})},function(t,n,r){"use strict";var e=r(1),i=r(148),o="includes";e(e.P+e.F*r(134)(o),"String",{includes:function(t){return!!~i(this,t,o).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},function(t,n,r){"use strict";r(29)("italics",function(t){return function(){return t(this,"i","","")}})},function(t,n,r){"use strict";var e=r(147)(!0);r(140)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,r=this._i;return r>=n.length?{value:void 0,done:!0}:(t=e(n,r),this._i+=t.length,{value:t,done:!1})})},function(t,n,r){"use strict";r(29)("link",function(t){return function(n){return t(this,"a","href",n)}})},function(t,n,r){var e=r(1),i=r(30),o=r(16);e(e.S,"String",{raw:function(t){for(var n=i(t.raw),r=o(n.length),e=arguments.length,u=[],c=0;r>c;)u.push(String(n[c++])),c<e&&u.push(String(arguments[c]));return u.join("")}})},function(t,n,r){var e=r(1);e(e.P,"String",{repeat:r(149)})},function(t,n,r){"use strict";r(29)("small",function(t){return function(){return t(this,"small","","")}})},function(t,n,r){"use strict";var e=r(1),i=r(16),o=r(148),u="startsWith",c=""[u];e(e.P+e.F*r(134)(u),"String",{startsWith:function(t){var n=o(this,t,u),r=i(Math.min(arguments.length>1?arguments[1]:void 0,n.length)),e=String(t);return c?c.call(n,e,r):n.slice(r,r+e.length)===e}})},function(t,n,r){"use strict";r(29)("strike",function(t){return function(){return t(this,"strike","","")}})},function(t,n,r){"use strict";r(29)("sub",function(t){return function(){return t(this,"sub","","")}})},function(t,n,r){"use strict";r(29)("sup",function(t){return function(){return t(this,"sup","","")}})},function(t,n,r){"use strict";r(82)("trim",function(t){return function(){return t(this,3)}})},function(t,n,r){"use strict";var e=r(3),i=r(24),o=r(10),u=r(1),c=r(28),f=r(65).KEY,a=r(4),s=r(126),l=r(81),h=r(76),v=r(7),p=r(182),d=r(153),y=r(206),g=r(205),b=r(138),m=r(2),x=r(30),w=r(50),S=r(66),_=r(70),O=r(174),E=r(31),P=r(11),j=r(72),F=E.f,M=P.f,A=O.f,N=e.Symbol,T=e.JSON,I=T&&T.stringify,k="prototype",L=v("_hidden"),R=v("toPrimitive"),C={}.propertyIsEnumerable,D=s("symbol-registry"),U=s("symbols"),W=s("op-symbols"),G=Object[k],B="function"==typeof N,V=e.QObject,z=!V||!V[k]||!V[k].findChild,q=o&&a(function(){return 7!=_(M({},"a",{get:function(){return M(this,"a",{value:7}).a}})).a})?function(t,n,r){var e=F(G,n);e&&delete G[n],M(t,n,r),e&&t!==G&&M(G,n,e)}:M,K=function(t){var n=U[t]=_(N[k]);return n._k=t,n},J=B&&"symbol"==typeof N.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof N},Y=function(t,n,r){return t===G&&Y(W,n,r),m(t),n=w(n,!0),m(r),i(U,n)?(r.enumerable?(i(t,L)&&t[L][n]&&(t[L][n]=!1),r=_(r,{enumerable:S(0,!1)})):(i(t,L)||M(t,L,S(1,{})),t[L][n]=!0),q(t,n,r)):M(t,n,r)},H=function(t,n){m(t);for(var r,e=g(n=x(n)),i=0,o=e.length;o>i;)Y(t,r=e[i++],n[r]);return t},$=function(t,n){return void 0===n?_(t):H(_(t),n)},X=function(t){var n=C.call(this,t=w(t,!0));return!(this===G&&i(U,t)&&!i(W,t))&&(!(n||!i(this,t)||!i(U,t)||i(this,L)&&this[L][t])||n)},Q=function(t,n){if(t=x(t),n=w(n,!0),t!==G||!i(U,n)||i(W,n)){var r=F(t,n);return!r||!i(U,n)||i(t,L)&&t[L][n]||(r.enumerable=!0),r}},Z=function(t){for(var n,r=A(x(t)),e=[],o=0;r.length>o;)i(U,n=r[o++])||n==L||n==f||e.push(n);return e},tt=function(t){for(var n,r=t===G,e=A(r?W:x(t)),o=[],u=0;e.length>u;)!i(U,n=e[u++])||r&&!i(G,n)||o.push(U[n]);return o};B||(N=function(){if(this instanceof N)throw TypeError("Symbol is not a constructor!");var t=h(arguments.length>0?arguments[0]:void 0),n=function(r){this===G&&n.call(W,r),i(this,L)&&i(this[L],t)&&(this[L][t]=!1),q(this,t,S(1,r))};return o&&z&&q(G,t,{configurable:!0,set:n}),K(t)},c(N[k],"toString",function(){return this._k}),E.f=Q,P.f=Y,r(71).f=O.f=Z,r(116).f=X,r(125).f=tt,o&&!r(69)&&c(G,"propertyIsEnumerable",X,!0),p.f=function(t){return K(v(t))}),u(u.G+u.W+u.F*!B,{Symbol:N});for(var nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),rt=0;nt.length>rt;)v(nt[rt++]);for(var nt=j(v.store),rt=0;nt.length>rt;)d(nt[rt++]);u(u.S+u.F*!B,"Symbol",{for:function(t){return i(D,t+="")?D[t]:D[t]=N(t)},keyFor:function(t){if(J(t))return y(D,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){z=!0},useSimple:function(){z=!1}}),u(u.S+u.F*!B,"Object",{create:$,defineProperty:Y,defineProperties:H,getOwnPropertyDescriptor:Q,getOwnPropertyNames:Z,getOwnPropertySymbols:tt}),T&&u(u.S+u.F*(!B||a(function(){var t=N();return"[null]"!=I([t])||"{}"!=I({a:t})||"{}"!=I(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!J(t)){for(var n,r,e=[t],i=1;arguments.length>i;)e.push(arguments[i++]);return n=e[1],"function"==typeof n&&(r=n),!r&&b(n)||(n=function(t,n){if(r&&(n=r.call(this,t,n)),!J(n))return n}),e[1]=n,I.apply(T,e)}}}),N[k][R]||r(27)(N[k],R,N[k].valueOf),l(N,"Symbol"),l(Math,"Math",!0),l(e.JSON,"JSON",!0)},function(t,n,r){"use strict";var e=r(1),i=r(127),o=r(152),u=r(2),c=r(75),f=r(16),a=r(6),s=r(3).ArrayBuffer,l=r(146),h=o.ArrayBuffer,v=o.DataView,p=i.ABV&&s.isView,d=h.prototype.slice,y=i.VIEW,g="ArrayBuffer";e(e.G+e.W+e.F*(s!==h),{ArrayBuffer:h}),e(e.S+e.F*!i.CONSTR,g,{isView:function(t){return p&&p(t)||a(t)&&y in t}}),e(e.P+e.U+e.F*r(4)(function(){return!new h(2).slice(1,void 0).byteLength}),g,{slice:function(t,n){if(void 0!==d&&void 0===n)return d.call(u(this),t);for(var r=u(this).byteLength,e=c(t,r),i=c(void 0===n?r:n,r),o=new(l(this,h))(f(i-e)),a=new v(this),s=new v(o),p=0;e<i;)s.setUint8(p++,a.getUint8(e++));return o}}),r(74)(g)},function(t,n,r){var e=r(1);e(e.G+e.W+e.F*!r(127).ABV,{DataView:r(152).DataView})},function(t,n,r){r(55)("Float32",4,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Float64",8,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Int16",2,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Int32",4,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Int8",1,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint16",2,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint32",4,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint8",1,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint8",1,function(t){return function(n,r,e){return t(this,n,r,e)}},!0)},function(t,n,r){"use strict";var e=r(166);r(118)("WeakSet",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return e.def(this,t,!0)}},e,!1,!0)},function(t,n,r){"use strict";var e=r(1),i=r(117)(!0);e(e.P,"Array",{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(78)("includes")},function(t,n,r){var e=r(1),i=r(143)(),o=r(3).process,u="process"==r(45)(o);e(e.G,{asap:function(t){var n=u&&o.domain;i(n?n.bind(t):t)}})},function(t,n,r){var e=r(1),i=r(45);e(e.S,"Error",{isError:function(t){return"Error"===i(t)}})},function(t,n,r){var e=r(1);e(e.P+e.R,"Map",{toJSON:r(165)("Map")})},function(t,n,r){var e=r(1);e(e.S,"Math",{iaddh:function(t,n,r,e){var i=t>>>0,o=n>>>0,u=r>>>0;return o+(e>>>0)+((i&u|(i|u)&~(i+u>>>0))>>>31)|0}})},function(t,n,r){var e=r(1);e(e.S,"Math",{imulh:function(t,n){var r=65535,e=+t,i=+n,o=e&r,u=i&r,c=e>>16,f=i>>16,a=(c*u>>>0)+(o*u>>>16);return c*f+(a>>16)+((o*f>>>0)+(a&r)>>16)}})},function(t,n,r){var e=r(1);e(e.S,"Math",{isubh:function(t,n,r,e){var i=t>>>0,o=n>>>0,u=r>>>0;return o-(e>>>0)-((~i&u|~(i^u)&i-u>>>0)>>>31)|0}})},function(t,n,r){var e=r(1);e(e.S,"Math",{umulh:function(t,n){var r=65535,e=+t,i=+n,o=e&r,u=i&r,c=e>>>16,f=i>>>16,a=(c*u>>>0)+(o*u>>>16);return c*f+(a>>>16)+((o*f>>>0)+(a&r)>>>16)}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(26),u=r(11);r(10)&&e(e.P+r(124),"Object",{__defineGetter__:function(t,n){u.f(i(this),t,{get:o(n),enumerable:!0,configurable:!0})}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(26),u=r(11);r(10)&&e(e.P+r(124),"Object",{__defineSetter__:function(t,n){u.f(i(this),t,{set:o(n),enumerable:!0,configurable:!0})}})},function(t,n,r){var e=r(1),i=r(176)(!0);e(e.S,"Object",{entries:function(t){return i(t)}})},function(t,n,r){var e=r(1),i=r(177),o=r(30),u=r(31),c=r(131);e(e.S,"Object",{getOwnPropertyDescriptors:function(t){for(var n,r=o(t),e=u.f,f=i(r),a={},s=0;f.length>s;)c(a,n=f[s++],e(r,n));return a}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(50),u=r(32),c=r(31).f;r(10)&&e(e.P+r(124),"Object",{__lookupGetter__:function(t){var n,r=i(this),e=o(t,!0);do{if(n=c(r,e))return n.get}while(r=u(r))}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(50),u=r(32),c=r(31).f;r(10)&&e(e.P+r(124),"Object",{__lookupSetter__:function(t){var n,r=i(this),e=o(t,!0);do{if(n=c(r,e))return n.set}while(r=u(r))}})},function(t,n,r){var e=r(1),i=r(176)(!1);e(e.S,"Object",{values:function(t){return i(t)}})},function(t,n,r){"use strict";var e=r(1),i=r(3),o=r(52),u=r(143)(),c=r(7)("observable"),f=r(26),a=r(2),s=r(68),l=r(73),h=r(27),v=r(79),p=v.RETURN,d=function(t){return null==t?void 0:f(t)},y=function(t){var n=t._c;n&&(t._c=void 0,n())},g=function(t){return void 0===t._o},b=function(t){g(t)||(t._o=void 0,y(t))},m=function(t,n){a(t),this._c=void 0,this._o=t,t=new x(this);try{var r=n(t),e=r;null!=r&&("function"==typeof r.unsubscribe?r=function(){e.unsubscribe()}:f(r),this._c=r)}catch(n){return void t.error(n)}g(this)&&y(this)};m.prototype=l({},{unsubscribe:function(){b(this)}});var x=function(t){this._s=t};x.prototype=l({},{next:function(t){var n=this._s;if(!g(n)){var r=n._o;try{var e=d(r.next);if(e)return e.call(r,t)}catch(t){try{b(n)}finally{throw t}}}},error:function(t){var n=this._s;if(g(n))throw t;var r=n._o;n._o=void 0;try{var e=d(r.error);if(!e)throw t;t=e.call(r,t)}catch(t){try{y(n)}finally{throw t}}return y(n),t},complete:function(t){var n=this._s;if(!g(n)){var r=n._o;n._o=void 0;try{var e=d(r.complete);t=e?e.call(r,t):void 0}catch(t){try{y(n)}finally{throw t}}return y(n),t}}});var w=function(t){s(this,w,"Observable","_f")._f=f(t)};l(w.prototype,{subscribe:function(t){return new m(t,this._f)},forEach:function(t){var n=this;return new(o.Promise||i.Promise)(function(r,e){f(t);var i=n.subscribe({next:function(n){try{return t(n)}catch(t){e(t),i.unsubscribe()}},error:e,complete:r})})}}),l(w,{from:function(t){var n="function"==typeof this?this:w,r=d(a(t)[c]);if(r){var e=a(r.call(t));return e.constructor===n?e:new n(function(t){return e.subscribe(t)})}return new n(function(n){var r=!1;return u(function(){if(!r){try{if(v(t,!1,function(t){if(n.next(t),r)return p})===p)return}catch(t){if(r)throw t;return void n.error(t)}n.complete()}}),function(){r=!0}})},of:function(){for(var t=0,n=arguments.length,r=Array(n);t<n;)r[t]=arguments[t++];return new("function"==typeof this?this:w)(function(t){var n=!1;return u(function(){if(!n){for(var e=0;e<r.length;++e)if(t.next(r[e]),n)return;t.complete()}}),function(){n=!0}})}}),h(w.prototype,c,function(){return this}),e(e.G,{Observable:w}),r(74)("Observable")},function(t,n,r){var e=r(54),i=r(2),o=e.key,u=e.set;e.exp({defineMetadata:function(t,n,r,e){u(t,n,i(r),o(e))}})},function(t,n,r){var e=r(54),i=r(2),o=e.key,u=e.map,c=e.store;e.exp({deleteMetadata:function(t,n){var r=arguments.length<3?void 0:o(arguments[2]),e=u(i(n),r,!1);if(void 0===e||!e.delete(t))return!1;if(e.size)return!0;var f=c.get(n);return f.delete(r),!!f.size||c.delete(n)}})},function(t,n,r){var e=r(185),i=r(161),o=r(54),u=r(2),c=r(32),f=o.keys,a=o.key,s=function(t,n){var r=f(t,n),o=c(t);if(null===o)return r;var u=s(o,n);return u.length?r.length?i(new e(r.concat(u))):u:r};o.exp({getMetadataKeys:function(t){return s(u(t),arguments.length<2?void 0:a(arguments[1]))}})},function(t,n,r){var e=r(54),i=r(2),o=r(32),u=e.has,c=e.get,f=e.key,a=function(t,n,r){if(u(t,n,r))return c(t,n,r);var e=o(n);return null!==e?a(t,e,r):void 0};e.exp({getMetadata:function(t,n){return a(t,i(n),arguments.length<3?void 0:f(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=e.keys,u=e.key;e.exp({getOwnMetadataKeys:function(t){
return o(i(t),arguments.length<2?void 0:u(arguments[1]))}})},function(t,n,r){var e=r(54),i=r(2),o=e.get,u=e.key;e.exp({getOwnMetadata:function(t,n){return o(t,i(n),arguments.length<3?void 0:u(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=r(32),u=e.has,c=e.key,f=function(t,n,r){if(u(t,n,r))return!0;var e=o(n);return null!==e&&f(t,e,r)};e.exp({hasMetadata:function(t,n){return f(t,i(n),arguments.length<3?void 0:c(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=e.has,u=e.key;e.exp({hasOwnMetadata:function(t,n){return o(t,i(n),arguments.length<3?void 0:u(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=r(26),u=e.key,c=e.set;e.exp({metadata:function(t,n){return function(r,e){c(t,n,(void 0!==e?i:o)(r),u(e))}}})},function(t,n,r){var e=r(1);e(e.P+e.R,"Set",{toJSON:r(165)("Set")})},function(t,n,r){"use strict";var e=r(1),i=r(147)(!0);e(e.P,"String",{at:function(t){return i(this,t)}})},function(t,n,r){"use strict";var e=r(1),i=r(46),o=r(16),u=r(122),c=r(120),f=RegExp.prototype,a=function(t,n){this._r=t,this._s=n};r(139)(a,"RegExp String",function(){var t=this._r.exec(this._s);return{value:t,done:null===t}}),e(e.P,"String",{matchAll:function(t){if(i(this),!u(t))throw TypeError(t+" is not a regexp!");var n=String(this),r="flags"in f?String(t.flags):c.call(t),e=new RegExp(t.source,~r.indexOf("g")?r:"g"+r);return e.lastIndex=o(t.lastIndex),new a(e,n)}})},function(t,n,r){"use strict";var e=r(1),i=r(181);e(e.P,"String",{padEnd:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},function(t,n,r){"use strict";var e=r(1),i=r(181);e(e.P,"String",{padStart:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},function(t,n,r){"use strict";r(82)("trimLeft",function(t){return function(){return t(this,1)}},"trimStart")},function(t,n,r){"use strict";r(82)("trimRight",function(t){return function(){return t(this,2)}},"trimEnd")},function(t,n,r){r(153)("asyncIterator")},function(t,n,r){r(153)("observable")},function(t,n,r){var e=r(1);e(e.S,"System",{global:r(3)})},function(t,n,r){for(var e=r(155),i=r(28),o=r(3),u=r(27),c=r(80),f=r(7),a=f("iterator"),s=f("toStringTag"),l=c.Array,h=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],v=0;v<5;v++){var p,d=h[v],y=o[d],g=y&&y.prototype;if(g){g[a]||u(g,a,l),g[s]||u(g,s,d),c[d]=l;for(p in e)g[p]||i(g,p,e[p],!0)}}},function(t,n,r){var e=r(1),i=r(151);e(e.G+e.B,{setImmediate:i.set,clearImmediate:i.clear})},function(t,n,r){var e=r(3),i=r(1),o=r(121),u=r(207),c=e.navigator,f=!!c&&/MSIE .\./.test(c.userAgent),a=function(t){return f?function(n,r){return t(o(u,[].slice.call(arguments,2),"function"==typeof n?n:Function(n)),r)}:t};i(i.G+i.B+i.F*f,{setTimeout:a(e.setTimeout),setInterval:a(e.setInterval)})},function(t,n,r){r(330),r(269),r(271),r(270),r(273),r(275),r(280),r(274),r(272),r(282),r(281),r(277),r(278),r(276),r(268),r(279),r(283),r(284),r(236),r(238),r(237),r(286),r(285),r(256),r(266),r(267),r(257),r(258),r(259),r(260),r(261),r(262),r(263),r(264),r(265),r(239),r(240),r(241),r(242),r(243),r(244),r(245),r(246),r(247),r(248),r(249),r(250),r(251),r(252),r(253),r(254),r(255),r(317),r(322),r(329),r(320),r(312),r(313),r(318),r(323),r(325),r(308),r(309),r(310),r(311),r(314),r(315),r(316),r(319),r(321),r(324),r(326),r(327),r(328),r(231),r(233),r(232),r(235),r(234),r(220),r(218),r(224),r(221),r(227),r(229),r(217),r(223),r(214),r(228),r(212),r(226),r(225),r(219),r(222),r(211),r(213),r(216),r(215),r(230),r(155),r(302),r(307),r(184),r(303),r(304),r(305),r(306),r(287),r(183),r(185),r(186),r(342),r(331),r(332),r(337),r(340),r(341),r(335),r(338),r(336),r(339),r(333),r(334),r(288),r(289),r(290),r(291),r(292),r(295),r(293),r(294),r(296),r(297),r(298),r(299),r(301),r(300),r(343),r(369),r(372),r(371),r(373),r(374),r(370),r(375),r(376),r(354),r(357),r(353),r(351),r(352),r(355),r(356),r(346),r(368),r(377),r(345),r(347),r(349),r(348),r(350),r(359),r(360),r(362),r(361),r(364),r(363),r(365),r(366),r(367),r(344),r(358),r(380),r(379),r(378),t.exports=r(52)},function(t,n){function r(t,n){if("string"==typeof n)return t.insertAdjacentHTML("afterend",n);var r=t.nextSibling;return r?t.parentNode.insertBefore(n,r):t.parentNode.appendChild(n)}t.exports=r},,,,,,,,,function(t,n,r){(function(n,r){!function(n){"use strict";function e(t,n,r,e){var i=n&&n.prototype instanceof o?n:o,u=Object.create(i.prototype),c=new p(e||[]);return u._invoke=s(t,r,c),u}function i(t,n,r){try{return{type:"normal",arg:t.call(n,r)}}catch(t){return{type:"throw",arg:t}}}function o(){}function u(){}function c(){}function f(t){["next","throw","return"].forEach(function(n){t[n]=function(t){return this._invoke(n,t)}})}function a(t){function n(r,e,o,u){var c=i(t[r],t,e);if("throw"!==c.type){var f=c.arg,a=f.value;return a&&"object"==typeof a&&m.call(a,"__await")?Promise.resolve(a.__await).then(function(t){n("next",t,o,u)},function(t){n("throw",t,o,u)}):Promise.resolve(a).then(function(t){f.value=t,o(f)},u)}u(c.arg)}function e(t,r){function e(){return new Promise(function(e,i){n(t,r,e,i)})}return o=o?o.then(e,e):e()}"object"==typeof r&&r.domain&&(n=r.domain.bind(n));var o;this._invoke=e}function s(t,n,r){var e=P;return function(o,u){if(e===F)throw new Error("Generator is already running");if(e===M){if("throw"===o)throw u;return y()}for(r.method=o,r.arg=u;;){var c=r.delegate;if(c){var f=l(c,r);if(f){if(f===A)continue;return f}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(e===P)throw e=M,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);e=F;var a=i(t,n,r);if("normal"===a.type){if(e=r.done?M:j,a.arg===A)continue;return{value:a.arg,done:r.done}}"throw"===a.type&&(e=M,r.method="throw",r.arg=a.arg)}}}function l(t,n){var r=t.iterator[n.method];if(r===g){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=g,l(t,n),"throw"===n.method))return A;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return A}var e=i(r,t.iterator,n.arg);if("throw"===e.type)return n.method="throw",n.arg=e.arg,n.delegate=null,A;var o=e.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=g),n.delegate=null,A):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,A)}function h(t){var n={tryLoc:t[0]};1 in t&&(n.catchLoc=t[1]),2 in t&&(n.finallyLoc=t[2],n.afterLoc=t[3]),this.tryEntries.push(n)}function v(t){var n=t.completion||{};n.type="normal",delete n.arg,t.completion=n}function p(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(h,this),this.reset(!0)}function d(t){if(t){var n=t[w];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,e=function n(){for(;++r<t.length;)if(m.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=g,n.done=!0,n};return e.next=e}}return{next:y}}function y(){return{value:g,done:!0}}var g,b=Object.prototype,m=b.hasOwnProperty,x="function"==typeof Symbol?Symbol:{},w=x.iterator||"@@iterator",S=x.asyncIterator||"@@asyncIterator",_=x.toStringTag||"@@toStringTag",O="object"==typeof t,E=n.regeneratorRuntime;if(E)return void(O&&(t.exports=E));E=n.regeneratorRuntime=O?t.exports:{},E.wrap=e;var P="suspendedStart",j="suspendedYield",F="executing",M="completed",A={},N={};N[w]=function(){return this};var T=Object.getPrototypeOf,I=T&&T(T(d([])));I&&I!==b&&m.call(I,w)&&(N=I);var k=c.prototype=o.prototype=Object.create(N);u.prototype=k.constructor=c,c.constructor=u,c[_]=u.displayName="GeneratorFunction",E.isGeneratorFunction=function(t){var n="function"==typeof t&&t.constructor;return!!n&&(n===u||"GeneratorFunction"===(n.displayName||n.name))},E.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,_ in t||(t[_]="GeneratorFunction")),t.prototype=Object.create(k),t},E.awrap=function(t){return{__await:t}},f(a.prototype),a.prototype[S]=function(){return this},E.AsyncIterator=a,E.async=function(t,n,r,i){var o=new a(e(t,n,r,i));return E.isGeneratorFunction(n)?o:o.next().then(function(t){return t.done?t.value:o.next()})},f(k),k[_]="Generator",k.toString=function(){return"[object Generator]"},E.keys=function(t){var n=[];for(var r in t)n.push(r);return n.reverse(),function r(){for(;n.length;){var e=n.pop();if(e in t)return r.value=e,r.done=!1,r}return r.done=!0,r}},E.values=d,p.prototype={constructor:p,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=g,this.done=!1,this.delegate=null,this.method="next",this.arg=g,this.tryEntries.forEach(v),!t)for(var n in this)"t"===n.charAt(0)&&m.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=g)},stop:function(){this.done=!0;var t=this.tryEntries[0],n=t.completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(t){function n(n,e){return o.type="throw",o.arg=t,r.next=n,e&&(r.method="next",r.arg=g),!!e}if(this.done)throw t;for(var r=this,e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e],o=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=m.call(i,"catchLoc"),c=m.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,n){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc<=this.prev&&m.call(e,"finallyLoc")&&this.prev<e.finallyLoc){var i=e;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=n&&n<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=n,i?(this.method="next",this.next=i.finallyLoc,A):this.complete(o)},complete:function(t,n){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&n&&(this.next=n),A},finish:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),v(r),A}},catch:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc===t){var e=r.completion;if("throw"===e.type){var i=e.arg;v(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:d(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=g),A}}}("object"==typeof n?n:"object"==typeof window?window:"object"==typeof self?self:this)}).call(n,function(){return this}(),r(158))}])</script><script src="/./main.0cf68a.js"></script><script>!function(){!function(e){var t=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(t),t.setAttribute("src",e)}("/slider.e37972.js")}()</script>


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


    
<div class="tools-col" q-class="show:isShow,hide:isShow|isFalse" q-on="click:stop(e)">
  <div class="tools-nav header-menu">
    
    
      
      
      
    
      
    
      
      
      
    
    

    <ul style="width: 70%">
    
    
      
      <li style="width: 50%" q-on="click: openSlider(e, 'innerArchive')"><a href="javascript:void(0)" q-class="active:innerArchive">所有文章</a></li>
      
        
      
        
      
      <li style="width: 50%" q-on="click: openSlider(e, 'aboutme')"><a href="javascript:void(0)" q-class="active:aboutme">关于我</a></li>
      
        
    </ul>
  </div>
  <div class="tools-wrap">
    
    	<section class="tools-section tools-section-all" q-show="innerArchive">
        <div class="search-wrap">
          <input class="search-ipt" q-model="search" type="text" placeholder="find something…">
          <i class="icon-search icon" q-show="search|isEmptyStr"></i>
          <i class="icon-close icon" q-show="search|isNotEmptyStr" q-on="click:clearChose(e)"></i>
        </div>
        <div class="widget tagcloud search-tag">
          <p class="search-tag-wording">tag:</p>
          <label class="search-switch">
            <input type="checkbox" q-on="click:toggleTag(e)" q-attr="checked:showTags">
          </label>
          <ul class="article-tag-list" q-show="showTags">
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">随笔</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">编程基础</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">数据库</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">Java</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">工具</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">框架</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">JAVA</a>
              </li>
            
            <div class="clearfix"></div>
          </ul>
        </div>
        <ul class="search-ul">
          <p q-show="jsonFail" style="padding: 20px; font-size: 12px;">
            缺失模块。<br/>1、请确保node版本大于6.2<br/>2、在博客根目录（注意不是yilia根目录）执行以下命令：<br/> npm i hexo-generator-json-content --save<br/><br/>
            3、在根目录_config.yml里添加配置：
<pre style="font-size: 12px;" q-show="jsonFail">
  jsonContent:
    meta: false
    pages: false
    posts:
      title: true
      date: true
      path: true
      text: false
      raw: false
      content: false
      slug: false
      updated: false
      comments: false
      link: false
      permalink: false
      excerpt: false
      categories: false
      tags: true
</pre>
          </p>
          <li class="search-li" q-repeat="items" q-show="isShow">
            <a q-attr="href:path|urlformat" class="search-title"><i class="icon-quo-left icon"></i><span q-text="title"></span></a>
            <p class="search-time">
              <i class="icon-calendar icon"></i>
              <span q-text="date|dateformat"></span>
            </p>
            <p class="search-tag">
              <i class="icon-price-tags icon"></i>
              <span q-repeat="tags" q-on="click:choseTag(e, name)" q-text="name|tagformat"></span>
            </p>
          </li>
        </ul>
    	</section>
    

    

    
    	<section class="tools-section tools-section-me" q-show="aboutme">
  	  	
  	  		<div class="aboutme-wrap" id="js-aboutme">虽然菜&lt;br&gt;但是会努力的</div>
  	  	
    	</section>
    
  </div>
  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div>
</body>
</html>